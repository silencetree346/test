# 后端服务启动指南 🚀

## 📋 前置要求

### 1. 安装 Node.js

**macOS 用户：**

```bash
# 使用 Homebrew 安装（推荐）
brew install node

# 或访问官网下载安装包
# https://nodejs.org/
```

**验证安装：**

```bash
node -v
npm -v
```

应该显示版本号，例如：
```
v18.17.0
9.6.7
```

---

## 🚀 快速启动

### 步骤1：进入后端目录

```bash
cd /Users/luckincoffee/test/backend-news-proxy
```

### 步骤2：安装依赖

```bash
npm install
```

**预期输出：**
```
added 150 packages in 10s
```

### 步骤3：启动服务

```bash
npm start
```

**预期输出：**
```
═══════════════════════════════════════
🚀 资讯代理服务器已启动
═══════════════════════════════════════
📍 本地地址: http://localhost:3001
🔗 API地址: http://localhost:3001/api/coffee-news-sources
🏥 健康检查: http://localhost:3001/health

📋 当前支持的资讯源：
   • The Guardian（英国卫报）
   • Starbucks Newsroom（星巴克官网）
   • New York Times（纽约时报，需配置API Key）

💡 提示：
   1. 查看 .env 文件配置API Key
   2. 查看《指定资讯源配置指南.md》了解更多
   3. 按 Ctrl+C 停止服务
═══════════════════════════════════════
```

### 步骤4：测试API

**在浏览器中访问：**
```
http://localhost:3001/api/coffee-news-sources
```

**或使用 curl：**
```bash
curl http://localhost:3001/api/coffee-news-sources
```

应该返回JSON格式的资讯数据。

---

## 🌐 启动前端

**新开一个终端窗口：**

```bash
cd /Users/luckincoffee/test
python3 -m http.server 8000
```

**然后访问：**
```
http://localhost:8000/docs/
```

点击"获取最新资讯"按钮，应该能看到从后端获取的真实资讯！

---

## 🔧 一键启动（推荐）

**使用一键启动脚本：**

```bash
cd /Users/luckincoffee/test
chmod +x 一键启动资讯服务.sh
./一键启动资讯服务.sh
```

这个脚本会自动：
1. 检查Node.js是否安装
2. 检查后端是否配置
3. 启动后端服务（新终端窗口）
4. 启动前端服务（新终端窗口）
5. 自动打开浏览器

---

## ⚙️ 可选配置

### 配置纽约时报API Key

1. 访问：https://developer.nytimes.com/
2. 注册账号并创建APP
3. 获取API Key
4. 编辑 `.env` 文件：

```env
NYT_API_KEY=你的API_Key
```

5. 重启服务

---

## 🐛 故障排查

### 问题1：Node.js未安装

**错误信息：**
```
❌ 未检测到Node.js
```

**解决方案：**
```bash
# macOS
brew install node

# 或访问 https://nodejs.org/ 下载安装
```

### 问题2：端口被占用

**错误信息：**
```
Error: listen EADDRINUSE: address already in use :::3001
```

**解决方案：**
```bash
# 方法1：更换端口
PORT=3002 npm start

# 方法2：停止占用端口的进程
lsof -ti:3001 | xargs kill -9
```

### 问题3：依赖安装失败

**错误信息：**
```
npm ERR! code ECONNREFUSED
```

**解决方案：**
```bash
# 使用国内镜像
npm install --registry=https://registry.npmmirror.com
```

### 问题4：后端启动但前端获取不到数据

**检查清单：**
1. ✅ 后端服务是否正在运行？
2. ✅ 访问 http://localhost:3001/api/coffee-news-sources 是否有数据？
3. ✅ 浏览器控制台是否有CORS错误？
4. ✅ 前端是否在 http://localhost:8000 运行？

---

## 📊 预期效果

**后端日志示例：**
```
📡 收到资讯获取请求...
🔍 获取 The Guardian...
✅ The Guardian: 10 条
🔍 获取星巴克官网...
✅ 星巴克: 3 条
🔍 获取纽约时报...
⚠️  未配置 NYT_API_KEY，跳过
✅ 共获取 13 条资讯，耗时 3.45秒
```

**前端效果：**
- ✅ 点击"获取最新资讯"后，能看到真实资讯
- ✅ 资讯按"公司动态"、"行业趋势"、"市场变化"分类
- ✅ 显示智能分析和业务洞见

---

## 🎯 下一步

1. ✅ 后端服务已启动
2. ✅ 前端已连接后端
3. 📝 查看《指定资讯源配置指南.md》添加更多资讯源
4. 🚀 部署到云端（可选）

---

## 💡 提示

- 后端服务需要保持运行，关闭终端窗口会停止服务
- 使用 `Ctrl+C` 停止服务
- 使用 `npm run dev` 启动开发模式（自动重启）
- 查看后端日志了解获取情况

---

**配置完成后，你将拥有一个完整的资讯获取和分析系统！** 🎉✨

