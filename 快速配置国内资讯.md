# 快速配置国内资讯（5分钟上手）🚀

## 🎯 目标

让网站能够获取 **36氪、虎嗅、咖门** 等国内平台的咖啡行业资讯。

---

## ⚡ 最简方案：使用 Node.js 后端（推荐）

### 步骤1：创建后端（3分钟）

```bash
# 1. 创建文件夹
mkdir coffee-api && cd coffee-api

# 2. 初始化项目
npm init -y

# 3. 安装依赖
npm install express axios cors feedparser
```

### 步骤2：创建 `server.js`

复制以下代码到 `server.js`：

```javascript
const express = require('express');
const axios = require('axios');
const cors = require('cors');
const Parser = require('rss-parser');

const app = express();
const parser = new Parser();

app.use(cors());

// 聚合国内咖啡资讯
app.get('/api/chinese-coffee-news', async (req, res) => {
    const allNews = [];
    
    // 咖门RSS（咖啡行业垂直媒体）
    try {
        const feed = await parser.parseURL('https://www.kafmen.cn/feed');
        const articles = feed.items.slice(0, 10).map(item => ({
            title: item.title,
            url: item.link,
            source: '咖门',
            publish_date: new Date(item.pubDate).toISOString().split('T')[0],
            summary: (item.contentSnippet || item.title).substring(0, 150)
        }));
        allNews.push(...articles);
        console.log(`✅ 咖门: ${articles.length}条`);
    } catch (e) {
        console.log('⚠️ 咖门失败:', e.message);
    }
    
    // FBIF食品饮料创新RSS
    try {
        const feed = await parser.parseURL('https://www.fbif.com/rss');
        const articles = feed.items
            .filter(item => item.title.toLowerCase().includes('咖啡') || 
                           item.title.toLowerCase().includes('coffee'))
            .slice(0, 10)
            .map(item => ({
                title: item.title,
                url: item.link,
                source: 'FBIF食品饮料创新',
                publish_date: new Date(item.pubDate).toISOString().split('T')[0],
                summary: (item.contentSnippet || item.title).substring(0, 150)
            }));
        allNews.push(...articles);
        console.log(`✅ FBIF: ${articles.length}条`);
    } catch (e) {
        console.log('⚠️ FBIF失败:', e.message);
    }
    
    // 按日期排序
    allNews.sort((a, b) => new Date(b.publish_date) - new Date(a.publish_date));
    
    res.json(allNews);
});

const PORT = 3001;
app.listen(PORT, () => {
    console.log(`🚀 国内资讯API已启动: http://localhost:${PORT}`);
    console.log(`📡 测试地址: http://localhost:${PORT}/api/chinese-coffee-news`);
});
```

### 步骤3：启动后端

```bash
node server.js
```

看到这个提示就成功了：
```
🚀 国内资讯API已启动: http://localhost:3001
```

### 步骤4：测试API

在浏览器打开：
```
http://localhost:3001/api/chinese-coffee-news
```

应该能看到 JSON 格式的资讯数据。

---

## 🔧 修改前端代码

打开 `docs/index.html`，找到 `fetchChineseNews` 方法，替换为：

```javascript
async fetchChineseNews() {
    console.log('🇨🇳 获取国内咖啡资讯...');
    
    try {
        // 如果后端在本地运行
        const response = await axios.get('http://localhost:3001/api/chinese-coffee-news', {
            timeout: 10000
        });
        
        console.log(`✅ 成功获取 ${response.data.length} 条国内资讯`);
        return response.data;
    } catch (error) {
        console.error('❌ 国内资讯获取失败:', error.message);
        console.log('💡 提示：请确保后端服务已启动（node server.js）');
        return [];
    }
}
```

---

## ✅ 测试完整流程

### 1. 启动后端
```bash
cd coffee-api
node server.js
```

### 2. 启动前端
```bash
cd /Users/luckincoffee/test
python3 -m http.server 8000
```

### 3. 打开网站
```
http://localhost:8000/docs/index.html
```

### 4. 点击"获取最新资讯"

应该能看到：
- ✅ 国际资讯（The Guardian）
- ✅ 国内资讯（咖门、FBIF等）

---

## 🚀 进阶配置

### 添加更多资讯源

在 `server.js` 中添加：

```javascript
// 36氪 - 需要爬虫或API
app.get('/api/36kr-coffee', async (req, res) => {
    try {
        // 方案1：使用36氪的搜索API
        const response = await axios.get('https://36kr.com/api/search', {
            params: { keyword: '咖啡', type: 'article' }
        });
        // 处理数据...
        res.json(articles);
    } catch (e) {
        res.json([]);
    }
});
```

### 部署到云端

#### Vercel（免费）

```bash
# 安装 Vercel CLI
npm install -g vercel

# 部署
vercel
```

#### Railway（免费）

1. 注册 https://railway.app
2. 连接 GitHub 仓库
3. 自动部署

---

## 📊 预期效果

配置成功后，获取资讯时应该看到：

```
🚀 开始获取实时资讯...
🇨🇳 获取国内咖啡资讯...
✅ 成功获取 8 条国内资讯
⚡ 正在从 The Guardian 获取国际资讯...
✅ 成功获取 12 条资讯
📊 最终获取 20 条资讯
```

---

## 🐛 常见问题

### Q1: `Cannot find module 'rss-parser'`

```bash
npm install rss-parser
```

### Q2: 前端显示 "国内资讯获取失败"

检查：
1. 后端是否运行？`node server.js`
2. 端口是否正确？`http://localhost:3001`
3. 浏览器控制台有什么错误？

### Q3: CORS 错误

确保 `server.js` 中有：
```javascript
const cors = require('cors');
app.use(cors());
```

---

## 📝 资讯源对比

| 平台 | 获取方式 | 更新频率 | 内容质量 |
|------|---------|---------|---------|
| 咖门 | RSS | 每天 | ⭐⭐⭐⭐⭐ 行业垂直 |
| FBIF | RSS | 每天 | ⭐⭐⭐⭐ 食品饮料 |
| 36氪 | API/爬虫 | 实时 | ⭐⭐⭐⭐⭐ 创投视角 |
| 虎嗅 | API/爬虫 | 实时 | ⭐⭐⭐⭐⭐ 商业分析 |

---

## 🎯 下一步

1. ✅ **本地测试通过** → 继续下一步
2. 🚀 **部署后端到云端** → Vercel/Railway
3. 🔧 **添加更多资讯源** → 36氪、虎嗅
4. 📊 **优化展示效果** → 分类、过滤、排序

---

**5分钟就能配置好！开始获取国内咖啡资讯吧！** 🇨🇳☕✨

需要帮助？查看完整文档：[《国内资讯配置指南.md》](./国内资讯配置指南.md)


