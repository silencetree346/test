<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Intelligence Daily - å…¨çƒæ™ºè®¯æ—¥æŠ¥</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        #app {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .header p {
            color: #718096;
            font-size: 1.1em;
        }

        .live-badge {
            display: inline-block;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-top: 15px;
            font-weight: 600;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .controls {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
        }
        
        .btn-secondary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
        }
        
        .btn-secondary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .status {
            flex: 1;
            text-align: right;
            color: #4a5568;
            font-size: 0.95em;
        }

        .report-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        .report-header {
            border-bottom: 3px solid #e2e8f0;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .report-date {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 1.5em;
            color: #2d3748;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .news-item {
            background: #f7fafc;
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid #667eea;
            transition: all 0.3s;
        }

        .news-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .news-title {
            font-size: 1.1em;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .news-title a {
            color: inherit;
            text-decoration: none;
        }

        .news-title a:hover {
            color: #667eea;
        }

        .news-meta {
            display: flex;
            gap: 15px;
            color: #718096;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .news-summary {
            color: #4a5568;
            font-size: 0.95em;
            line-height: 1.6;
            margin-top: 8px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 3px solid #667eea;
            font-style: normal;
        }
        
        .news-summary::before {
            content: 'ğŸ’¡ ';
            color: #667eea;
            font-weight: 600;
        }

        .analysis-box {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border-radius: 15px;
            padding: 30px;
            line-height: 1.8;
            color: #2d3748;
            font-size: 1.05em;
        }

        .recommendations {
            display: grid;
            gap: 15px;
        }

        .recommendation-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid #48bb78;
            display: flex;
            gap: 15px;
            align-items: start;
            transition: all 0.3s;
        }

        .recommendation-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(72, 187, 120, 0.2);
        }

        .recommendation-number {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
        }

        .recommendation-text {
            flex: 1;
            color: #2d3748;
            line-height: 1.6;
        }

        .loading {
            text-align: center;
            padding: 60px;
            color: #718096;
        }

        .spinner {
            border: 4px solid #e2e8f0;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #fed7d7;
            color: #c53030;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .source-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin-right: 8px;
        }

        .source-nyt {
            background: #f0f0f0;
            color: #333;
        }

        .source-hbr {
            background: #e3f2fd;
            color: #1976d2;
        }

        .source-wsj {
            background: #fff3e0;
            color: #e65100;
        }

        .source-ft {
            background: #fff1f0;
            color: #d32f2f;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="header">
            <h1>å…¨çƒæ™ºè®¯æ—¥æŠ¥</h1>
            <p style="font-size: 1.2em; color: #667eea; font-weight: 600; margin-top: 5px;">Global Intelligence Daily</p>
            <p style="margin-top: 15px;">èšå…¨çƒä¹‹åŠ¿ Â· ææ·±å±‚ä¹‹ç† Â· é¢†æœªæ¥ä¹‹é“</p>
            <div class="live-badge">âœ¨ æ™ºèƒ½èµ„è®¯ç‰ˆ</div>
        </div>

        <div class="controls">
            <button class="btn btn-primary" @click="generateReport" :disabled="loading">
                <span>ğŸ”„</span>
                <span>{{ loading ? 'æ­£åœ¨è·å–å®æ—¶èµ„è®¯...' : 'è·å–æœ€æ–°èµ„è®¯' }}</span>
            </button>
            <button class="btn btn-secondary" @click="downloadPDF" :disabled="!currentReport || downloading" style="margin-left: 15px;">
                <span>ğŸ“¥</span>
                <span>{{ downloading ? 'æ­£åœ¨ç”ŸæˆPDF...' : 'ä¸‹è½½PDFæŠ¥å‘Š' }}</span>
            </button>
            <button class="btn btn-secondary" @click="clearCache" style="margin-left: 15px; background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);">
                <span>ğŸ—‘ï¸</span>
                <span>æ¸…é™¤ç¼“å­˜</span>
            </button>
            <div class="status">
                {{ statusMessage }}
            </div>
        </div>

        <div v-if="error" class="error">
            âš ï¸ {{ error }}
        </div>

        <div v-if="loading" class="report-card">
            <div class="loading">
                <div class="spinner"></div>
                <p>{{ loadingMessage }}</p>
            </div>
        </div>

        <div v-else-if="currentReport" class="report-card">
            <div class="report-header">
                <span class="report-date">ğŸ“… {{ currentReport.date }}</span>
            </div>

            <div class="section">
                <h3 class="section-title">ğŸ“° å’–å•¡è¡Œä¸šä»Šæ—¥è¦é—»</h3>
                <div style="font-size: 12px; color: #888; margin-top: -10px; margin-bottom: 15px;">æ•°æ®æºè·å–åŒ—äº¬æ—¶é—´æ¯æ—¥0ç‚¹åèµ„è®¯</div>
                <div style="margin-bottom: 15px; padding: 12px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 8px; text-align: center;">
                    <div style="font-size: 14px; opacity: 0.95;">å…±æ”¶é›† {{ currentReport.news_items.length }} æ¡èµ„è®¯ï¼ˆä»Šæ—¥0ç‚¹åï¼‰| æ•°æ®æºï¼š{{ getUniqueSources() }} | æŒ‰å…¬å¸åŠ¨æ€ã€è¡Œä¸šè¶‹åŠ¿ã€å¸‚åœºå˜åŒ–æ™ºèƒ½åˆ†ç±»</div>
                </div>
                
                <!-- å…¬å¸åŠ¨æ€ -->
                <div style="margin-bottom: 25px;">
                    <div style="background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); color: white; padding: 12px 18px; border-radius: 8px 8px 0 0; display: flex; align-items: center; justify-content: space-between;">
                        <div style="display: flex; align-items: center;">
                            <span style="font-size: 24px; margin-right: 10px;">ğŸ¢</span>
                            <div>
                                <div style="font-size: 16px; font-weight: 600;">å…¬å¸åŠ¨æ€</div>
                                <div style="font-size: 12px; opacity: 0.9; margin-top: 2px;">ä¼ä¸šæˆ˜ç•¥ã€èèµ„å¹¶è´­ã€ä¸šç»©è´¢æŠ¥</div>
                            </div>
                        </div>
                        <div style="background: rgba(255,255,255,0.25); padding: 4px 12px; border-radius: 12px; font-size: 13px; font-weight: 600;">
                            {{ categorizedNews.company.length }} æ¡
                        </div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 0 0 8px 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <div v-if="categorizedNews.company.length > 0" class="news-grid">
                            <div v-for="(news, index) in categorizedNews.company" :key="'company-' + index" class="news-item" style="border-left: 4px solid #3498db;">
                                <div class="news-title">
                                    <a :href="news.url" target="_blank">{{ news.title }}</a>
                                </div>
                                <div class="news-summary">
                                    {{ news.summary || 'è¯¥èµ„è®¯æš‚æ— è¯¦ç»†æ‘˜è¦ï¼Œè¯·ç‚¹å‡»æ ‡é¢˜æŸ¥çœ‹å®Œæ•´å†…å®¹ã€‚' }}
                                </div>
                                <div class="news-meta">
                                    <span :class="'source-badge source-' + getSourceClass(news.source)">
                                        {{ news.source }}
                                    </span>
                                    <span>ğŸ•’ {{ news.publish_date }}</span>
                                </div>
                            </div>
                        </div>
                        <div v-else style="text-align: center; color: #999; padding: 20px;">æš‚æ— ç›¸å…³èµ„è®¯</div>
                    </div>
                </div>
                
                <!-- è¡Œä¸šè¶‹åŠ¿ -->
                <div style="margin-bottom: 25px;">
                    <div style="background: linear-gradient(135deg, #e67e22 0%, #d35400 100%); color: white; padding: 12px 18px; border-radius: 8px 8px 0 0; display: flex; align-items: center; justify-content: space-between;">
                        <div style="display: flex; align-items: center;">
                            <span style="font-size: 24px; margin-right: 10px;">ğŸ“ˆ</span>
                            <div>
                                <div style="font-size: 16px; font-weight: 600;">è¡Œä¸šè¶‹åŠ¿</div>
                                <div style="font-size: 12px; opacity: 0.9; margin-top: 2px;">è¡Œä¸šæŠ¥å‘Šã€å‘å±•è¶‹åŠ¿ã€æŠ€æœ¯åˆ›æ–°</div>
                            </div>
                        </div>
                        <div style="background: rgba(255,255,255,0.25); padding: 4px 12px; border-radius: 12px; font-size: 13px; font-weight: 600;">
                            {{ categorizedNews.industry.length }} æ¡
                        </div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 0 0 8px 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <div v-if="categorizedNews.industry.length > 0" class="news-grid">
                            <div v-for="(news, index) in categorizedNews.industry" :key="'industry-' + index" class="news-item" style="border-left: 4px solid #e67e22;">
                                <div class="news-title">
                                    <a :href="news.url" target="_blank">{{ news.title }}</a>
                                </div>
                                <div class="news-summary">
                                    {{ news.summary || 'è¯¥èµ„è®¯æš‚æ— è¯¦ç»†æ‘˜è¦ï¼Œè¯·ç‚¹å‡»æ ‡é¢˜æŸ¥çœ‹å®Œæ•´å†…å®¹ã€‚' }}
                                </div>
                                <div class="news-meta">
                                    <span :class="'source-badge source-' + getSourceClass(news.source)">
                                        {{ news.source }}
                                    </span>
                                    <span>ğŸ•’ {{ news.publish_date }}</span>
                                </div>
                            </div>
                        </div>
                        <div v-else style="text-align: center; color: #999; padding: 20px;">æš‚æ— ç›¸å…³èµ„è®¯</div>
                    </div>
                </div>
                
                <!-- å¸‚åœºå˜åŒ– -->
                <div style="margin-bottom: 25px;">
                    <div style="background: linear-gradient(135deg, #27ae60 0%, #229954 100%); color: white; padding: 12px 18px; border-radius: 8px 8px 0 0; display: flex; align-items: center; justify-content: space-between;">
                        <div style="display: flex; align-items: center;">
                            <span style="font-size: 24px; margin-right: 10px;">ğŸŒ</span>
                            <div>
                                <div style="font-size: 16px; font-weight: 600;">å¸‚åœºå˜åŒ–</div>
                                <div style="font-size: 12px; opacity: 0.9; margin-top: 2px;">æ¶ˆè´¹éœ€æ±‚ã€æ”¿ç­–æ³•è§„ã€ä¾›éœ€å…³ç³»</div>
                            </div>
                        </div>
                        <div style="background: rgba(255,255,255,0.25); padding: 4px 12px; border-radius: 12px; font-size: 13px; font-weight: 600;">
                            {{ categorizedNews.market.length }} æ¡
                        </div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 0 0 8px 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <div v-if="categorizedNews.market.length > 0" class="news-grid">
                            <div v-for="(news, index) in categorizedNews.market" :key="'market-' + index" class="news-item" style="border-left: 4px solid #27ae60;">
                                <div class="news-title">
                                    <a :href="news.url" target="_blank">{{ news.title }}</a>
                                </div>
                                <div class="news-summary">
                                    {{ news.summary || 'è¯¥èµ„è®¯æš‚æ— è¯¦ç»†æ‘˜è¦ï¼Œè¯·ç‚¹å‡»æ ‡é¢˜æŸ¥çœ‹å®Œæ•´å†…å®¹ã€‚' }}
                                </div>
                                <div class="news-meta">
                                    <span :class="'source-badge source-' + getSourceClass(news.source)">
                                        {{ news.source }}
                                    </span>
                                    <span>ğŸ•’ {{ news.publish_date }}</span>
                                </div>
                            </div>
                        </div>
                        <div v-else style="text-align: center; color: #999; padding: 20px;">æš‚æ— ç›¸å…³èµ„è®¯</div>
                    </div>
                </div>
            </div>

            <div class="section" v-if="currentReport && currentReport.analysis">
                <div class="analysis-box" v-html="currentReport.analysis">
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    currentReport: null,
                    loading: false,
                    downloading: false,
                    error: null,
                    statusMessage: 'âš¡ æ™ºèƒ½ç¼“å­˜ | ç‚¹å‡»æŒ‰é’®è·å–ä»Šæ—¥èµ„è®¯',
                    loadingMessage: 'æ­£åœ¨è·å–ä»Šæ—¥å®æ—¶èµ„è®¯...'
                };
            },
            computed: {
                categorizedNews() {
                    if (!this.currentReport || !this.currentReport.news_items) {
                        return { company: [], industry: [], market: [] };
                    }
                    
                    const company = [];
                    const industry = [];
                    const market = [];
                    
                    this.currentReport.news_items.forEach(news => {
                        const text = (news.title + ' ' + (news.summary || '')).toLowerCase();
                        const originalText = news.title + ' ' + (news.summary || '');
                        
                        // å…¬å¸åŠ¨æ€å…³é”®è¯ï¼šå…·ä½“å…¬å¸åï¼ˆä¸­è‹±æ–‡ï¼‰ã€CEOã€å¹¶è´­ã€èèµ„ã€è´¢æŠ¥ã€IPO
                        const companyKeywords = [
                            // è‹±æ–‡å…¬å¸å
                            'starbucks', 'luckin', 'nestle', 'costa', 'tim hortons', 'dunkin', 'peet', 'blue bottle', 'lavazza', 'illy',
                            // ä¸­æ–‡å…¬å¸å
                            'æ˜Ÿå·´å…‹', 'ç‘å¹¸', 'é›€å·¢', 'costa', 'manner', 'seesaw', 'm stand', 'tims', 'æŒªç“¦', 'manner coffee',
                            'è¿å’–å•¡', 'ä¸‰é¡¿åŠ', 'æ°¸ç’', 'éš…ç”°å·', 'æ—¶èƒ', 'fisheye', 'é±¼çœ¼å’–å•¡',
                            // å…¬å¸è¡Œä¸ºå…³é”®è¯ï¼ˆè‹±æ–‡ï¼‰
                            'ceo', 'merger', 'acquisition', 'invest', 'ipo', 'earnings', 'revenue', 'profit', 
                            'expansion', 'opens', 'closes', 'launch', 'announces', 'strategy', 'scandal', 'comeback',
                            'quarterly', 'financial', 'funding', 'round', 'valuation', 'partnership', 'cooperation',
                            // å…¬å¸è¡Œä¸ºå…³é”®è¯ï¼ˆä¸­æ–‡ï¼‰
                            'å®£å¸ƒ', 'å‘å¸ƒ', 'è´¢æŠ¥', 'è¥æ”¶', 'åˆ©æ¶¦', 'èèµ„', 'æŠ•èµ„', 'å¹¶è´­', 'æ”¶è´­', 'ipo', 'ä¸Šå¸‚',
                            'å¼€åº—', 'å…³åº—', 'æ‰©å¼ ', 'æˆ˜ç•¥', 'åˆä½œ', 'æ¨å‡º', 'ä¸Šçº¿', 'å‘å¸ƒ', 'ceo', 'æ€»è£', 'è‘£äº‹é•¿',
                            'é—¨åº—æ•°', 'ä¸šç»©', 'å¢é•¿', 'äºæŸ', 'ç›ˆåˆ©', 'ä¼°å€¼', 'è½®èèµ„', 'æˆ˜ç•¥èèµ„', 'aè½®', 'bè½®', 'cè½®'
                        ];
                        
                        // è¡Œä¸šè¶‹åŠ¿å…³é”®è¯ï¼šæŠ¥å‘Šã€ç ”ç©¶ã€è¶‹åŠ¿ã€å¢é•¿ã€æŠ€æœ¯ã€åˆ›æ–°
                        const industryKeywords = [
                            // è‹±æ–‡å…³é”®è¯
                            'industry', 'trend', 'growth', 'report', 'study', 'research', 'forecast', 'market size',
                            'innovation', 'technology', 'digital', 'sustainability', 'third wave', 'specialty', 
                            'economics', 'business model', 'future', 'evolution', 'transformation', 'analysis',
                            'outlook', 'perspective', 'development', 'progress', 'breakthrough',
                            // ä¸­æ–‡å…³é”®è¯
                            'è¡Œä¸š', 'è¶‹åŠ¿', 'æŠ¥å‘Š', 'ç ”ç©¶', 'åˆ†æ', 'é¢„æµ‹', 'å±•æœ›', 'å‘å±•', 'å¢é•¿', 'å¸‚åœºè§„æ¨¡',
                            'æŠ€æœ¯åˆ›æ–°', 'æ•°å­—åŒ–è½¬å‹', 'å¯æŒç»­å‘å±•', 'å•†ä¸šæ¨¡å¼', 'æœªæ¥', 'æ¼”å˜', 'å˜é©',
                            'è¡Œä¸šæŠ¥å‘Š', 'å¸‚åœºç ”ç©¶', 'è¡Œä¸šåˆ†æ', 'å‘å±•è¶‹åŠ¿', 'è¡Œä¸šå‰æ™¯', 'å¸‚åœºå‰æ™¯',
                            'è¡Œä¸šæ•°æ®', 'ç»Ÿè®¡', 'è°ƒç ”', 'ç™½çš®ä¹¦', 'è“çš®ä¹¦'
                        ];
                        
                        // å¸‚åœºå˜åŒ–å…³é”®è¯ï¼šæ¶ˆè´¹è€…ã€éœ€æ±‚ã€ä»·æ ¼ã€ä¾›åº”ã€æ”¿ç­–ã€æ³•è§„
                        const marketKeywords = [
                            // è‹±æ–‡å…³é”®è¯
                            'consumer', 'demand', 'preference', 'price', 'cost', 'supply', 'shortage', 'labor',
                            'regulation', 'policy', 'climate', 'weather', 'crop', 'generation', 'gen z', 'millennial',
                            'shift', 'change', 'sales', 'dominates', 'plant-based', 'alternative', 'purchasing',
                            'behavior', 'spending', 'budget', 'affordability', 'competition', 'market share',
                            // ä¸­æ–‡å…³é”®è¯
                            'æ¶ˆè´¹è€…', 'éœ€æ±‚', 'åå¥½', 'ä»·æ ¼', 'æˆæœ¬', 'ä¾›åº”', 'çŸ­ç¼º', 'åŠ³åŠ¨åŠ›', 'äººå·¥',
                            'æ”¿ç­–', 'æ³•è§„', 'ç›‘ç®¡', 'æ°”å€™', 'å¤©æ°”', 'ä½œç‰©', 'zä¸–ä»£', 'åƒç¦§ä¸€ä»£', '95å', '00å',
                            'å˜åŒ–', 'è½¬å˜', 'é”€å”®', 'å¸‚åœºä»½é¢', 'ç«äº‰', 'è´­ä¹°', 'æ¶ˆè´¹', 'æ”¯å‡º', 'é¢„ç®—',
                            'æ¶ˆè´¹ä¹ æƒ¯', 'æ¶ˆè´¹è¶‹åŠ¿', 'æ¶ˆè´¹å‡çº§', 'æ¶ˆè´¹é™çº§', 'ä»·æ ¼æˆ˜', 'ä¿ƒé”€', 'ä¼˜æƒ ',
                            'æ”¿ç­–æ³•è§„', 'ç›‘ç®¡æ”¿ç­–', 'è¡Œä¸šæ”¿ç­–', 'å¸‚åœºæ”¿ç­–', 'æ¶ˆè´¹æ”¿ç­–'
                        ];
                        
                        let companyScore = 0, industryScore = 0, marketScore = 0;
                        
                        // ä¼˜å…ˆæ£€æŸ¥å…¬å¸åï¼ˆæƒé‡æ›´é«˜ï¼‰
                        const companyNames = ['æ˜Ÿå·´å…‹', 'ç‘å¹¸', 'luckin', 'starbucks', 'manner', 'é›€å·¢', 'nestle', 
                                             'costa', 'tims', 'seesaw', 'm stand', 'æŒªç“¦', 'ä¸‰é¡¿åŠ', 'æ°¸ç’'];
                        const hasCompanyName = companyNames.some(name => 
                            originalText.includes(name) || text.includes(name.toLowerCase())
                        );
                        if (hasCompanyName) {
                            companyScore += 5; // å…¬å¸ååŒ¹é…ç»™äºˆé«˜åˆ†
                        }
                        
                        // æ£€æŸ¥å…¬å¸è¡Œä¸ºå…³é”®è¯
                        companyKeywords.forEach(kw => { 
                            if(text.includes(kw.toLowerCase()) || originalText.includes(kw)) {
                                companyScore += 2;
                            }
                        });
                        
                        // æ£€æŸ¥è¡Œä¸šè¶‹åŠ¿å…³é”®è¯
                        industryKeywords.forEach(kw => { 
                            if(text.includes(kw.toLowerCase()) || originalText.includes(kw)) {
                                industryScore += 1;
                            }
                        });
                        
                        // æ£€æŸ¥å¸‚åœºå˜åŒ–å…³é”®è¯
                        marketKeywords.forEach(kw => { 
                            if(text.includes(kw.toLowerCase()) || originalText.includes(kw)) {
                                marketScore += 1;
                            }
                        });
                        
                        // æ ¹æ®å¾—åˆ†æœ€é«˜çš„åˆ†ç±»
                        const max = Math.max(companyScore, industryScore, marketScore);
                        if (max === 0) {
                            // å¦‚æœæ‰€æœ‰å¾—åˆ†éƒ½æ˜¯0ï¼Œæ ¹æ®æ ‡é¢˜åˆ¤æ–­
                            if (news.title.includes('æŠ¥å‘Š') || news.title.includes('ç ”ç©¶') || news.title.includes('åˆ†æ')) {
                                industry.push(news);
                            } else if (news.title.includes('ä»·æ ¼') || news.title.includes('æ¶ˆè´¹') || news.title.includes('æ”¿ç­–')) {
                                market.push(news);
                            } else {
                                // é»˜è®¤å½’ä¸ºå…¬å¸åŠ¨æ€ï¼ˆå› ä¸ºå¤§å¤šæ•°æ–°é—»éƒ½æ˜¯å…³äºå…·ä½“å…¬å¸çš„ï¼‰
                                company.push(news);
                            }
                        } else if (companyScore === max) {
                            company.push(news);
                        } else if (industryScore === max) {
                            industry.push(news);
                        } else {
                            market.push(news);
                        }
                    });
                    
                    return { company, industry, market };
                }
            },
            methods: {
                // HTMLå®ä½“è§£ç å‡½æ•°
                decodeHTML(html) {
                    const txt = document.createElement('textarea');
                    txt.innerHTML = html;
                    return txt.value;
                },
                
                // æ¸…ç†HTMLæ ‡ç­¾å’Œå®ä½“
                cleanText(text) {
                    if (!text) return '';
                    
                    // å¤„ç†CDATAå†…å®¹
                    text = text.replace(/<!\[CDATA\[(.*?)\]\]>/g, '$1');
                    
                    // åˆ›å»ºä¸´æ—¶divæ¥è§£æHTMLå®ä½“
                    const tmp = document.createElement('div');
                    tmp.innerHTML = text;
                    
                    // è·å–çº¯æ–‡æœ¬
                    let cleaned = tmp.textContent || tmp.innerText || '';
                    
                    // è§£ç å¸¸è§çš„HTMLå®ä½“
                    const entities = {
                        '&amp;': '&',
                        '&lt;': '<',
                        '&gt;': '>',
                        '&quot;': '"',
                        '&apos;': "'",
                        '&nbsp;': ' ',
                        '&#39;': "'",
                        '&#8217;': "'",
                        '&#8220;': '"',
                        '&#8221;': '"',
                        '&#8211;': '-',
                        '&#8212;': 'â€”',
                        '&hellip;': '...'
                    };
                    
                    // æ›¿æ¢HTMLå®ä½“
                    Object.keys(entities).forEach(entity => {
                        cleaned = cleaned.replace(new RegExp(entity, 'g'), entities[entity]);
                    });
                    
                    // ç§»é™¤ä½œè€…å’Œç¼–è¾‘ä¿¡æ¯ï¼ˆå¤šç§æ ¼å¼ï¼‰
                    cleaned = cleaned.replace(/^ä½œè€…\s*[|ï¼š:]\s*[^\s|ï¼š:]+(\s*ç¼–è¾‘\s*[|ï¼š:]\s*[^\s|ï¼š:]+)?/i, '');
                    cleaned = cleaned.replace(/^ç¼–è¾‘\s*[|ï¼š:]\s*[^\s|ï¼š:]+/i, '');
                    cleaned = cleaned.replace(/ä½œè€…\s*[|ï¼š:]\s*[^\s|ï¼š:]+(\s*ç¼–è¾‘\s*[|ï¼š:]\s*[^\s|ï¼š:]+)?/gi, '');
                    cleaned = cleaned.replace(/ç¼–è¾‘\s*[|ï¼š:]\s*[^\s|ï¼š:]+/gi, '');
                    cleaned = cleaned.replace(/\s*[|ï¼š:]\s*ä½œè€…\s*[|ï¼š:]\s*[^\s|ï¼š:]+/gi, '');
                    cleaned = cleaned.replace(/\s*[|ï¼š:]\s*ç¼–è¾‘\s*[|ï¼š:]\s*[^\s|ï¼š:]+/gi, '');
                    
                    // æ¸…ç†å¤šä½™çš„ç©ºç™½å­—ç¬¦
                    cleaned = cleaned.replace(/\s+/g, ' ').trim();
                    
                    return cleaned;
                },
                
                // ç”Ÿæˆç®€æ´æ‘˜è¦ï¼ˆ1-2å¥è¯ï¼‰
                generateSummary(title, description) {
                    if (!description || description.trim() === '') {
                        return title;
                    }
                    
                    // ç§»é™¤ä½œè€…ç¼–è¾‘ä¿¡æ¯
                    let text = description.replace(/^ä½œè€…\s*[|ï¼š:]\s*[^\s|ï¼š:]+(\s*ç¼–è¾‘\s*[|ï¼š:]\s*[^\s|ï¼š:]+)?\s*/i, '');
                    text = text.replace(/^ç¼–è¾‘\s*[|ï¼š:]\s*[^\s|ï¼š:]+\s*/i, '');
                    text = text.trim();
                    
                    // å¦‚æœæ–‡æœ¬å¾ˆçŸ­ï¼Œç›´æ¥è¿”å›
                    if (text.length <= 100) {
                        return text;
                    }
                    
                    // æŒ‰å¥å·ã€é—®å·ã€æ„Ÿå¹å·åˆ†å‰²
                    const sentences = text.split(/[ã€‚ï¼ï¼Ÿ.!?]/).filter(s => s.trim().length > 0);
                    
                    if (sentences.length === 0) {
                        // å¦‚æœæ²¡æœ‰å¥å·ï¼ŒæŒ‰é€—å·åˆ†å‰²
                        const parts = text.split(/[ï¼Œ,]/).filter(s => s.trim().length > 0);
                        if (parts.length > 0) {
                            return parts[0].trim() + (parts.length > 1 ? 'ï¼Œ' + parts[1].trim() : '');
                        }
                        return text.substring(0, 100) + '...';
                    }
                    
                    // å–å‰1-2å¥è¯
                    if (sentences.length === 1) {
                        return sentences[0].trim();
                    } else {
                        // å–å‰ä¸¤å¥è¯ï¼Œç¡®ä¿æ€»é•¿åº¦ä¸è¶…è¿‡150å­—
                        let summary = sentences[0].trim() + 'ã€‚';
                        if (sentences[1] && (summary.length + sentences[1].trim().length) < 150) {
                            summary += sentences[1].trim() + 'ã€‚';
                        }
                        return summary;
                    }
                },
                
                // è·å–æ¨¡æ‹Ÿæ•°æ®ï¼ˆç”¨äºå±•ç¤ºæ•ˆæœï¼‰
                getMockNewsData() {
                    const today = new Date().toISOString().split('T')[0];
                    return [
                        // å…¬å¸åŠ¨æ€
                        {
                            title: 'æ˜Ÿå·´å…‹ä¸­å›½å®£å¸ƒ2024è´¢å¹´Q4è¥æ”¶å¢é•¿15%ï¼Œé—¨åº—æ•°çªç ´7000å®¶',
                            url: '#',
                            source: '36æ°ª',
                            publish_date: today,
                            summary: 'æ˜Ÿå·´å…‹ä¸­å›½å‘å¸ƒæœ€æ–°è´¢æŠ¥ï¼Œç¬¬å››å­£åº¦è¥æ”¶åŒæ¯”å¢é•¿15%ï¼Œå¾—ç›Šäºé«˜ç«¯äº§å“çº¿å’Œæ•°å­—åŒ–ä¼šå‘˜ä½“ç³»çš„åŒé‡é©±åŠ¨ã€‚åŒæ—¶ï¼Œé—¨åº—æ€»æ•°çªç ´7000å®¶ï¼Œä¸‹æ²‰å¸‚åœºæ‰©å¼ æˆæ•ˆæ˜¾è‘—ã€‚'
                        },
                        {
                            title: 'ç‘å¹¸å’–å•¡æ¨å‡ºAIæ™ºèƒ½æ¨èç³»ç»Ÿï¼Œä¸ªæ€§åŒ–è¥é”€è½¬åŒ–ç‡æå‡40%',
                            url: '#',
                            source: 'è™å—…',
                            publish_date: today,
                            summary: 'ç‘å¹¸å’–å•¡æ­£å¼ä¸Šçº¿AIæ™ºèƒ½æ¨èç³»ç»Ÿï¼Œé€šè¿‡åˆ†æç”¨æˆ·æ¶ˆè´¹ä¹ æƒ¯å’Œåå¥½ï¼Œå®ç°åƒäººåƒé¢çš„äº§å“æ¨èã€‚å†…æµ‹æ•°æ®æ˜¾ç¤ºï¼Œä¸ªæ€§åŒ–æ¨èä½¿ä¼šå‘˜å¤è´­ç‡æå‡25%ï¼Œè¥é”€è½¬åŒ–ç‡æå‡40%ã€‚'
                        },
                        {
                            title: 'Manner Coffeeå®Œæˆæ–°ä¸€è½®èèµ„ï¼Œä¼°å€¼è¶…è¿‡30äº¿ç¾å…ƒ',
                            url: '#',
                            source: 'è…¾è®¯æ–°é—»',
                            publish_date: today,
                            summary: 'ç²¾å“å’–å•¡å“ç‰ŒManner Coffeeå®Œæˆæ–°ä¸€è½®æˆ˜ç•¥èèµ„ï¼Œæœ¬è½®èèµ„åä¼°å€¼è¶…è¿‡30äº¿ç¾å…ƒã€‚å…¬å¸è®¡åˆ’åŠ é€Ÿå…¨å›½é—¨åº—å¸ƒå±€ï¼Œä»Šå¹´ç›®æ ‡æ–°å¢500å®¶é—¨åº—ï¼Œé‡ç‚¹è¦†ç›–æ–°ä¸€çº¿åŸå¸‚ã€‚'
                        },
                        {
                            title: 'é›€å·¢å®£å¸ƒæŠ•èµ„5äº¿å…ƒå»ºè®¾ä¸­å›½å’–å•¡ç ”å‘ä¸­å¿ƒï¼Œèšç„¦å¯æŒç»­å‘å±•',
                            url: '#',
                            source: 'æ˜Ÿå·´å…‹å®˜ç½‘',
                            publish_date: today,
                            summary: 'é›€å·¢é›†å›¢å®£å¸ƒåœ¨ä¸­å›½é’å²›æŠ•èµ„5äº¿å…ƒäººæ°‘å¸å»ºè®¾äºšå¤ªå’–å•¡ç ”å‘ä¸­å¿ƒï¼Œä¸“æ³¨äºå¯æŒç»­å’–å•¡ç§æ¤æŠ€æœ¯å’Œæ–°å“ç ”å‘ã€‚è¯¥ä¸­å¿ƒé¢„è®¡2025å¹´æŠ•å…¥ä½¿ç”¨ï¼Œå°†æˆä¸ºé›€å·¢å…¨çƒæœ€å¤§çš„å’–å•¡ç ”å‘åŸºåœ°ã€‚'
                        },
                        
                        // è¡Œä¸šè¶‹åŠ¿
                        {
                            title: '2024ä¸­å›½å’–å•¡å¸‚åœºæŠ¥å‘Šï¼šå¸‚åœºè§„æ¨¡çªç ´2000äº¿ï¼Œå¢é€Ÿé¢†è·‘å…¨çƒ',
                            url: '#',
                            source: 'è‰¾ç‘å’¨è¯¢',
                            publish_date: today,
                            summary: 'è‰¾ç‘å’¨è¯¢å‘å¸ƒã€Š2024ä¸­å›½å’–å•¡å¸‚åœºç ”ç©¶æŠ¥å‘Šã€‹æ˜¾ç¤ºï¼Œä¸­å›½å’–å•¡å¸‚åœºè§„æ¨¡çªç ´2000äº¿å…ƒï¼ŒåŒæ¯”å¢é•¿27.2%ï¼Œå¢é€Ÿä½å±…å…¨çƒç¬¬ä¸€ã€‚æŠ¥å‘ŠæŒ‡å‡ºï¼Œä¸‹æ²‰å¸‚åœºå’Œå³é¥®å’–å•¡æˆä¸ºä¸»è¦å¢é•¿å¼•æ“ã€‚'
                        },
                        {
                            title: 'å’–å•¡è¡Œä¸šæ•°å­—åŒ–è½¬å‹åŠ é€Ÿï¼Œçº¿ä¸Šè®¢å•å æ¯”é¦–æ¬¡è¶…è¿‡50%',
                            url: '#',
                            source: 'ç™¾åº¦èµ„è®¯',
                            publish_date: today,
                            summary: 'æœ€æ–°è¡Œä¸šæ•°æ®æ˜¾ç¤ºï¼Œå’–å•¡è¿é”å“ç‰Œçº¿ä¸Šè®¢å•å æ¯”é¦–æ¬¡çªç ´50%ï¼Œæ•°å­—åŒ–è½¬å‹æˆæ•ˆæ˜¾è‘—ã€‚å¤–å–ã€å°ç¨‹åºè‡ªæå’Œä¼šå‘˜é¢„ç‚¹å•æˆä¸ºä¸»æµæ¶ˆè´¹æ–¹å¼ï¼Œæ¨åŠ¨è¡Œä¸šè¿è¥æ•ˆç‡æå‡30%ä»¥ä¸Šã€‚'
                        },
                        {
                            title: 'ç²¾å“å’–å•¡èµ›é“æŒç»­å‡æ¸©ï¼Œå•åº—æŠ•èµ„å›æŠ¥å‘¨æœŸç¼©çŸ­è‡³18ä¸ªæœˆ',
                            url: '#',
                            source: 'çº½çº¦æ—¶æŠ¥',
                            publish_date: today,
                            summary: 'ç²¾å“å’–å•¡å¸‚åœºæŒç»­å‡æ¸©ï¼Œæ¶ˆè´¹è€…å¯¹é«˜å“è´¨å’–å•¡çš„éœ€æ±‚å¿«é€Ÿå¢é•¿ã€‚è¡Œä¸šæ•°æ®æ˜¾ç¤ºï¼Œç²¾å“å’–å•¡åº—å•åº—æŠ•èµ„å›æŠ¥å‘¨æœŸå·²ä»3å¹´ç¼©çŸ­è‡³18ä¸ªæœˆï¼Œç›ˆåˆ©èƒ½åŠ›æ˜¾è‘—æå‡ã€‚'
                        },
                        {
                            title: 'å¯æŒç»­å‘å±•æˆå’–å•¡è¡Œä¸šæ–°æ ‡é…ï¼Œ90%å¤´éƒ¨å“ç‰Œæ‰¿è¯ºç¢³ä¸­å’Œ',
                            url: '#',
                            source: 'åå°”è¡—æ—¥æŠ¥',
                            publish_date: today,
                            summary: 'å…¨çƒ90%ä»¥ä¸Šçš„å¤´éƒ¨å’–å•¡å“ç‰Œå·²æ‰¿è¯ºåœ¨2030å¹´å‰å®ç°ç¢³ä¸­å’Œã€‚ä»å’–å•¡è±†ç§æ¤ã€è¿è¾“åˆ°é—¨åº—è¿è¥ï¼Œå…¨äº§ä¸šé“¾å¯æŒç»­å‘å±•æˆä¸ºè¡Œä¸šå…±è¯†ï¼Œç»¿è‰²ä¾›åº”é“¾æˆä¸ºæ ¸å¿ƒç«äº‰åŠ›ã€‚'
                        },
                        
                        // å¸‚åœºå˜åŒ–
                        {
                            title: 'Zä¸–ä»£æˆå’–å•¡æ¶ˆè´¹ä¸»åŠ›å†›ï¼Œç¤¾äº¤å±æ€§æ¨åŠ¨æ–°å“ç±»å¢é•¿',
                            url: '#',
                            source: 'é‡‘èæ—¶æŠ¥',
                            publish_date: today,
                            summary: 'Zä¸–ä»£ï¼ˆ1995-2010å¹´å‡ºç”Ÿï¼‰å·²æˆä¸ºå’–å•¡æ¶ˆè´¹ä¸»åŠ›ï¼Œå æ€»æ¶ˆè´¹äººç¾¤çš„45%ã€‚è¿™ä¸€ç¾¤ä½“æ›´æ³¨é‡ç¤¾äº¤å±æ€§å’Œä¸ªæ€§åŒ–ä½“éªŒï¼Œæ¨åŠ¨åˆ›æ„å’–å•¡ã€æ°®æ°”å’–å•¡ç­‰æ–°å“ç±»å¿«é€Ÿå¢é•¿ã€‚'
                        },
                        {
                            title: 'å’–å•¡è±†åŸæ–™ä»·æ ¼ä¸Šæ¶¨15%ï¼Œä¾›åº”é“¾å‹åŠ›ä¼ å¯¼è‡³é›¶å”®ç«¯',
                            url: '#',
                            source: 'å“ˆä½›å•†ä¸šè¯„è®º',
                            publish_date: today,
                            summary: 'å—æ°”å€™å˜åŒ–å’Œä¸»äº§åŒºäº§é‡ä¸‹é™å½±å“ï¼Œå›½é™…å’–å•¡è±†ä»·æ ¼ä»Šå¹´ç´¯è®¡ä¸Šæ¶¨15%ã€‚å¤šå®¶å’–å•¡è¿é”å“ç‰Œå·²ä¸Šè°ƒéƒ¨åˆ†äº§å“ä»·æ ¼ï¼Œè¡Œä¸šé¢ä¸´æˆæœ¬ä¸æ¶ˆè´¹è€…æ‰¿å—åŠ›çš„å¹³è¡¡æŒ‘æˆ˜ã€‚'
                        },
                        {
                            title: 'ä¸‰å››çº¿åŸå¸‚å’–å•¡æ¶ˆè´¹æ¿€å¢ï¼Œä¸‹æ²‰å¸‚åœºæ½œåŠ›å·¨å¤§',
                            url: '#',
                            source: '36æ°ª',
                            publish_date: today,
                            summary: 'ä¸‰å››çº¿åŸå¸‚å’–å•¡æ¶ˆè´¹åŒæ¯”å¢é•¿è¶…è¿‡80%ï¼Œè¿œè¶…ä¸€äºŒçº¿åŸå¸‚å¢é€Ÿã€‚éšç€æ¶ˆè´¹å‡çº§å’Œå’–å•¡æ–‡åŒ–æ™®åŠï¼Œä¸‹æ²‰å¸‚åœºæ­£æˆä¸ºå„å¤§å“ç‰Œäº‰å¤ºçš„æ–°æˆ˜åœºï¼Œé¢„è®¡æœªæ¥3å¹´å¢é•¿æ½œåŠ›è¶…è¿‡500äº¿å…ƒã€‚'
                        },
                        {
                            title: 'æ”¿ç­–åˆ©å¥½ï¼šå¤šåœ°å‡ºå°å’–å•¡äº§ä¸šæ‰¶æŒæ”¿ç­–ï¼Œäº‘å—å’–å•¡äº§ä¸šå›­å¯åŠ¨',
                            url: '#',
                            source: 'è…¾è®¯æ–°é—»',
                            publish_date: today,
                            summary: 'äº‘å—ã€æµ·å—ç­‰åœ°ç›¸ç»§å‡ºå°å’–å•¡äº§ä¸šæ‰¶æŒæ”¿ç­–ï¼Œæ”¯æŒæœ¬åœŸå’–å•¡ç§æ¤å’Œæ·±åŠ å·¥ã€‚äº‘å—æ™®æ´±å’–å•¡äº§ä¸šå›­æ­£å¼å¯åŠ¨ï¼Œè®¡åˆ’æ‰“é€ ä¸­å›½å’–å•¡ä¹‹éƒ½ï¼Œæå‡å›½äº§å’–å•¡è±†çš„å›½é™…ç«äº‰åŠ›ã€‚'
                        }
                    ];
                },
                
                getUniqueSources() {
                    if (!this.currentReport || !this.currentReport.news_items) {
                        return '';
                    }
                    const sources = [...new Set(this.currentReport.news_items.map(item => item.source))];
                    return sources.join('ã€');
                },
                
                getSourceClass(source) {
                    const lowerSource = source.toLowerCase();
                    if (lowerSource.includes('times')) return 'nyt';
                    if (lowerSource.includes('harvard') || lowerSource.includes('hbr')) return 'hbr';
                    if (lowerSource.includes('wall street') || lowerSource.includes('wsj')) return 'wsj';
                    if (lowerSource.includes('financial') || lowerSource.includes('ft')) return 'ft';
                    return 'nyt';
                },
                
                getMockNews_BACKUP() {
                    // å·²åºŸå¼ƒï¼šä¸å†ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œåªå±•ç¤ºå®é™…æ”¶é›†åˆ°çš„èµ„è®¯
                    const today = new Date().toISOString().split('T')[0];
                    const yesterday = new Date(Date.now() - 86400000).toISOString().split('T')[0];
                    
                    return [
                        {
                            title: "Starbucks Reports Strong Q4 Earnings, Beats Wall Street Expectations",
                            url: "https://www.wsj.com/business/retail/starbucks-earnings",
                            source: "Wall Street Journal",
                            publish_date: today,
                            summary: "Starbucks Corp. reported stronger-than-expected quarterly earnings, driven by robust sales in China and innovative product launches. Same-store sales grew 8% globally, with digital orders accounting for 30% of total transactions."
                        },
                        {
                            title: "The Premium Coffee Market Is Brewing Up Record Growth",
                            url: "https://hbr.org/premium-coffee-market",
                            source: "Harvard Business Review",
                            publish_date: today,
                            summary: "Analysis shows the global specialty coffee market is expanding at 12% annually, fueled by millennial consumers willing to pay premium prices for quality, sustainability, and unique experiences."
                        },
                        {
                            title: "Coffee Prices Surge as Climate Change Impacts Key Growing Regions",
                            url: "https://www.ft.com/content/coffee-prices-climate",
                            source: "Financial Times",
                            publish_date: yesterday,
                            summary: "Arabica coffee futures hit a 10-year high as extreme weather in Brazil and Colombia disrupts harvests. Industry experts warn supply chain challenges could persist through 2025."
                        },
                        {
                            title: "How Technology Is Transforming the Coffee Shop Experience",
                            url: "https://www.nytimes.com/coffee-technology",
                            source: "The New York Times",
                            publish_date: today,
                            summary: "From AI-powered personalization to robotic baristas, coffee chains are embracing technology to enhance customer experience and improve operational efficiency. Mobile ordering now represents over 25% of transactions at major chains."
                        },
                        {
                            title: "NestlÃ© Accelerates Sustainable Coffee Sourcing Initiative",
                            url: "https://www.bloomberg.com/nestle-sustainable-coffee",
                            source: "Bloomberg",
                            publish_date: yesterday,
                            summary: "NestlÃ© announces commitment to source 100% sustainable coffee by 2025, investing $1 billion in regenerative agriculture programs. The move reflects growing consumer demand for ethically sourced products."
                        },
                        {
                            title: "Cold Brew Dominates Summer Sales as Consumer Preferences Shift",
                            url: "https://www.businessinsider.com/cold-brew-sales-growth",
                            source: "Business Insider",
                            publish_date: today,
                            summary: "Cold brew coffee sales surged 35% year-over-year, becoming the fastest-growing segment in the ready-to-drink beverage category. Gen Z consumers drive demand for convenient, Instagram-worthy drinks."
                        },
                        {
                            title: "Luckin Coffee's Comeback Story: From Scandal to Market Leader",
                            url: "https://www.wsj.com/business/luckin-coffee-china",
                            source: "Wall Street Journal",
                            publish_date: yesterday,
                            summary: "Two years after an accounting scandal, Luckin Coffee has rebounded spectacularly, now operating 15,000+ stores in China. The company's aggressive expansion and digital-first strategy set industry benchmarks."
                        },
                        {
                            title: "The Economics of Third-Wave Coffee Shops",
                            url: "https://hbr.org/third-wave-coffee-economics",
                            source: "Harvard Business Review",
                            publish_date: today,
                            summary: "Deep dive into the business model of specialty coffee shops reveals that success hinges on community building, experiential retail, and premium positioning rather than volume sales."
                        },
                        {
                            title: "Plant-Based Milk Alternatives Reshape Coffee Industry Dynamics",
                            url: "https://www.ft.com/content/plant-based-coffee",
                            source: "Financial Times",
                            publish_date: today,
                            summary: "Oat milk and other plant-based alternatives now account for 20% of milk orders at coffee shops. Major chains expand non-dairy options as health-conscious consumers drive category growth."
                        },
                        {
                            title: "Coffee Chains Face Labor Shortage in Post-Pandemic Recovery",
                            url: "https://www.nytimes.com/coffee-labor-shortage",
                            source: "The New York Times",
                            publish_date: yesterday,
                            summary: "Coffee retailers struggle to attract and retain workers amid tight labor market. Companies respond by raising wages, offering benefits, and investing in automation technology."
                        }
                    ];
                },
                
                getChineseNews_BACKUP() {
                    // å·²åºŸå¼ƒï¼šä¸å†ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œåªå±•ç¤ºå®é™…æ”¶é›†åˆ°çš„èµ„è®¯
                    const today = new Date().toISOString().split('T')[0];
                    const yesterday = new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString().split('T')[0];
                    
                    return [
                        {
                            title: "2024å¹´ä¸­å›½å’–å•¡è¡Œä¸šç ”ç©¶æŠ¥å‘Šï¼šå¸‚åœºè§„æ¨¡çªç ´2000äº¿å…ƒï¼Œä¸‹æ²‰å¸‚åœºæˆæ–°å¢é•¿ç‚¹",
                            url: "https://www.iresearch.cn/report/coffee-industry-2024",
                            source: "è‰¾ç‘å’¨è¯¢",
                            publish_date: today,
                            summary: "è‰¾ç‘å’¨è¯¢æœ€æ–°æŠ¥å‘Šæ˜¾ç¤ºï¼Œ2024å¹´ä¸­å›½å’–å•¡å¸‚åœºè§„æ¨¡è¾¾2150äº¿å…ƒï¼ŒåŒæ¯”å¢é•¿28.5%ã€‚ä¸‰å››çº¿åŸå¸‚å’–å•¡æ¶ˆè´¹å¢é€Ÿè¾¾45%ï¼Œæˆä¸ºè¡Œä¸šæ–°å¢é•¿å¼•æ“ã€‚ç°ç£¨å’–å•¡å æ¯”æå‡è‡³42%ï¼Œç²¾å“å’–å•¡å“ç‰ŒåŠ é€Ÿæ‰©å¼ ã€‚"
                        },
                        {
                            title: "ç‘å¹¸å’–å•¡Q3è´¢æŠ¥ï¼šé—¨åº—æ•°ç ´2ä¸‡å®¶ï¼Œå•åº—æ—¥å‡é”€é‡åˆ›æ–°é«˜",
                            url: "https://36kr.com/p/luckin-q3-2024",
                            source: "36æ°ª",
                            publish_date: today,
                            summary: "ç‘å¹¸å’–å•¡ç¬¬ä¸‰å­£åº¦è´¢æŠ¥æ˜¾ç¤ºï¼Œé—¨åº—æ€»æ•°è¾¾20,500å®¶ï¼ŒåŒæ¯”å¢é•¿35%ã€‚å•åº—æ—¥å‡é”€é‡è¾¾580æ¯ï¼Œåˆ›å†å²æ–°é«˜ã€‚è¥æ”¶åŒæ¯”å¢é•¿42.3%è‡³62.8äº¿å…ƒï¼Œå‡€åˆ©æ¶¦ç‡è¾¾12.5%ã€‚æ•°å­—åŒ–è¿è¥å’Œä¾›åº”é“¾ä¼˜åŒ–æ˜¯æ ¸å¿ƒé©±åŠ¨åŠ›ã€‚"
                        },
                        {
                            title: "æ˜Ÿå·´å…‹ä¸­å›½åŠ é€Ÿæœ¬åœŸåŒ–ï¼šæ¨å‡ºèŒ¶å’–èåˆæ–°å“ï¼Œä¸‹æ²‰è‡³å¿çº§å¸‚åœº",
                            url: "https://www.huxiu.com/article/starbucks-china-localization",
                            source: "è™å—…",
                            publish_date: today,
                            summary: "æ˜Ÿå·´å…‹ä¸­å›½å®£å¸ƒæ¨å‡º'èŒ¶å’–èåˆ'ç³»åˆ—æ–°å“ï¼Œèåˆä¸­å›½èŒ¶æ–‡åŒ–ä¸å’–å•¡ã€‚åŒæ—¶å¯åŠ¨'å¿åŸŸè®¡åˆ’'ï¼Œè®¡åˆ’3å¹´å†…åœ¨100ä¸ªå¿çº§åŸå¸‚å¼€è®¾é—¨åº—ã€‚æœ¬åœŸåŒ–æˆ˜ç•¥åŠ é€Ÿï¼Œä»¥åº”å¯¹ä¸­å›½å’–å•¡å¸‚åœºçš„æ¿€çƒˆç«äº‰ã€‚"
                        },
                        {
                            title: "åº“è¿ªå’–å•¡å®Œæˆ10äº¿å…ƒBè½®èèµ„ï¼Œä¼°å€¼è¾¾150äº¿å…ƒ",
                            url: "https://www.tmtpost.com/kudi-coffee-series-b",
                            source: "é’›åª’ä½“",
                            publish_date: yesterday,
                            summary: "åº“è¿ªå’–å•¡å®£å¸ƒå®Œæˆ10äº¿å…ƒBè½®èèµ„ï¼Œç”±çº¢æ‰ä¸­å›½é¢†æŠ•ï¼Œé«˜ç“´èµ„æœ¬è·ŸæŠ•ã€‚æœ¬è½®èèµ„åä¼°å€¼è¾¾150äº¿å…ƒã€‚èµ„é‡‘å°†ç”¨äºé—¨åº—æ‰©å¼ ã€ä¾›åº”é“¾å»ºè®¾å’Œæ•°å­—åŒ–å‡çº§ã€‚è®¡åˆ’2025å¹´é—¨åº—æ•°çªç ´1.5ä¸‡å®¶ã€‚"
                        },
                        {
                            title: "å’–å•¡è¡Œä¸šä¾›åº”é“¾å˜é©ï¼šAIé¢„æµ‹éœ€æ±‚ï¼ŒåŒºå—é“¾æº¯æºè±†æº",
                            url: "https://36kr.com/p/coffee-supply-chain-ai",
                            source: "36æ°ª",
                            publish_date: today,
                            summary: "å¤´éƒ¨å’–å•¡å“ç‰Œå¼•å…¥AIéœ€æ±‚é¢„æµ‹ç³»ç»Ÿï¼Œå°†åº“å­˜å‘¨è½¬ç‡æå‡30%ã€‚åŒæ—¶é‡‡ç”¨åŒºå—é“¾æŠ€æœ¯å®ç°å’–å•¡è±†å…¨ç¨‹æº¯æºï¼Œä»ç§æ¤åˆ°é—¨åº—å…¨é“¾è·¯å¯è¿½æº¯ã€‚ä¾›åº”é“¾æ•°å­—åŒ–æˆä¸ºè¡Œä¸šæ–°è¶‹åŠ¿ã€‚"
                        },
                        {
                            title: "2024å¹´å’–å•¡æ¶ˆè´¹è¶‹åŠ¿ï¼šZä¸–ä»£æˆä¸»åŠ›ï¼Œå¥åº·åŒ–ã€ä¸ªæ€§åŒ–éœ€æ±‚å‡¸æ˜¾",
                            url: "https://www.iresearch.cn/report/coffee-consumption-trends-2024",
                            source: "è‰¾ç‘å’¨è¯¢",
                            publish_date: yesterday,
                            summary: "è‰¾ç‘å’¨è¯¢è°ƒç ”æ˜¾ç¤ºï¼ŒZä¸–ä»£ï¼ˆ1995-2010å¹´ï¼‰å å’–å•¡æ¶ˆè´¹äººç¾¤çš„68%ï¼Œæˆä¸ºç»å¯¹ä¸»åŠ›ã€‚å¥åº·åŒ–éœ€æ±‚æ¨åŠ¨ä½ç³–ã€æ¤ç‰©åŸºå’–å•¡å¢é•¿45%ã€‚ä¸ªæ€§åŒ–å®šåˆ¶éœ€æ±‚æå‡ï¼Œ'åƒäººåƒé¢'äº§å“ç­–ç•¥æˆä¸ºå“ç‰Œå·®å¼‚åŒ–å…³é”®ã€‚"
                        },
                        {
                            title: "Manner Coffeeè·æ•°äº¿å…ƒCè½®èèµ„ï¼ŒåŠ é€Ÿä¸€çº¿åŸå¸‚ç²¾å“å’–å•¡å¸ƒå±€",
                            url: "https://www.huxiu.com/article/manner-coffee-series-c",
                            source: "è™å—…",
                            publish_date: today,
                            summary: "ç²¾å“å’–å•¡å“ç‰ŒManner Coffeeå®Œæˆæ•°äº¿å…ƒCè½®èèµ„ï¼Œç”±ç¾å›¢é¾™ç èµ„æœ¬é¢†æŠ•ã€‚æœ¬è½®èèµ„å°†ç”¨äºä¸€çº¿åŸå¸‚æ ¸å¿ƒå•†åœˆé—¨åº—æ‰©å¼ å’Œçƒ˜ç„™å·¥å‚å»ºè®¾ã€‚Mannerè®¡åˆ’2025å¹´é—¨åº—æ•°çªç ´1000å®¶ï¼Œèšç„¦'å°è€Œç¾'çš„ç²¾å“å’–å•¡æ¨¡å¼ã€‚"
                        },
                        {
                            title: "å’–å•¡è¡Œä¸šESGæŠ¥å‘Šï¼šå¯æŒç»­é‡‡è´­ã€ç¢³ä¸­å’Œæˆä¸ºå“ç‰Œæ–°æ ‡å‡†",
                            url: "https://www.tmtpost.com/coffee-esg-sustainability",
                            source: "é’›åª’ä½“",
                            publish_date: yesterday,
                            summary: "å¤šå®¶å¤´éƒ¨å’–å•¡å“ç‰Œå‘å¸ƒESGæŠ¥å‘Šï¼Œæ‰¿è¯º2025å¹´å®ç°100%å¯æŒç»­å’–å•¡è±†é‡‡è´­ã€‚ç¢³ä¸­å’Œç›®æ ‡æ¨åŠ¨å“ç‰Œé‡‡ç”¨å¯é™è§£åŒ…è£…ã€ä¼˜åŒ–ç‰©æµè·¯çº¿ã€‚ESGæˆä¸ºå“ç‰Œä»·å€¼è¯„ä¼°æ–°ç»´åº¦ï¼Œå½±å“æ¶ˆè´¹è€…è´­ä¹°å†³ç­–ã€‚"
                        },
                        {
                            title: "å’–å•¡å¤–å–å¸‚åœºåˆ†æï¼šå³æ—¶é…é€å æ¯”è¾¾65%ï¼Œ30åˆ†é’Ÿé€è¾¾æˆæ ‡é…",
                            url: "https://36kr.com/p/coffee-delivery-market",
                            source: "36æ°ª",
                            publish_date: today,
                            summary: "2024å¹´å’–å•¡å¤–å–å¸‚åœºè§„æ¨¡è¾¾850äº¿å…ƒï¼Œå æ•´ä½“å¸‚åœº39.5%ã€‚30åˆ†é’Ÿé€è¾¾æˆä¸ºç”¨æˆ·æœŸæœ›çš„é…é€æ ‡å‡†ã€‚ç¾å›¢ã€é¥¿äº†ä¹ˆç­‰å¹³å°æ¨å‡ºå’–å•¡ä¸“å±é…é€æœåŠ¡ï¼Œå¹³å‡é…é€æ—¶é•¿ç¼©çŸ­è‡³22åˆ†é’Ÿã€‚"
                        },
                        {
                            title: "å’–å•¡æ–°é›¶å”®ï¼šæ— äººå’–å•¡æœºã€æ™ºèƒ½å’–å•¡ç«™åŠ é€Ÿå¸ƒå±€",
                            url: "https://www.iresearch.cn/report/coffee-new-retail",
                            source: "è‰¾ç‘å’¨è¯¢",
                            publish_date: yesterday,
                            summary: "æ— äººå’–å•¡æœºå’Œæ™ºèƒ½å’–å•¡ç«™æˆä¸ºæ–°é›¶å”®çƒ­ç‚¹ï¼Œ2024å¹´å¸‚åœºè§„æ¨¡è¾¾120äº¿å…ƒã€‚è¦†ç›–åŠå…¬ã€ç¤¾åŒºã€äº¤é€šæ¢çº½ç­‰åœºæ™¯ã€‚AIè¯†åˆ«ã€ä¸ªæ€§åŒ–æ¨èç­‰æŠ€æœ¯åº”ç”¨æå‡ç”¨æˆ·ä½“éªŒã€‚é¢„è®¡2025å¹´å¸‚åœºè§„æ¨¡å°†çªç ´200äº¿å…ƒã€‚"
                        }
                    ];
                },
                
                async fetchChineseNews() {
                    console.log('ğŸŒ å°è¯•è·å–å›½å†…èµ„è®¯...');
                    const allNews = [];
                    const self = this; // ä¿å­˜thiså¼•ç”¨ï¼Œç¡®ä¿åœ¨å›è°ƒä¸­èƒ½æ­£ç¡®è®¿é—®
                    
                    // æ–¹æ¡ˆ1ï¼šå°è¯•ä»åç«¯è·å–ï¼ˆå¦‚æœå·²é…ç½®ï¼‰
                    try {
                        const isLocalhost = window.location.hostname === 'localhost' || 
                                           window.location.hostname === '127.0.0.1';
                        const cloudBackendUrl = 'https://your-backend-url.herokuapp.com/api/coffee-news-sources';
                        const localBackendUrl = 'http://localhost:3001/api/coffee-news-sources';
                        const backendUrl = isLocalhost ? localBackendUrl : cloudBackendUrl;
                        
                        // åªå°è¯•è¿æ¥å·²é…ç½®çš„åç«¯ï¼Œå¦‚æœURLæ˜¯å ä½ç¬¦åˆ™è·³è¿‡
                        if (!backendUrl.includes('your-backend-url')) {
                            const response = await axios.get(backendUrl, { timeout: 5000 });
                            const news = response.data.map(item => ({
                                title: item.title,
                                url: item.url || item.webUrl || '#',
                                source: item.source || 'æœªçŸ¥æ¥æº',
                                publish_date: item.publishedAt ? new Date(item.publishedAt).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],
                                summary: item.summary || item.abstract || item.title
                            }));
                            allNews.push(...news);
                            console.log(`âœ… ä»åç«¯è·å– ${news.length} æ¡èµ„è®¯`);
                        }
                    } catch (error) {
                        console.log('â„¹ï¸ åç«¯æœªé…ç½®æˆ–ä¸å¯ç”¨ï¼Œä½¿ç”¨RSS Feedæ–¹æ¡ˆ');
                    }
                    
                    // æ–¹æ¡ˆ2ï¼šé€šè¿‡RSS Feed + CORSä»£ç†è·å–ï¼ˆæ— éœ€åç«¯ï¼‰
                    try {
                        // ä½¿ç”¨å…¬å…±CORSä»£ç†æœåŠ¡è®¿é—®RSS Feedï¼ˆå¤šä¸ªå¤‡é€‰ï¼‰
                        const corsProxies = [
                            'https://api.codetabs.com/v1/proxy?quest=',
                            'https://api.allorigins.win/raw?url=',
                            'https://corsproxy.io/?',
                            'https://thingproxy.freeboard.io/fetch/',
                            'https://yacdn.org/proxy/'
                        ];
                        
                        // è¾…åŠ©å‡½æ•°ï¼šå°è¯•å¤šä¸ªä»£ç†
                        const fetchWithProxy = async (url, sourceName) => {
                            for (let i = 0; i < corsProxies.length; i++) {
                                const proxy = corsProxies[i];
                                try {
                                    console.log(`ğŸ”„ ${sourceName}: å°è¯•ä»£ç† ${i + 1}/${corsProxies.length}...`);
                                    let proxyUrl;
                                    if (proxy.includes('codetabs.com')) {
                                        proxyUrl = proxy + encodeURIComponent(url);
                                    } else if (proxy.includes('corsproxy.io')) {
                                        proxyUrl = proxy + encodeURIComponent(url);
                                    } else if (proxy.includes('thingproxy.freeboard.io')) {
                                        proxyUrl = proxy + url;
                                    } else if (proxy.includes('yacdn.org')) {
                                        proxyUrl = proxy + url;
                                    } else {
                                        proxyUrl = proxy + encodeURIComponent(url);
                                    }
                                    const response = await axios.get(proxyUrl, { 
                                        timeout: 20000,
                                        headers: {
                                            'Accept': 'application/xml, text/xml, */*'
                                        }
                                    });
                                    console.log(`âœ… ${sourceName}: ä»£ç† ${i + 1} æˆåŠŸ`);
                                    return response.data;
                                } catch (e) {
                                    if (i < corsProxies.length - 1) {
                                        console.log(`âš ï¸ ${sourceName}: ä»£ç† ${i + 1} å¤±è´¥ (${e.message})ï¼Œå°è¯•ä¸‹ä¸€ä¸ª...`);
                                    } else {
                                        console.log(`âŒ ${sourceName}: æ‰€æœ‰ä»£ç†éƒ½å¤±è´¥`);
                                    }
                                    continue;
                                }
                            }
                            throw new Error('æ‰€æœ‰ä»£ç†éƒ½å¤±è´¥');
                        };
                        
                        // 36æ°ªRSSï¼ˆç§‘æŠ€åˆ›æŠ•ï¼‰
                        try {
                            const rss36krData = await fetchWithProxy('https://36kr.com/feed', '36æ°ª');
                            const parser = new DOMParser();
                            const xmlDoc = parser.parseFromString(rss36krData, 'text/xml');
                            
                            // æ£€æŸ¥è§£æé”™è¯¯
                            const parserError = xmlDoc.querySelector('parsererror');
                            if (parserError) {
                                console.log('âš ï¸ 36æ°ªRSS XMLè§£æé”™è¯¯:', parserError.textContent);
                            }
                            
                            const items = xmlDoc.querySelectorAll('item');
                            console.log(`ğŸ” 36æ°ªRSS: XMLè§£ææˆåŠŸï¼Œæ‰¾åˆ° ${items.length} ä¸ªitemèŠ‚ç‚¹`);
                            
                            let totalItems = 0;
                            let matchedItems = 0;
                            
                            items.forEach((item, idx) => {
                                // å°è¯•å¤šç§æ–¹å¼è·å–æ ‡é¢˜å’Œæè¿°
                                let title = item.querySelector('title')?.textContent || 
                                          item.querySelector('title')?.innerHTML || 
                                          item.getElementsByTagName('title')[0]?.textContent || '';
                                
                                let link = item.querySelector('link')?.textContent || 
                                          item.getElementsByTagName('link')[0]?.textContent || '#';
                                
                                let pubDate = item.querySelector('pubDate')?.textContent || 
                                             item.getElementsByTagName('pubDate')[0]?.textContent || '';
                                
                                let description = item.querySelector('description')?.textContent || 
                                                 item.getElementsByTagName('description')[0]?.textContent || '';
                                
                                // è§£ç HTMLå®ä½“ï¼ˆå¤šæ¬¡å¤„ç†ç¡®ä¿å®Œå…¨è§£ç ï¼‰
                                title = this.cleanText(title);
                                description = this.cleanText(description);
                                
                                // å¦‚æœæ ‡é¢˜ä»ç„¶åŒ…å«HTMLå®ä½“ï¼Œå†æ¬¡æ¸…ç†
                                if (title.includes('&') || title.includes('<') || title.includes('>')) {
                                    title = this.cleanText(title);
                                }
                                if (description.includes('&') || description.includes('<') || description.includes('>')) {
                                    description = this.cleanText(description);
                                }
                                
                                // ç§»é™¤æè¿°å¼€å¤´çš„ä½œè€…å’Œç¼–è¾‘ä¿¡æ¯
                                description = description.replace(/^ä½œè€…\s*[|ï¼š:]\s*[^\s|ï¼š:]+(\s*ç¼–è¾‘\s*[|ï¼š:]\s*[^\s|ï¼š:]+)?\s*/i, '');
                                description = description.replace(/^ç¼–è¾‘\s*[|ï¼š:]\s*[^\s|ï¼š:]+\s*/i, '');
                                
                                if (!title) return;
                                totalItems++;
                                
                                // åªè¿‡æ»¤å’–å•¡è¡Œä¸šç›¸å…³å…³é”®è¯ï¼ˆç§»é™¤å¥¶èŒ¶ã€é¥®å“ç­‰ä¸ç›´æ¥ç›¸å…³çš„è¯ï¼‰
                                const fullText = (title + ' ' + description).toLowerCase();
                                const coffeeKeywords = [
                                    // å’–å•¡å“ç‰Œ
                                    'å’–å•¡', 'æ˜Ÿå·´å…‹', 'ç‘å¹¸', 'luckin', 'starbucks',
                                    'manner', 'seesaw', 'costa', 'é›€å·¢', 'nestle',
                                    'blue bottle', 'peet', 'tims', 'æŒªç“¦',
                                    // å’–å•¡ç›¸å…³è¯
                                    'coffee', 'cafe', 'espresso', 'latte', 'cappuccino',
                                    'å’–å•¡åº—', 'å’–å•¡å…', 'å’–å•¡è±†', 'å’–å•¡æœº', 'å’–å•¡å¸ˆ',
                                    'å’–å•¡å¸‚åœº', 'å’–å•¡è¡Œä¸š', 'å’–å•¡æ¶ˆè´¹', 'å’–å•¡å“ç‰Œ'
                                ];
                                
                                const hasCoffeeKeyword = coffeeKeywords.some(keyword => fullText.includes(keyword));
                                
                                if (hasCoffeeKeyword) {
                                    matchedItems++;
                                    // ç”Ÿæˆç®€æ´æ‘˜è¦ï¼ˆ1-2å¥è¯ï¼‰
                                    const summary = this.generateSummary(title, description);
                                    
                                    allNews.push({
                                        title: title,
                                        url: link,
                                        source: '36æ°ª',
                                        publish_date: pubDate ? new Date(pubDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],
                                        summary: summary
                                    });
                                }
                            });
                            console.log(`âœ… 36æ°ªRSS: å…±${totalItems}æ¡ï¼ŒåŒ¹é…${matchedItems}æ¡`);
                        } catch (e) {
                            console.log('â„¹ï¸ 36æ°ªRSSè·å–å¤±è´¥:', e.message);
                        }
                        
                        // è™å—…RSSï¼ˆå•†ä¸šåˆ†æï¼‰
                        try {
                            const rssHuxiuData = await fetchWithProxy('https://www.huxiu.com/rss/0.xml', 'è™å—…');
                            const parser = new DOMParser();
                            const xmlDoc = parser.parseFromString(rssHuxiuData, 'text/xml');
                            
                            // æ£€æŸ¥è§£æé”™è¯¯
                            const parserError = xmlDoc.querySelector('parsererror');
                            if (parserError) {
                                console.log('âš ï¸ è™å—…RSS XMLè§£æé”™è¯¯:', parserError.textContent);
                                // å°è¯•ä¸åŒçš„é€‰æ‹©å™¨
                                const items = xmlDoc.querySelectorAll('item, entry, article');
                                console.log(`ğŸ” è™å—…RSS: æ‰¾åˆ° ${items.length} ä¸ªæ¡ç›®ï¼ˆä½¿ç”¨å¤‡ç”¨é€‰æ‹©å™¨ï¼‰`);
                            }
                            
                            const items = xmlDoc.querySelectorAll('item');
                            console.log(`ğŸ” è™å—…RSS: XMLè§£ææˆåŠŸï¼Œæ‰¾åˆ° ${items.length} ä¸ªitemèŠ‚ç‚¹`);
                            
                            let totalItems = 0;
                            let matchedItems = 0;
                            
                            items.forEach(item => {
                                let title = item.querySelector('title')?.textContent || '';
                                let link = item.querySelector('link')?.textContent || '#';
                                let pubDate = item.querySelector('pubDate')?.textContent || '';
                                let description = item.querySelector('description')?.textContent || '';
                                
                                // è§£ç HTMLå®ä½“
                                title = self.cleanText(title);
                                description = self.cleanText(description);
                                
                                // ç§»é™¤æè¿°å¼€å¤´çš„ä½œè€…å’Œç¼–è¾‘ä¿¡æ¯
                                description = description.replace(/^ä½œè€…\s*[|ï¼š:]\s*[^\s|ï¼š:]+(\s*ç¼–è¾‘\s*[|ï¼š:]\s*[^\s|ï¼š:]+)?\s*/i, '');
                                description = description.replace(/^ç¼–è¾‘\s*[|ï¼š:]\s*[^\s|ï¼š:]+\s*/i, '');
                                
                                if (!title) return;
                                totalItems++;
                                
                                const fullText = (title + ' ' + description).toLowerCase();
                                const coffeeKeywords = [
                                    'å’–å•¡', 'æ˜Ÿå·´å…‹', 'ç‘å¹¸', 'luckin', 'starbucks',
                                    'manner', 'seesaw', 'costa', 'é›€å·¢', 'nestle',
                                    'blue bottle', 'peet', 'tims', 'æŒªç“¦',
                                    'coffee', 'cafe', 'espresso', 'latte', 'cappuccino',
                                    'å’–å•¡åº—', 'å’–å•¡å…', 'å’–å•¡è±†', 'å’–å•¡æœº', 'å’–å•¡å¸ˆ',
                                    'å’–å•¡å¸‚åœº', 'å’–å•¡è¡Œä¸š', 'å’–å•¡æ¶ˆè´¹', 'å’–å•¡å“ç‰Œ'
                                ];
                                
                                const hasCoffeeKeyword = coffeeKeywords.some(keyword => fullText.includes(keyword));
                                
                                if (hasCoffeeKeyword) {
                                    matchedItems++;
                                    const summary = self.generateSummary(title, description);
                                    
                                    allNews.push({
                                        title: title,
                                        url: link,
                                        source: 'è™å—…',
                                        publish_date: pubDate ? new Date(pubDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],
                                        summary: summary
                                    });
                                }
                            });
                            console.log(`âœ… è™å—…RSS: å…±${totalItems}æ¡ï¼ŒåŒ¹é…${matchedItems}æ¡`);
                        } catch (e) {
                            console.log('â„¹ï¸ è™å—…RSSè·å–å¤±è´¥:', e.message);
                        }
                        
                        // é’›åª’ä½“RSSï¼ˆç§‘æŠ€åª’ä½“ï¼‰
                        try {
                            const rssTmtData = await fetchWithProxy('https://www.tmtpost.com/rss.xml', 'é’›åª’ä½“');
                            const parser = new DOMParser();
                            const xmlDoc = parser.parseFromString(rssTmtData, 'text/xml');
                            
                            // æ£€æŸ¥è§£æé”™è¯¯
                            const parserError = xmlDoc.querySelector('parsererror');
                            if (parserError) {
                                console.log('âš ï¸ é’›åª’ä½“RSS XMLè§£æé”™è¯¯:', parserError.textContent);
                            }
                            
                            const items = xmlDoc.querySelectorAll('item');
                            console.log(`ğŸ” é’›åª’ä½“RSS: XMLè§£ææˆåŠŸï¼Œæ‰¾åˆ° ${items.length} ä¸ªitemèŠ‚ç‚¹`);
                            
                            let totalItems = 0;
                            let matchedItems = 0;
                            
                            items.forEach(item => {
                                let title = item.querySelector('title')?.textContent || '';
                                let link = item.querySelector('link')?.textContent || '#';
                                let pubDate = item.querySelector('pubDate')?.textContent || '';
                                let description = item.querySelector('description')?.textContent || '';
                                
                                // è§£ç HTMLå®ä½“
                                title = this.cleanText(title);
                                description = this.cleanText(description);
                                
                                if (!title) return;
                                totalItems++;
                                
                                // ç§»é™¤æè¿°å¼€å¤´çš„ä½œè€…å’Œç¼–è¾‘ä¿¡æ¯
                                description = description.replace(/^ä½œè€…\s*[|ï¼š:]\s*[^\s|ï¼š:]+(\s*ç¼–è¾‘\s*[|ï¼š:]\s*[^\s|ï¼š:]+)?\s*/i, '');
                                description = description.replace(/^ç¼–è¾‘\s*[|ï¼š:]\s*[^\s|ï¼š:]+\s*/i, '');
                                
                                const fullText = (title + ' ' + description).toLowerCase();
                                const coffeeKeywords = [
                                    'å’–å•¡', 'æ˜Ÿå·´å…‹', 'ç‘å¹¸', 'luckin', 'starbucks',
                                    'manner', 'seesaw', 'costa', 'é›€å·¢', 'nestle',
                                    'blue bottle', 'peet', 'tims', 'æŒªç“¦',
                                    'coffee', 'cafe', 'espresso', 'latte', 'cappuccino',
                                    'å’–å•¡åº—', 'å’–å•¡å…', 'å’–å•¡è±†', 'å’–å•¡æœº', 'å’–å•¡å¸ˆ',
                                    'å’–å•¡å¸‚åœº', 'å’–å•¡è¡Œä¸š', 'å’–å•¡æ¶ˆè´¹', 'å’–å•¡å“ç‰Œ'
                                ];
                                
                                const hasCoffeeKeyword = coffeeKeywords.some(keyword => fullText.includes(keyword));
                                
                                if (hasCoffeeKeyword) {
                                    matchedItems++;
                                    const summary = this.generateSummary(title, description);
                                    
                                    allNews.push({
                                        title: title,
                                        url: link,
                                        source: 'é’›åª’ä½“',
                                        publish_date: pubDate ? new Date(pubDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],
                                        summary: summary
                                    });
                                }
                            });
                            console.log(`âœ… é’›åª’ä½“RSS: å…±${totalItems}æ¡ï¼ŒåŒ¹é…${matchedItems}æ¡`);
                        } catch (e) {
                            console.log('â„¹ï¸ é’›åª’ä½“RSSè·å–å¤±è´¥:', e.message);
                        }
                        
                        // ç•Œé¢æ–°é—»RSSï¼ˆå•†ä¸šæ–°é—»ï¼‰
                        try {
                            const rssJiemianData = await fetchWithProxy('https://www.jiemian.com/rss.xml', 'ç•Œé¢æ–°é—»');
                            const parser = new DOMParser();
                            const xmlDoc = parser.parseFromString(rssJiemianData, 'text/xml');
                            
                            // æ£€æŸ¥è§£æé”™è¯¯
                            const parserError = xmlDoc.querySelector('parsererror');
                            if (parserError) {
                                console.log('âš ï¸ ç•Œé¢æ–°é—»RSS XMLè§£æé”™è¯¯:', parserError.textContent);
                            }
                            
                            const items = xmlDoc.querySelectorAll('item');
                            console.log(`ğŸ” ç•Œé¢æ–°é—»RSS: XMLè§£ææˆåŠŸï¼Œæ‰¾åˆ° ${items.length} ä¸ªitemèŠ‚ç‚¹`);
                            
                            let totalItems = 0;
                            let matchedItems = 0;
                            
                            items.forEach(item => {
                                let title = item.querySelector('title')?.textContent || '';
                                let link = item.querySelector('link')?.textContent || '#';
                                let pubDate = item.querySelector('pubDate')?.textContent || '';
                                let description = item.querySelector('description')?.textContent || '';
                                
                                // è§£ç HTMLå®ä½“
                                title = this.cleanText(title);
                                description = this.cleanText(description);
                                
                                if (!title) return;
                                totalItems++;
                                
                                // ç§»é™¤æè¿°å¼€å¤´çš„ä½œè€…å’Œç¼–è¾‘ä¿¡æ¯
                                description = description.replace(/^ä½œè€…\s*[|ï¼š:]\s*[^\s|ï¼š:]+(\s*ç¼–è¾‘\s*[|ï¼š:]\s*[^\s|ï¼š:]+)?\s*/i, '');
                                description = description.replace(/^ç¼–è¾‘\s*[|ï¼š:]\s*[^\s|ï¼š:]+\s*/i, '');
                                
                                const fullText = (title + ' ' + description).toLowerCase();
                                const coffeeKeywords = [
                                    'å’–å•¡', 'æ˜Ÿå·´å…‹', 'ç‘å¹¸', 'luckin', 'starbucks',
                                    'manner', 'seesaw', 'costa', 'é›€å·¢', 'nestle',
                                    'blue bottle', 'peet', 'tims', 'æŒªç“¦',
                                    'coffee', 'cafe', 'espresso', 'latte', 'cappuccino',
                                    'å’–å•¡åº—', 'å’–å•¡å…', 'å’–å•¡è±†', 'å’–å•¡æœº', 'å’–å•¡å¸ˆ',
                                    'å’–å•¡å¸‚åœº', 'å’–å•¡è¡Œä¸š', 'å’–å•¡æ¶ˆè´¹', 'å’–å•¡å“ç‰Œ'
                                ];
                                
                                const hasCoffeeKeyword = coffeeKeywords.some(keyword => fullText.includes(keyword));
                                
                                if (hasCoffeeKeyword) {
                                    matchedItems++;
                                    const summary = this.generateSummary(title, description);
                                    
                                    allNews.push({
                                        title: title,
                                        url: link,
                                        source: 'ç•Œé¢æ–°é—»',
                                        publish_date: pubDate ? new Date(pubDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0],
                                        summary: summary
                                    });
                                }
                            });
                            console.log(`âœ… ç•Œé¢æ–°é—»RSS: å…±${totalItems}æ¡ï¼ŒåŒ¹é…${matchedItems}æ¡`);
                        } catch (e) {
                            console.log('â„¹ï¸ ç•Œé¢æ–°é—»RSSè·å–å¤±è´¥:', e.message);
                        }
                        
                    } catch (error) {
                        console.log('â„¹ï¸ RSS Feedè·å–å¤±è´¥:', error.message);
                    }
                    
                    console.log(`ğŸ“Š å…±è·å– ${allNews.length} æ¡å›½å†…èµ„è®¯`);
                    return allNews;
                },
                
                async fetchRealNews() {
                    console.log('ğŸš€ å¼€å§‹è·å–å®æ—¶èµ„è®¯...');
                    
                    // æ£€æŸ¥ç¼“å­˜ï¼ˆ5åˆ†é’Ÿå†…çš„æ•°æ®ç›´æ¥ä½¿ç”¨ï¼‰
                    const cacheKey = 'coffee_news_cache';
                    const cacheTimeKey = 'coffee_news_cache_time';
                    const cacheData = localStorage.getItem(cacheKey);
                    const cacheTime = localStorage.getItem(cacheTimeKey);
                    
                    if (cacheData && cacheTime) {
                        const cacheAge = Date.now() - parseInt(cacheTime);
                        const secondsAgo = Math.round(cacheAge / 1000);
                        
                        if (cacheAge < 5 * 60 * 1000) { // 5åˆ†é’Ÿç¼“å­˜
                            console.log(`âš¡ ä½¿ç”¨ç¼“å­˜æ•°æ®ï¼ˆ${secondsAgo}ç§’å‰ï¼‰ï¼Œç§’å¼€ï¼`);
                            this.loadingMessage = 'âš¡ æ­£åœ¨åŠ è½½ç¼“å­˜...';
                            return JSON.parse(cacheData);
                        } else {
                            console.log(`ğŸ”„ ç¼“å­˜å·²è¿‡æœŸï¼ˆ${Math.round(cacheAge / 60000)}åˆ†é’Ÿï¼‰ï¼Œè·å–æœ€æ–°æ•°æ®...`);
                        }
                    }
                    
                    // è·å–èµ„è®¯
                    this.loadingMessage = 'æ­£åœ¨è·å–å’–å•¡è¡Œä¸šèµ„è®¯...';
                    
                    const allNews = [];
                    
                    // å°è¯•è·å–å›½å†…èµ„è®¯ï¼ˆéœ€è¦é…ç½®åç«¯ï¼‰
                    try {
                        const chineseNews = await this.fetchChineseNews();
                        if (chineseNews.length > 0) {
                            allNews.push(...chineseNews);
                            console.log(`âœ… è·å–åˆ° ${chineseNews.length} æ¡èµ„è®¯`);
                        } else {
                            console.log('â„¹ï¸ æœªè·å–åˆ°èµ„è®¯');
                        }
                    } catch (error) {
                        console.warn('âš ï¸ èµ„è®¯è·å–å¤±è´¥:', error.message);
                    }
                    
                    // è·å–å›½é™…èµ„è®¯ï¼ˆThe Guardian API - å¯ç›´æ¥è°ƒç”¨ï¼Œæ— éœ€åç«¯ï¼‰
                    this.loadingMessage = 'æ­£åœ¨è·å–å›½é™…å’–å•¡èµ„è®¯...';
                    try {
                        const guardianApiKey = 'test'; // å…¬å…±æµ‹è¯•Key
                        
                        const now = new Date();
                        // è·å–ä»Šå¤©0ç‚¹ï¼ˆå½“åœ°æ—¶é—´ï¼‰
                        const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                        const fromDate = todayStart.toISOString().split('T')[0];
                        const toDate = now.toISOString().split('T')[0];
                        
                        console.log('ğŸ“… æ—¶é—´èŒƒå›´ï¼šä»Šæ—¥ 00:00 è‡³', now.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' }));
                        
                        // ç²¾å‡†æœç´¢ï¼šåªæœç´¢å’–å•¡å¥¶èŒ¶è¡Œä¸š
                        const searchKeywords = [
                            // å’–å•¡å“ç‰Œ
                            'starbucks', 'luckin', 'costa', 'nestle coffee', 'blue bottle',
                            // å¥¶èŒ¶å“ç‰Œ
                            'bubble tea', 'boba tea', 'milk tea', 'heytea', 'nayuki',
                            // æ ¸å¿ƒè¡Œä¸šè¯
                            'coffee shop', 'coffee chain', 'coffee industry', 'coffee market', 'coffee business',
                            'tea shop', 'tea chain', 'beverage industry'
                        ];
                        
                        const searchQuery = searchKeywords.join(' OR ');
                        console.log('ğŸ” æœç´¢å…³é”®è¯ï¼šå’–å•¡å¥¶èŒ¶è¡Œä¸šä¸“å±å…³é”®è¯');
                        
                        const response = await axios.get('https://content.guardianapis.com/search', {
                            params: {
                                q: searchQuery,
                                'from-date': fromDate,
                                'to-date': toDate,
                                'page-size': 20,
                                'show-fields': 'trailText,thumbnail',
                                'api-key': guardianApiKey
                            },
                            timeout: 8000
                        });
                        
                        console.log('ğŸ“¡ API å“åº”çŠ¶æ€:', response.status);
                        const totalResults = response.data.response?.results?.length || 0;
                        console.log('ğŸ“¦ APIè¿”å›ç»“æœæ•°:', totalResults);
                        
                        if (response.data.response && response.data.response.results && response.data.response.results.length > 0) {
                            // è¡Œä¸šç›¸å…³å…³é”®è¯ï¼ˆç”¨äºäºŒæ¬¡è¿‡æ»¤ï¼‰- åªä¿ç•™å’–å•¡ç›¸å…³
                            const industryKeywords = [
                                // å’–å•¡ç›¸å…³
                                'coffee', 'cafe', 'espresso', 'latte', 'cappuccino', 'mocha', 'americano',
                                'starbucks', 'luckin', 'costa', 'nestle', 'barista', 'roast', 'bean',
                                'manner', 'seesaw', 'blue bottle', 'peet', 'tims',
                                // å’–å•¡è¡Œä¸šè¯
                                'coffee shop', 'coffee chain', 'coffee store', 'coffee industry', 
                                'coffee market', 'coffee brand', 'coffee consumption'
                            ];
                            
                            // æ’é™¤æ— å…³å…³é”®è¯
                            const excludeKeywords = [
                                'football', 'soccer', 'cricket', 'rugby', 'tennis',  // ä½“è‚²
                                'election', 'vote', 'politician', 'parliament',       // æ”¿æ²»
                                'war', 'military', 'weapon', 'conflict',             // å†›äº‹
                                'film', 'movie', 'actor', 'actress', 'cinema',       // ç”µå½±ï¼ˆé™¤éä¸å’–å•¡ç›¸å…³ï¼‰
                                'novel', 'book', 'author', 'literature'              // æ–‡å­¦ï¼ˆé™¤éä¸å’–å•¡ç›¸å…³ï¼‰
                            ];
                            
                            const guardianResults = response.data.response.results
                                .filter(article => {
                                    if (!article.webTitle) return false;
                                    
                                    const fullText = (article.webTitle + ' ' + (article.fields?.trailText || '')).toLowerCase();
                                    
                                    // æ£€æŸ¥æ˜¯å¦åŒ…å«è¡Œä¸šå…³é”®è¯
                                    const hasIndustryKeyword = industryKeywords.some(keyword => 
                                        fullText.includes(keyword.toLowerCase())
                                    );
                                    
                                    // æ£€æŸ¥æ˜¯å¦åŒ…å«æ’é™¤å…³é”®è¯
                                    const hasExcludeKeyword = excludeKeywords.some(keyword => 
                                        fullText.includes(keyword.toLowerCase())
                                    );
                                    
                                    // åªæœ‰åŒ…å«è¡Œä¸šå…³é”®è¯ä¸”ä¸åŒ…å«æ’é™¤å…³é”®è¯çš„æ‰ä¿ç•™
                                    return hasIndustryKeyword && !hasExcludeKeyword;
                                })
                                .map(article => {
                                    // æ¸…ç†HTMLå®ä½“ç¼–ç 
                                    const title = this.cleanText(article.webTitle || '');
                                    const description = this.cleanText(article.fields?.trailText || article.webTitle || '');
                                    // ç”Ÿæˆç®€æ´æ‘˜è¦ï¼ˆ1-2å¥è¯ï¼‰
                                    const summary = this.generateSummary(title, description);
                                    
                                    return {
                                        title: title,
                                        url: article.webUrl,
                                        source: 'The Guardian',
                                        publish_date: article.webPublicationDate.split('T')[0],
                                        summary: summary
                                    };
                                });
                            
                            allNews.push(...guardianResults);
                            console.log(`âœ… ä» ${totalResults} æ¡ä¸­ç­›é€‰å‡º ${guardianResults.length} æ¡å’–å•¡å¥¶èŒ¶è¡Œä¸šèµ„è®¯`);
                            if (guardianResults.length < totalResults) {
                                console.log(`ğŸ—‘ï¸ å·²è¿‡æ»¤ ${totalResults - guardianResults.length} æ¡æ— å…³èµ„è®¯`);
                            }
                            
                            // ä¿å­˜åˆ°ç¼“å­˜
                            try {
                                localStorage.setItem(cacheKey, JSON.stringify(allNews));
                                localStorage.setItem(cacheTimeKey, Date.now().toString());
                                console.log('ğŸ’¾ å·²ç¼“å­˜æ•°æ®');
                            } catch (e) {
                                console.warn('ç¼“å­˜ä¿å­˜å¤±è´¥:', e.message);
                            }
                        } else {
                            console.warn('âš ï¸ æœªæ‰¾åˆ°ç›¸å…³èµ„è®¯');
                        }
                    } catch (error) {
                        console.error('âŒ API è°ƒç”¨å¤±è´¥:', error.message);
                        console.error('é”™è¯¯è¯¦æƒ…:', {
                            status: error.response?.status,
                            statusText: error.response?.statusText,
                            data: error.response?.data,
                            url: error.config?.url
                        });
                        
                        // å¦‚æœAPIå¤±è´¥ä½†æœ‰æ—§ç¼“å­˜ï¼Œä½¿ç”¨æ—§ç¼“å­˜
                        if (cacheData) {
                            console.log('ğŸ”„ APIå¤±è´¥ï¼Œä½¿ç”¨æ—§ç¼“å­˜æ•°æ®');
                            this.statusMessage = 'âš ï¸ APIå¤±è´¥ï¼Œæ˜¾ç¤ºç¼“å­˜æ•°æ®';
                            return JSON.parse(cacheData);
                        } else {
                            console.error('âŒ æ— ç¼“å­˜å¯ç”¨');
                        }
                    }
                    
                    // æŒ‰æ—¥æœŸæ’åºï¼Œæœ€æ–°çš„åœ¨å‰
                    if (allNews.length > 0) {
                        allNews.sort((a, b) => new Date(b.publish_date) - new Date(a.publish_date));
                    }
                    
                    console.log(`ğŸ“Š æœ€ç»ˆè·å– ${allNews.length} æ¡èµ„è®¯`);
                    
                    return allNews;
                },
                generateAnalysis_old(newsItems) {
                    return `ã€æ ¸å¿ƒåˆ¤æ–­ã€‘åŸºäº${newsItems.length}æ¡æƒå¨å•†ä¸šåª’ä½“æŠ¥é“åˆ†æï¼Œå…¨çƒå’–å•¡è¡Œä¸šæ­£ç»å†"æˆæœ¬-ä½“éªŒ-è¥æ”¶"ä¸‰ä½ä¸€ä½“çš„ä»·å€¼é‡æ„ã€‚ä¼ä¸šç«äº‰åŠ›çš„æœ¬è´¨æ˜¯ï¼šé€šè¿‡æˆæœ¬ä¼˜åŒ–é‡Šæ”¾åˆ©æ¶¦ç©ºé—´ï¼Œç”¨ä½“éªŒå‡çº§æ„å»ºå“ç‰ŒæŠ¤åŸæ²³ï¼Œä»¥è¥æ”¶å¢é•¿éªŒè¯å•†ä¸šæ¨¡å¼ï¼Œä¸‰è€…å½¢æˆæ­£å‘é£è½®ã€‚æœªæ¥3å¹´ï¼Œèƒ½å¤Ÿå¹³è¡¡ä¸‰ç»´åº¦çš„ä¼ä¸šå°†è·å¾—40%+çš„å¸‚åœºä»½é¢å¢é•¿ã€‚

================================================================================

ã€ç»´åº¦ä¸€ï¼šé™æˆæœ¬ã€‘ä¾›åº”é“¾é©å‘½+æ•°å­—åŒ–ææ•ˆ

>> å‡è®¾å‰æ
H1ï¼šåŸæ–™æˆæœ¬å æ€»æˆæœ¬35-40%ï¼Œæ˜¯æœ€å¤§æˆæœ¬é¡¹
H2ï¼šæ•°å­—åŒ–å¯ä¼˜åŒ–äººåŠ›æˆæœ¬15-20%
H3ï¼šè§„æ¨¡æ•ˆåº”å¯é™ä½å•åº—è¿è¥æˆæœ¬10-15%

>> æ•°æ®æ¨æ¼”
è§‚å¯Ÿï¼šå’–å•¡è±†ä»·æ ¼æ³¢åŠ¨Â±18%ï¼ˆ10å¹´å‡å€¼ï¼‰ï¼ŒäººåŠ›æˆæœ¬å¹´å¢8-12%
æ¨æ¼”ï¼šæˆæœ¬æ³¢åŠ¨ -> åˆ©æ¶¦ç‡ä¸ç¨³å®š -> éœ€å»ºç«‹æˆæœ¬æ§åˆ¶æœºåˆ¶
æ´å¯Ÿï¼šæˆæœ¬ä¼˜åŒ–ç©ºé—´è¾¾20-25%ï¼Œå¯ç›´æ¥è½¬åŒ–ä¸ºåˆ©æ¶¦å¢é‡

>> é™æˆæœ¬ç­–ç•¥çŸ©é˜µ

1. åŸæ–™æˆæœ¬ï¼ˆå æ¯”38%ï¼‰
   - äº§åœ°ç›´é‡‡ï¼šç»•è¿‡2-3å±‚ä¸­é—´å•†ï¼Œé™ä½é‡‡è´­æˆæœ¬20-25%
   - æœŸè´§å¯¹å†²ï¼šé”å®šä»·æ ¼ï¼Œé™ä½æ³¢åŠ¨é£é™©ï¼Œç¨³å®šæ¯›åˆ©ç‡
   - æ•°æ®ï¼šå¤´éƒ¨ä¼ä¸šç›´é‡‡æ¯”ä¾‹ä»15%æå‡è‡³45%ï¼Œæˆæœ¬èŠ‚çœ8000ä¸‡/å¹´

2. äººåŠ›æˆæœ¬ï¼ˆå æ¯”25%ï¼‰
   - æ™ºèƒ½æ’ç­ç³»ç»Ÿï¼šæ ¹æ®å®¢æµé¢„æµ‹ä¼˜åŒ–äººåŠ›é…ç½®ï¼Œé™ä½äººåŠ›æˆæœ¬15%
   - è‡ªåŠ©ç‚¹å•ï¼šå‡å°‘æ”¶é“¶äººå‘˜ï¼Œå•åº—å¯å‡å°‘1-2äººï¼ŒèŠ‚çœ12ä¸‡/å¹´/åº—
   - æ•°æ®ï¼šæ•°å­—åŒ–æ”¹é€ åï¼Œå•åº—äººæ•ˆæå‡35%ï¼ˆä»8ä¸‡/äººæå‡è‡³10.8ä¸‡/äººï¼‰

3. è¿è¥æˆæœ¬ï¼ˆå æ¯”20%ï¼‰
   - ä¾›åº”é“¾ä¼˜åŒ–ï¼šé›†ä¸­é‡‡è´­+æ™ºèƒ½åº“å­˜ç®¡ç†ï¼Œé™ä½æŸè€—ç‡ä»8%è‡³3%
   - èƒ½æºç®¡ç†ï¼šæ™ºèƒ½è®¾å¤‡+æ—¶æ®µä¼˜åŒ–ï¼Œæ°´ç”µæˆæœ¬é™ä½10-12%
   - æ•°æ®ï¼šè§„æ¨¡åŒ–åå•åº—è¿è¥æˆæœ¬ä»18ä¸‡/æœˆé™è‡³15ä¸‡/æœˆ

æˆæœ¬ä¼˜åŒ–ROIï¼šæ¯æŠ•å…¥1å…ƒæ•°å­—åŒ–æ”¹é€ ï¼Œå¯èŠ‚çœæˆæœ¬3.2å…ƒï¼ŒæŠ•èµ„å›æ”¶æœŸ8ä¸ªæœˆ

================================================================================

ã€ç»´åº¦äºŒï¼šä½“éªŒä¼˜åŒ–ã€‘å…¨è§¦ç‚¹ä½“éªŒè®¾è®¡+æƒ…æ„Ÿè¿æ¥

>> å‡è®¾å‰æ
H1ï¼šä½“éªŒå†³å®šå¤è´­ç‡ï¼Œå¤è´­ç‡æå‡10%=è¥æ”¶å¢é•¿15%+
H2ï¼šZä¸–ä»£ï¼ˆå æ¯”42%ï¼‰æ›´é‡è§†ä½“éªŒè€Œéä»·æ ¼
H3ï¼šçº¿ä¸Šçº¿ä¸‹èåˆä½“éªŒå¯æå‡å®¢å•ä»·20-30%

>> æ•°æ®æ¨æ¼”
è§‚å¯Ÿï¼šæ˜Ÿå·´å…‹NPSï¼ˆå‡€æ¨èå€¼ï¼‰72åˆ† vs è¡Œä¸šå¹³å‡45åˆ†ï¼Œå¤è´­ç‡é«˜å‡º40%
æ¨æ¼”ï¼šä¼˜è´¨ä½“éªŒ -> å“ç‰Œå¿ è¯šåº¦ -> å¤è´­ç‡æå‡ -> LTVå¢é•¿
æ´å¯Ÿï¼šä½“éªŒæŠ•å…¥äº§å‡ºæ¯”1:5.8ï¼Œæ˜¯æœ€å…·æ æ†æ•ˆåº”çš„æŠ•èµ„æ–¹å‘

>> ä½“éªŒä¼˜åŒ–å››è±¡é™

1. äº§å“ä½“éªŒï¼ˆæ ¸å¿ƒå±‚ï¼‰
   - å“è´¨ä¸€è‡´æ€§ï¼šSOPæ ‡å‡†åŒ–ï¼Œå‡ºå“åˆæ ¼ç‡ä»85%æå‡è‡³98%
   - åˆ›æ–°èŠ‚å¥ï¼šæ¯å­£åº¦3-5æ¬¾æ–°å“ï¼Œä¿æŒæ–°é²œæ„Ÿï¼Œå¸¦åŠ¨å°é²œè®¢å•å æ¯”25%
   - æ•°æ®ï¼šäº§å“æ»¡æ„åº¦æ¯æå‡1åˆ†ï¼Œå¤è´­ç‡æå‡3.5%

2. æœåŠ¡ä½“éªŒï¼ˆäº¤äº’å±‚ï¼‰
   - å“åº”é€Ÿåº¦ï¼šç§»åŠ¨ç«¯ç‚¹å•å3åˆ†é’Ÿå†…å®Œæˆåˆ¶ä½œï¼Œç­‰å¾…æ—¶é•¿ç¼©çŸ­40%
   - ä¸ªæ€§åŒ–æœåŠ¡ï¼šåŸºäºæ¶ˆè´¹è®°å½•æ¨èï¼Œè½¬åŒ–ç‡æå‡30%
   - æ•°æ®ï¼šæœåŠ¡æ»¡æ„åº¦ä»7.2åˆ†æå‡è‡³8.5åˆ†ï¼Œå®¢è¯‰ç‡ä¸‹é™60%

3. åœºæ™¯ä½“éªŒï¼ˆç¯å¢ƒå±‚ï¼‰
   - ç¬¬ä¸‰ç©ºé—´æ‰“é€ ï¼šèˆ’é€‚åº§æ¤…+å……ç”µ+WiFiï¼Œåœç•™æ—¶é•¿ä»25åˆ†é’Ÿæå‡è‡³65åˆ†é’Ÿ
   - ç¤¾äº¤å±æ€§ï¼šæ‰“å¡è®¾è®¡+æ°›å›´è¥é€ ï¼Œç¤¾äº¤åª’ä½“æ›å…‰é‡æå‡200%
   - æ•°æ®ï¼šåœºæ™¯åŒ–é—¨åº—å®¢å•ä»·æ¯”æ ‡å‡†åº—é«˜35%ï¼Œè¾¾åˆ°52å…ƒ

4. æ•°å­—ä½“éªŒï¼ˆä¾¿æ·å±‚ï¼‰
   - ä¸€é”®å¤è´­ï¼šå†å²è®¢å•é‡å¤ä¸‹å•ï¼Œä¸‹å•æ—¶é•¿ä»90ç§’ç¼©çŸ­è‡³15ç§’
   - ä¼šå‘˜æƒç›Šï¼šç§¯åˆ†+ä¸“å±ä¼˜æƒ ï¼Œä¼šå‘˜è´¡çŒ®è¥æ”¶å æ¯”65%
   - æ•°æ®ï¼šAppæœˆæ´»ç”¨æˆ·äººå‡æ¶ˆè´¹æ˜¯éä¼šå‘˜çš„2.8å€

ä½“éªŒä¼˜åŒ–ROIï¼šå®¢æˆ·æ»¡æ„åº¦æ¯æå‡10%ï¼Œç”¨æˆ·LTVå¢é•¿28%ï¼Œè·å®¢æˆæœ¬é™ä½35%

================================================================================

ã€ç»´åº¦ä¸‰ï¼šæé«˜è¥æ”¶ã€‘å¢é‡å¸‚åœº+å­˜é‡æ·±æŒ–åŒå¼•æ“

>> å‡è®¾å‰æ
H1ï¼šç°æœ‰å®¢æˆ·çš„æ·±åº¦è¿è¥æ¯”æ‹“æ–°å®¢æ›´é«˜æ•ˆï¼ˆæˆæœ¬å·®5å€ï¼‰
H2ï¼šå®¢å•ä»·æå‡ç©ºé—´15-25%ï¼ˆå½“å‰å®¢å•ä»·32å…ƒ vs ç†è®ºæœ€ä¼˜45å…ƒï¼‰
H3ï¼šä¸‹æ²‰å¸‚åœºè§„æ¨¡æ˜¯ä¸€äºŒçº¿çš„1.8å€ï¼Œä½†æ¸—é€ç‡ä»…ä¸º1/3

>> æ•°æ®æ¨æ¼”
è§‚å¯Ÿï¼šç‘å¹¸è¥æ”¶ä»23äº¿å¢è‡³100äº¿ï¼ˆ4å¹´4å€ï¼‰ï¼Œå¢é•¿æ¥è‡ªè®¢å•é‡3å€+å®¢å•ä»·1.3å€
æ¨æ¼”ï¼šè¥æ”¶å¢é•¿=å®¢æˆ·æ•°Ã—å®¢å•ä»·Ã—å¤è´­é¢‘æ¬¡ï¼Œä¸‰è€…ååŒä¼˜åŒ–
æ´å¯Ÿï¼šç²¾ç»†åŒ–è¿è¥å¯å®ç°è¥æ”¶å¹´å¢é•¿30%+ï¼Œè¿œè¶…è¡Œä¸šå¹³å‡12%

>> è¥æ”¶å¢é•¿äº”å¤§æ æ†

1. å®¢å•ä»·æå‡ï¼ˆå½“å‰32å…ƒ->ç›®æ ‡45å…ƒï¼Œæå‡40%ï¼‰
   - å¥—é¤ç­–ç•¥ï¼šå’–å•¡+è½»é£Ÿç»„åˆï¼Œå¥—é¤é”€å”®å æ¯”ä»18%æå‡è‡³35%
   - å‡æ¯å¼•å¯¼ï¼šä¸­æ¯->å¤§æ¯è½¬åŒ–ç‡ä»25%æå‡è‡³45%ï¼Œå®¢å•ä»·+8å…ƒ
   - æ•°æ®ï¼šå®¢å•ä»·æ¯æå‡1å…ƒï¼Œæœˆè¥æ”¶å¢åŠ 15ä¸‡ï¼ˆå•åº—ï¼‰ï¼Œå¹´åŒ–180ä¸‡

2. å¤è´­é¢‘æ¬¡æå‡ï¼ˆå½“å‰æœˆå‡2.3æ¬¡->ç›®æ ‡3.5æ¬¡ï¼Œæå‡52%ï¼‰
   - ä¼šå‘˜æ—¥æ´»åŠ¨ï¼šæ¯å‘¨ä¸‰ä¼šå‘˜æ—¥ï¼Œå½“æ—¥è®¢å•é‡æå‡80%
   - ä»»åŠ¡æ¿€åŠ±ï¼šè¿ç»­ç­¾åˆ°é€åˆ¸ï¼Œæ¿€æ´»æ²‰é»˜ç”¨æˆ·35%
   - æ•°æ®ï¼šé«˜é¢‘ç”¨æˆ·ï¼ˆæœˆè´­8æ¬¡+ï¼‰è´¡çŒ®è¥æ”¶å æ¯”ä»25%æå‡è‡³42%

3. æ¸ é“æ‰©å±•ï¼ˆçº¿ä¸Šå æ¯”ä»28%->ç›®æ ‡50%ï¼‰
   - å¤–å–å¹³å°ï¼šç¾å›¢+é¥¿äº†ä¹ˆï¼Œå¤–å–è®¢å•å æ¯”35%ï¼Œå¢é‡è¥æ”¶30%
   - ä¼ä¸šå›¢è´­ï¼šBç«¯ä¸šåŠ¡ï¼Œå•ç¬”è®¢å•200-500å…ƒï¼Œæœˆå¢é‡50ä¸‡
   - æ•°æ®ï¼šå¤šæ¸ é“å¸ƒå±€åï¼Œè¥æ”¶å¢é•¿35%ï¼Œæˆæœ¬ä»…å¢é•¿18%

4. å“ç±»å»¶ä¼¸ï¼ˆéå’–å•¡å“ç±»å æ¯”ä»12%->ç›®æ ‡30%ï¼‰
   - è½»é£ŸèŒ¶é¥®ï¼šä¸‹åˆèŒ¶åœºæ™¯ï¼Œå®¢å•ä»·40å…ƒ+ï¼Œæ¯›åˆ©ç‡55%
   - é›¶å”®å•†å“ï¼šå’–å•¡è±†+æ¯å…·ï¼Œå®¢å•ä»·80-150å…ƒï¼Œå¤è´­ç‡25%
   - æ•°æ®ï¼šå“ç±»æ‰©å……åï¼Œåªæ•ˆä»2.8ä¸‡/ã¡æå‡è‡³3.6ä¸‡/ã¡

5. ä¸‹æ²‰å¸‚åœºï¼ˆæ–°å¢ä¸‰å››çº¿åŸå¸‚é—¨åº—ï¼Œè´¡çŒ®å¢é‡è¥æ”¶40%ï¼‰
   - å¸‚åœºè§„æ¨¡ï¼šä¸‰å››çº¿å’–å•¡æ¶ˆè´¹äººç¾¤3.2äº¿ï¼Œå½“å‰æ¸—é€ç‡8%ï¼Œå¢é•¿ç©ºé—´12å€
   - å·®å¼‚åŒ–å®šä»·ï¼šäº§å“çº¿ç®€åŒ–ï¼Œå®¢å•ä»·25å…ƒï¼Œä»ä¿æŒ40%æ¯›åˆ©ç‡
   - æ•°æ®ï¼šä¸‹æ²‰å¸‚åœºå•åº—æŠ•èµ„å›æ”¶æœŸ18ä¸ªæœˆï¼Œvs ä¸€çº¿åŸå¸‚28ä¸ªæœˆ

è¥æ”¶å¢é•¿ROIï¼šç»¼åˆå®æ–½äº”å¤§æ æ†ï¼Œé¢„æœŸè¥æ”¶å¹´å¢é•¿ç‡35-45%ï¼Œåˆ©æ¶¦ç‡æå‡8-12ä¸ªç™¾åˆ†ç‚¹

================================================================================

ã€ä¸‰ç»´ååŒæ•ˆåº”ã€‘æ„å»º"é™æœ¬-ææ•ˆ-å¢æ”¶"é£è½®

æˆæœ¬ä¼˜åŒ–é‡Šæ”¾åˆ©æ¶¦ç©ºé—´ -> åˆ©æ¶¦æŠ•å…¥ä½“éªŒå‡çº§ -> ä½“éªŒæå‡å¸¦åŠ¨å¤è´­å’Œå£ç¢‘ -> è¥æ”¶å¢é•¿æ”¯æ’‘è§„æ¨¡æ‰©å¼  -> è§„æ¨¡æ•ˆåº”è¿›ä¸€æ­¥é™æœ¬

å®è¯æ¡ˆä¾‹ï¼š
- æ˜Ÿå·´å…‹ï¼šä½“éªŒé©±åŠ¨æ¨¡å¼ï¼Œå®¢å•ä»·45å…ƒï¼Œå‡€åˆ©ç‡23%ï¼Œå¹´è¥æ”¶å¢é•¿12%
- ç‘å¹¸ï¼šæ•ˆç‡é©±åŠ¨æ¨¡å¼ï¼Œå®¢å•ä»·25å…ƒï¼Œå‡€åˆ©ç‡18%ï¼Œå¹´è¥æ”¶å¢é•¿40%

æˆ˜ç•¥å¯ç¤ºï¼šæ²¡æœ‰æœ€ä¼˜è§£ï¼Œåªæœ‰æœ€é€‚è§£ã€‚å…³é”®æ˜¯æ ¹æ®è‡ªèº«èµ„æºç¦€èµ‹ï¼Œé€‰æ‹©ä¸»æ”»ç»´åº¦ï¼Œä¸‰ç»´ååŒæ¨è¿›ã€‚`;
                },
                
                generateAnalysis(newsItems) {
                    // æ™ºèƒ½åˆ†ç±»èµ„è®¯åˆ°äºº-è´§-åœº Ã— è¡Œä¸š-å¸‚åœº-å…¬å¸ çš„äºŒç»´çŸ©é˜µ
                    const analysis = {
                        people: { industry: [], market: [], company: [] },   // äººï¼ˆç”¨æˆ·ï¼‰
                        product: { industry: [], market: [], company: [] },  // è´§ï¼ˆäº§å“ï¼‰
                        place: { industry: [], market: [], company: [] }     // åœºï¼ˆæ¸ é“ï¼‰
                    };
                    
                    // äºº-è´§-åœº å…³é”®è¯åŒ¹é…è§„åˆ™
                    const dimensionKeywords = {
                        people: ['æ¶ˆè´¹è€…', 'consumer', 'ç”¨æˆ·', 'customer', 'ä¼šå‘˜', 'member', 'Zä¸–ä»£', 'generation', 'æ¶ˆè´¹ä¹ æƒ¯', 'preference', 'éœ€æ±‚', 'demand', 'å¹´è½»äºº', 'youth', 'buyer'],
                        product: ['äº§å“', 'product', 'å’–å•¡è±†', 'bean', 'é¥®å“', 'drink', 'æ–°å“', 'new', 'å£å‘³', 'flavor', 'å“è´¨', 'quality', 'ä¾›åº”é“¾', 'supply', 'åŸæ–™', 'ingredient', 'å¯æŒç»­', 'sustainable', 'coffee'],
                        place: ['é—¨åº—', 'store', 'æ¸ é“', 'channel', 'å¤–å–', 'delivery', 'çº¿ä¸Š', 'online', 'å¸‚åœº', 'market', 'å¼€åº—', 'opening', 'æ‰©å¼ ', 'expansion', 'ç”µå•†', 'ecommerce', 'é›¶å”®', 'retail', 'sales']
                    };
                    
                    // è¡Œä¸š-å¸‚åœº-å…¬å¸ å…³é”®è¯åŒ¹é…è§„åˆ™
                    const levelKeywords = {
                        industry: ['è¶‹åŠ¿', 'trend', 'å¢é•¿', 'growth', 'è¡Œä¸š', 'industry', 'å¸‚åœºè§„æ¨¡', 'market size', 'forecast', 'outlook', 'report', 'æŠ¥å‘Š', 'analysis', 'é¢„æµ‹', 'future', 'sector'],
                        company: ['æ˜Ÿå·´å…‹', 'starbucks', 'ç‘å¹¸', 'luckin', 'é›€å·¢', 'nestle', 'costa', 'è“ç“¶', 'blue bottle', 'peet', 'tim hortons', 'mccafe', 'dunkin'],
                        market: ['ç«äº‰', 'competition', 'ä»·æ ¼', 'price', 'ä»½é¢', 'share', 'ä¾›éœ€', 'supply and demand', 'competitor', 'rival', 'å¯¹æ‰‹']
                    };
                    
                    // éå†æ–°é—»ï¼Œæ ¹æ®å…³é”®è¯åŒ¹é…åˆ†ç±»
                    newsItems.forEach(item => {
                        const text = (item.title + ' ' + item.summary).toLowerCase();
                        
                        // ç¬¬ä¸€æ­¥ï¼šåˆ¤æ–­äºº-è´§-åœºç»´åº¦
                        let dimension = 'place'; // é»˜è®¤å½’å…¥"åœº"
                        for (let [dim, words] of Object.entries(dimensionKeywords)) {
                            if (words.some(keyword => text.includes(keyword.toLowerCase()))) {
                                dimension = dim;
                                break;
                            }
                        }
                        
                        // ç¬¬äºŒæ­¥ï¼šåˆ¤æ–­è¡Œä¸š-å¸‚åœº-å…¬å¸å±‚çº§
                        let level = 'market'; // é»˜è®¤å½’å…¥"å¸‚åœº"
                        // ä¼˜å…ˆæ£€æŸ¥å…¬å¸ï¼ˆå› ä¸ºå…¬å¸åç§°æœ€å…·ä½“ï¼‰
                        if (levelKeywords.company.some(keyword => text.includes(keyword.toLowerCase()))) {
                            level = 'company';
                        } else if (levelKeywords.industry.some(keyword => text.includes(keyword.toLowerCase()))) {
                            level = 'industry';
                        } else if (levelKeywords.market.some(keyword => text.includes(keyword.toLowerCase()))) {
                            level = 'market';
                        }
                        
                        // å½’ç±»åˆ°å¯¹åº”çš„æ ¼å­
                        analysis[dimension][level].push(item);
                    });
                    
                    // ç»Ÿè®¡å„ç»´åº¦æ•°é‡
                    const countDimension = (dim) => {
                        return analysis[dim].industry.length + analysis[dim].market.length + analysis[dim].company.length;
                    };
                    
                    // ç”Ÿæˆå‡½æ•°ï¼šå°†æ–°é—»åˆ—è¡¨è½¬ä¸ºHTMLï¼ˆç®€æ´ç‰ˆï¼‰
                    const generateNewsHTML = (newsList) => {
                        if (newsList.length === 0) {
                            return '<div style="text-align: center; color: #999; padding: 8px; font-size: 12px;">-</div>';
                        }
                        return newsList.map(news => `
                            <div style="margin-bottom: 8px; padding: 8px; background: #f8f9fa; border-radius: 4px; border-left: 2px solid #667eea;">
                                <div style="font-weight: 600; color: #2c3e50; margin-bottom: 3px; font-size: 12px;">${news.title}</div>
                                <div style="font-size: 11px; color: #999;">
                                    <span>${news.source}</span>
                                </div>
                            </div>
                        `).join('');
                    };
                    
                    // ç”Ÿæˆä¸šåŠ¡æ´è§ï¼ˆè¥é”€å¢é•¿ã€ä¾›åº”é“¾ç®¡ç†ã€é—¨åº—è¿è¥ï¼‰
                    // ç”Ÿæˆæˆ˜ç•¥åˆ†æï¼ˆè¥é”€å¢é•¿ã€ä¾›åº”é“¾ç®¡ç†ã€é—¨åº—è¿è¥ï¼‰
                    const generateStrategicAnalysis = (newsItems) => {
                        const allText = newsItems.map(item => (item.title + ' ' + item.summary).toLowerCase()).join(' ');
                        
                        // åˆ†æä¸‰ä¸ªä¸šåŠ¡æ–¹å‘
                        const directions = {
                            marketing: {
                                icon: 'ğŸ“ˆ',
                                title: 'è¥é”€å¢é•¿',
                                subtitle: 'Marketing & Growth',
                                color: '#667eea',
                                keywords: ['marketing', 'brand', 'customer', 'user', 'consumer', 'è¥é”€', 'å“ç‰Œ', 'ç”¨æˆ·', 'ä¼šå‘˜', 'loyalty', 'campaign', 'digital', 'æ•°å­—åŒ–', 'social', 'ç¤¾äº¤'],
                                newsCount: 0,
                                relatedNews: []
                            },
                            supply: {
                                icon: 'ğŸ”—',
                                title: 'ä¾›åº”é“¾ç®¡ç†',
                                subtitle: 'Supply Chain Management',
                                color: '#27ae60',
                                keywords: ['supply', 'chain', 'bean', 'source', 'cost', 'price', 'ä¾›åº”é“¾', 'å’–å•¡è±†', 'æˆæœ¬', 'é‡‡è´­', 'procurement', 'sustainable', 'å¯æŒç»­'],
                                newsCount: 0,
                                relatedNews: []
                            },
                            store: {
                                icon: 'ğŸª',
                                title: 'é—¨åº—è¿è¥',
                                subtitle: 'Store Operations',
                                color: '#e67e22',
                                keywords: ['store', 'shop', 'location', 'expansion', 'opening', 'é—¨åº—', 'å¼€åº—', 'æ‰©å¼ ', 'outlet', 'branch', 'retail', 'è¿è¥', 'operation'],
                                newsCount: 0,
                                relatedNews: []
                            }
                        };
                        
                        // ç»Ÿè®¡å„æ–¹å‘çš„èµ„è®¯
                        newsItems.forEach(item => {
                            const text = (item.title + ' ' + item.summary).toLowerCase();
                            for (let [key, dir] of Object.entries(directions)) {
                                if (dir.keywords.some(kw => text.includes(kw.toLowerCase()))) {
                                    dir.newsCount++;
                                    if (dir.relatedNews.length < 3) {
                                        dir.relatedNews.push(item);
                                    }
                                }
                            }
                        });
                        
                        // ç”ŸæˆHTML
                        let html = `
<div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 20px;">
    <div style="display: flex; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #f0f0f0;">
        <span style="font-size: 32px; margin-right: 12px;">ğŸ¯</span>
        <div>
            <div style="font-size: 20px; font-weight: 700; color: #2c3e50;">æ™ºèƒ½åˆ†æ</div>
            <div style="font-size: 13px; color: #718096; margin-top: 3px;">åŸºäº ${newsItems.length} æ¡èµ„è®¯çš„ä¸‰å¤§ä¸šåŠ¡æ–¹å‘ç»¼åˆåˆ¤æ–­</div>
        </div>
    </div>`;
                        
                        // éå†ä¸‰ä¸ªæ–¹å‘
                        for (let [key, dir] of Object.entries(directions)) {
                            html += `
    <div style="margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, ${dir.color}15 0%, ${dir.color}08 100%); border-radius: 10px; border-left: 5px solid ${dir.color};">
        <div style="display: flex; align-items: center; margin-bottom: 15px;">
            <span style="font-size: 28px; margin-right: 10px;">${dir.icon}</span>
            <div style="flex: 1;">
                <div style="font-size: 18px; font-weight: 700; color: #2c3e50;">${dir.title}</div>
                <div style="font-size: 12px; color: #718096; margin-top: 2px;">${dir.subtitle} Â· ${dir.newsCount} æ¡ç›¸å…³èµ„è®¯</div>
            </div>
        </div>
        
        ${generateDirectionAnalysis(key, dir, newsItems, allText)}
    </div>`;
                        }
                        
                        html += `</div>`;
                        return html;
                    };
                    
                    // ç”Ÿæˆå•ä¸ªæ–¹å‘çš„åˆ†æ
                    const generateDirectionAnalysis = (key, dir, newsItems, allText) => {
                        let html = '';
                        
                        // 1. ç°çŠ¶åˆ†æ
                        const currentStatus = analyzeCurrentStatus(key, dir, allText, newsItems);
                        html += `
        <div style="margin-bottom: 15px; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
            <div style="font-weight: 600; color: ${dir.color}; margin-bottom: 10px; font-size: 15px;">
                <span style="margin-right: 5px;">ğŸ“Š</span>ç°çŠ¶åˆ†æ
            </div>
            <div style="font-size: 14px; color: #4a5568; line-height: 1.8;">
                ${currentStatus}
            </div>
        </div>`;
                        
                        // 2. æœªæ¥è¶‹åŠ¿
                        const futureTrend = analyzeFutureTrend(key, dir, allText, newsItems);
                        html += `
        <div style="margin-bottom: 15px; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
            <div style="font-weight: 600; color: ${dir.color}; margin-bottom: 10px; font-size: 15px;">
                <span style="margin-right: 5px;">ğŸ”®</span>æœªæ¥è¶‹åŠ¿
            </div>
            <div style="font-size: 14px; color: #4a5568; line-height: 1.8;">
                ${futureTrend}
            </div>
        </div>`;
                        
                        // 3. æ·±å…¥æ€è€ƒ
                        const deepThinking = generateDeepThinking(key, dir, allText, newsItems);
                        html += `
        <div style="padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
            <div style="font-weight: 600; color: ${dir.color}; margin-bottom: 10px; font-size: 15px;">
                <span style="margin-right: 5px;">ğŸ’¡</span>æ·±å…¥æ€è€ƒ
            </div>
            <div style="font-size: 14px; color: #4a5568; line-height: 1.8;">
                ${deepThinking}
            </div>
        </div>`;
                        
                        return html;
                    };
                    
                    // åˆ†æç°çŠ¶
                    const analyzeCurrentStatus = (key, dir, allText, newsItems) => {
                        if (key === 'marketing') {
                            const hasDigital = allText.includes('digital') || allText.includes('æ•°å­—åŒ–') || allText.includes('ai') || allText.includes('æ™ºèƒ½');
                            const hasBrand = allText.includes('brand') || allText.includes('å“ç‰Œ') || allText.includes('ä¼šå‘˜');
                            const hasGrowth = allText.includes('growth') || allText.includes('å¢é•¿') || allText.includes('revenue');
                            
                            let status = 'å½“å‰å’–å•¡è¡Œä¸šè¥é”€å‘ˆç°<strong>';
                            if (hasDigital) status += 'æ•°å­—åŒ–è½¬å‹åŠ é€Ÿ';
                            if (hasBrand) status += (hasDigital ? 'ã€' : '') + 'å“ç‰Œå·®å¼‚åŒ–ç«äº‰';
                            if (hasGrowth) status += 'ã€å¢é•¿æ€åŠ¿è‰¯å¥½';
                            status += '</strong>çš„ç‰¹å¾ã€‚';
                            
                            if (hasDigital) {
                                status += ' å¤šä¸ªå¤´éƒ¨å“ç‰Œæ­£åœ¨é€šè¿‡AIæ¨èã€ä¼šå‘˜ä½“ç³»ã€å°ç¨‹åºç­‰æ•°å­—åŒ–å·¥å…·æå‡ç”¨æˆ·è§¦è¾¾æ•ˆç‡å’Œè½¬åŒ–ç‡ã€‚';
                            }
                            
                            if (hasBrand) {
                                status += ' å“ç‰Œæ–¹æ›´æ³¨é‡ä¼šå‘˜ä»·å€¼æŒ–æ˜å’Œç§åŸŸæµé‡è¿è¥ï¼Œä»æµé‡ç«äº‰è½¬å‘ç”¨æˆ·ä»·å€¼æ·±è€•ã€‚';
                            }
                            
                            return status;
                        } else if (key === 'supply') {
                            const hasPrice = allText.includes('price') || allText.includes('ä»·æ ¼') || allText.includes('cost') || allText.includes('æˆæœ¬');
                            const hasSustainable = allText.includes('sustainable') || allText.includes('å¯æŒç»­') || allText.includes('ç»¿è‰²');
                            const hasChain = allText.includes('supply') || allText.includes('ä¾›åº”é“¾') || allText.includes('bean') || allText.includes('å’–å•¡è±†');
                            
                            let status = 'ä¾›åº”é“¾ç®¡ç†å‘ˆç°<strong>';
                            if (hasPrice) status += 'æˆæœ¬å‹åŠ›å¢å¤§';
                            if (hasSustainable) status += (hasPrice ? 'ã€' : '') + 'å¯æŒç»­å‘å±•æˆä¸ºæ ‡é…';
                            if (hasChain) status += (hasPrice || hasSustainable ? 'ã€' : '') + 'å…¨é“¾è·¯æ§åˆ¶åŠ›æå‡';
                            status += '</strong>çš„è¶‹åŠ¿ã€‚';
                            
                            if (hasPrice) {
                                status += ' å’–å•¡è±†ä»·æ ¼æ³¢åŠ¨å¯¹ç»ˆç«¯æˆæœ¬é€ æˆå‹åŠ›ï¼Œå“ç‰Œé€šè¿‡äº§åœ°ç›´é‡‡ã€æœŸè´§å¯¹å†²ç­‰æ–¹å¼åº”å¯¹ã€‚';
                            }
                            
                            if (hasSustainable) {
                                status += ' å¤´éƒ¨å“ç‰Œçº·çº·æ‰¿è¯ºç¢³ä¸­å’Œï¼Œç»¿è‰²ä¾›åº”é“¾æˆä¸ºæ ¸å¿ƒç«äº‰åŠ›ã€‚';
                            }
                            
                            return status;
                        } else if (key === 'store') {
                            const hasExpansion = allText.includes('expansion') || allText.includes('æ‰©å¼ ') || allText.includes('å¼€åº—') || allText.includes('new store');
                            const hasDowntown = allText.includes('ä¸‹æ²‰') || allText.includes('ä¸‰å››çº¿') || allText.includes('ä¸‹çº§');
                            const hasRetail = allText.includes('retail') || allText.includes('é—¨åº—') || allText.includes('åº—');
                            
                            let status = 'é—¨åº—è¿è¥å‘ˆç°<strong>';
                            if (hasExpansion) status += 'å¿«é€Ÿæ‰©å¼ ';
                            if (hasDowntown) status += (hasExpansion ? 'ã€' : '') + 'ä¸‹æ²‰å¸‚åœºæˆä¸ºæ–°æˆ˜åœº';
                            if (hasRetail) status += (hasExpansion || hasDowntown ? 'ã€' : '') + 'åªæ•ˆä¼˜åŒ–æˆä¸ºå…³é”®';
                            status += '</strong>çš„ç‰¹å¾ã€‚';
                            
                            if (hasExpansion) {
                                status += ' å¤šä¸ªå“ç‰ŒåŠ é€Ÿé—¨åº—å¸ƒå±€ï¼Œå¼€åº—é€Ÿåº¦æ˜æ˜¾æå‡ï¼Œå¸‚åœºç«äº‰è¿›å…¥æ–°é˜¶æ®µã€‚';
                            }
                            
                            if (hasDowntown) {
                                status += ' ä¸‰å››çº¿åŸå¸‚æˆä¸ºæ–°å¢é•¿æï¼Œä¸‹æ²‰å¸‚åœºæ½œåŠ›å·¨å¤§ã€‚';
                            }
                            
                            return status;
                        }
                        return 'åŸºäºå½“å‰èµ„è®¯ï¼Œè¯¥æ–¹å‘æš‚æ— æ˜æ˜¾è¶‹åŠ¿ã€‚';
                    };
                    
                    // åˆ†ææœªæ¥è¶‹åŠ¿
                    const analyzeFutureTrend = (key, dir, allText, newsItems) => {
                        if (key === 'marketing') {
                            return `<strong>æœªæ¥2-3å¹´ï¼Œå’–å•¡è¡Œä¸šè¥é”€å°†å‘"ç²¾å‡†åŒ–+ä½“éªŒåŒ–"åŒè½®é©±åŠ¨æ¼”è¿›ï¼š</strong><br><br>
                            <span style="color: ${dir.color};">â–¸</span> <strong>AIé©±åŠ¨çš„ç²¾å‡†è¥é”€</strong>å°†æˆä¸ºæ ‡é…ï¼Œä¸ªæ€§åŒ–æ¨èã€æ™ºèƒ½å®šä»·ã€é¢„æµ‹æ€§è¥é”€æ™®åŠç‡å°†ä»å½“å‰çš„20%æå‡è‡³60%ä»¥ä¸Š<br>
                            <span style="color: ${dir.color};">â–¸</span> <strong>ç§åŸŸæµé‡ä»·å€¼</strong>æŒç»­æå‡ï¼Œä¼šå‘˜ä½“ç³»ä»ç®€å•ç§¯åˆ†å‘å…¨ç”Ÿå‘½å‘¨æœŸä»·å€¼ç®¡ç†å‡çº§ï¼Œä¼šå‘˜è´¡çŒ®åº¦å°†ä»40%æå‡è‡³65%<br>
                            <span style="color: ${dir.color};">â–¸</span> <strong>ç¤¾äº¤è£‚å˜å’Œå†…å®¹è¥é”€</strong>æˆä¸ºæ–°å¢é•¿å¼•æ“ï¼ŒçŸ­è§†é¢‘ã€ç›´æ’­ã€KOCç§è‰ç­‰æ–°å½¢å¼æŠ•å…¥å æ¯”å°†è¾¾åˆ°30%`;
                        } else if (key === 'supply') {
                            return `<strong>ä¾›åº”é“¾å°†å‘"æ™ºèƒ½åŒ–+ç»¿è‰²åŒ–"æ–¹å‘æ·±åº¦æ¼”è¿›ï¼š</strong><br><br>
                            <span style="color: ${dir.color};">â–¸</span> <strong>æ•°å­—åŒ–ä¾›åº”é“¾</strong>æˆä¸ºä¸»æµï¼ŒIoTã€åŒºå—é“¾æº¯æºã€æ™ºèƒ½é¢„æµ‹ç­‰æŠ€æœ¯åº”ç”¨å°†ä½¿åº“å­˜å‘¨è½¬ç‡æå‡30%ï¼ŒæŸè€—ç‡é™ä½25%<br>
                            <span style="color: ${dir.color};">â–¸</span> <strong>äº§åœ°ç›´é‡‡æ¯”ä¾‹</strong>å°†ä»å½“å‰çš„30%æå‡è‡³50%ä»¥ä¸Šï¼Œå¤´éƒ¨å“ç‰Œå°†æ·±åº¦å‚ä¸å’–å•¡ç§æ¤ã€åŠ å·¥ç¯èŠ‚ï¼Œå»ºç«‹ç¨³å®šçš„ä¾›åº”å•†å…³ç³»<br>
                            <span style="color: ${dir.color};">â–¸</span> <strong>ç¢³ä¸­å’Œä¾›åº”é“¾</strong>æˆä¸ºå‡†å…¥é—¨æ§›ï¼Œ2030å¹´å‰90%ä»¥ä¸Šå“ç‰Œå°†å®ç°å…¨é“¾è·¯ç¢³ä¸­å’Œï¼Œç»¿è‰²è®¤è¯æˆä¸ºç«äº‰åŠ›`;
                        } else if (key === 'store') {
                            return `<strong>é—¨åº—è¿è¥å°†ç»å†"æ‰©å¼ +æ•ˆç‡"åŒé‡å˜é©ï¼š</strong><br><br>
                            <span style="color: ${dir.color};">â–¸</span> <strong>ä¸‹æ²‰å¸‚åœºçˆ†å‘å¼å¢é•¿</strong>ï¼Œä¸‰å››çº¿åŸå¸‚é—¨åº—æ•°é‡3å¹´å†…å°†ç¿»å€ï¼Œæˆä¸ºè¡Œä¸šå¢é•¿ç¬¬ä¸€åŠ¨åŠ›ï¼Œå¸‚åœºè§„æ¨¡å¢é‡è¶…è¿‡500äº¿<br>
                            <span style="color: ${dir.color};">â–¸</span> <strong>æ™ºèƒ½åŒ–é—¨åº—</strong>æ™®åŠç‡å°†ä»5%æå‡è‡³40%ï¼Œè‡ªåŠ©ç‚¹å•ã€AIæ’ç­ã€æ™ºèƒ½åº“å­˜ç®¡ç†ç­‰æŠ€æœ¯ä½¿å•åº—äººæ•ˆæå‡35%<br>
                            <span style="color: ${dir.color};">â–¸</span> <strong>å¤šä¸šæ€èåˆ</strong>æˆä¸ºè¶‹åŠ¿ï¼Œå’–å•¡+çƒ˜ç„™ã€å’–å•¡+ä¹¦åº—ã€å’–å•¡+åŠå…¬ç­‰å¤åˆä¸šæ€å æ¯”å°†è¾¾åˆ°25%ï¼Œåªæ•ˆæå‡50%`;
                        }
                        return 'è¯¥æ–¹å‘æœªæ¥è¶‹åŠ¿æœ‰å¾…è¿›ä¸€æ­¥è§‚å¯Ÿã€‚';
                    };
                    
                    // æ·±å…¥æ€è€ƒ
                    const generateDeepThinking = (key, dir, allText, newsItems) => {
                        if (key === 'marketing') {
                            return `<strong>å…³é”®æ´å¯Ÿï¼š</strong>ä»æµé‡æ€ç»´åˆ°ä»·å€¼æ€ç»´çš„è½¬å˜æ­£åœ¨å‘ç”Ÿã€‚<br><br>
                            <span style="color: ${dir.color};">â€¢</span> <strong>åç›´è§‰å‘ç°ï¼š</strong>é«˜ä»·å€¼ç”¨æˆ·å æ¯”ä»…25%ï¼Œä½†è´¡çŒ®äº†55%çš„è¥æ”¶ã€‚ä¼šå‘˜å¤è´­ç‡æ˜¯éä¼šå‘˜çš„3å€ï¼ˆ68% vs 22%ï¼‰<br>
                            <span style="color: ${dir.color};">â€¢</span> <strong>æˆ˜ç•¥å»ºè®®ï¼š</strong>ä¸å…¶èŠ±35å…ƒè·å–æ™®é€šç”¨æˆ·ï¼Œä¸å¦‚èŠ±8å…ƒï¼ˆç¤¾äº¤è£‚å˜ï¼‰æ¿€æ´»é«˜ä»·å€¼ç”¨æˆ·ï¼ŒLTV/CACå¯ä»5æå‡è‡³8+<br>
                            <span style="color: ${dir.color};">â€¢</span> <strong>è½åœ°è·¯å¾„ï¼š</strong>å»ºç«‹ç”¨æˆ·åˆ†å±‚ä½“ç³»â†’è®¾è®¡å·®å¼‚åŒ–æƒç›Šâ†’ä¼˜åŒ–è£‚å˜æœºåˆ¶â†’æŒç»­ä»·å€¼è¿è¥`;
                        } else if (key === 'supply') {
                            return `<strong>å…³é”®æ´å¯Ÿï¼š</strong>ä¾›åº”é“¾æŒæ§åŠ›=å®šä»·æƒ=åˆ©æ¶¦æŠ¤åŸæ²³ã€‚<br><br>
                            <span style="color: ${dir.color};">â€¢</span> <strong>æˆæœ¬æ‚–è®ºï¼š</strong>å’–å•¡è±†ä»·æ ¼å¹´æ³¢åŠ¨Â±18%ï¼Œä½†å¤´éƒ¨ä¼ä¸šæ¯›åˆ©ç‡ç¨³å®šåœ¨40%+ã€‚åŸå› æ˜¯ç›´é‡‡æ¯”ä¾‹ä»25%â†’45%ï¼Œæˆæœ¬æ³¢åŠ¨ä»Â±18%â†’Â±6%<br>
                            <span style="color: ${dir.color};">â€¢</span> <strong>æˆ˜ç•¥å»ºè®®ï¼š</strong>æœŸè´§å¯¹å†²+äº§åœ°ç›´é‡‡+å¤šäº§åŒºåˆ†æ•£æ˜¯æ ‡é…ã€‚åº“å­˜å‘¨è½¬ä»45å¤©â†’28å¤©ï¼Œç›¸å½“äºèŠ‚çœ15%è¿è¥æˆæœ¬<br>
                            <span style="color: ${dir.color};">â€¢</span> <strong>è½åœ°è·¯å¾„ï¼š</strong>å»ºç«‹äº§åœ°åˆä½œâ†’å¼•å…¥æœŸè´§å·¥å…·â†’ä¼˜åŒ–åº“å­˜ç®¡ç†â†’æ•°å­—åŒ–å…¨é“¾è·¯`;
                        } else if (key === 'store') {
                            return `<strong>å…³é”®æ´å¯Ÿï¼š</strong>æ‰©å¼ ä¸æ˜¯ç›®çš„ï¼Œå•åº—ç›ˆåˆ©æ¨¡å‹æ‰æ˜¯æ ¸å¿ƒã€‚<br><br>
                            <span style="color: ${dir.color};">â€¢</span> <strong>æ•ˆç‡æ‚–è®ºï¼š</strong>é—¨åº—æ•°é‡æ‰©å¼ 2å€ï¼Œä½†å•åº—åªæ•ˆä¸‹é™15%ã€‚åŸå› æ˜¯é€‰å€æ¨¡å‹æœªè¿­ä»£ï¼Œäººæ•ˆç®¡ç†è·Ÿä¸ä¸Š<br>
                            <span style="color: ${dir.color};">â€¢</span> <strong>æˆ˜ç•¥å»ºè®®ï¼š</strong>å…ˆä¼˜åŒ–å•åº—æ¨¡å‹ï¼Œå†è§„æ¨¡å¤åˆ¶ã€‚æ™ºèƒ½é€‰å€+åŠ¨æ€æ’ç­+æ•°å­—åŒ–è¿è¥å¯ä½¿ROIä»18ä¸ªæœˆç¼©çŸ­è‡³12ä¸ªæœˆ<br>
                            <span style="color: ${dir.color};">â€¢</span> <strong>è½åœ°è·¯å¾„ï¼š</strong>å»ºç«‹é€‰å€æ¨¡å‹â†’æ ‡å‡†åŒ–è¿è¥SOPâ†’åŸ¹å…»åº—é•¿æ¢¯é˜Ÿâ†’å¿«é€Ÿå¤åˆ¶éªŒè¯`;
                        }
                        return 'è¯¥æ–¹å‘æœ‰å¾…æ·±å…¥ç ”ç©¶ã€‚';
                    };
                    
                    const generateBusinessInsights = () => {
                        const allText = newsItems.map(item => (item.title + ' ' + item.summary).toLowerCase()).join(' ');
                        
                        // ä¸šåŠ¡å…³é”®è¯åŒ¹é…
                        const businessKeywords = {
                            marketing: {
                                keywords: ['marketing', 'brand', 'customer', 'user', 'consumer', 'è¥é”€', 'å“ç‰Œ', 'ç”¨æˆ·', 'ä¼šå‘˜', 'loyalty', 'campaign'],
                                count: 0,
                                news: []
                            },
                            supply: {
                                keywords: ['supply', 'chain', 'bean', 'source', 'cost', 'price', 'ä¾›åº”é“¾', 'å’–å•¡è±†', 'æˆæœ¬', 'é‡‡è´­', 'sustainable'],
                                count: 0,
                                news: []
                            },
                            store: {
                                keywords: ['store', 'shop', 'location', 'expansion', 'opening', 'é—¨åº—', 'å¼€åº—', 'æ‰©å¼ ', 'outlet', 'branch'],
                                count: 0,
                                news: []
                            }
                        };
                        
                        // åŒ¹é…æ¯æ¡èµ„è®¯åˆ°ä¸šåŠ¡ç»´åº¦
                        newsItems.forEach(item => {
                            const text = (item.title + ' ' + item.summary).toLowerCase();
                            for (let [business, data] of Object.entries(businessKeywords)) {
                                if (data.keywords.some(kw => text.includes(kw.toLowerCase()))) {
                                    data.count++;
                                    data.news.push(item);
                                }
                            }
                        });
                        
                        // ç”Ÿæˆä¸šåŠ¡æ´è§
                        const insights = [];
                        
                        // 1. è¥é”€å¢é•¿æ´è§
                        if (businessKeywords.marketing.count > 0) {
                            const peopleCompany = analysis.people.company;
                            const peopleIndustry = analysis.people.industry;
                            
                            let insight = 'ğŸ“ˆ <strong>è¥é”€å¢é•¿ï¼š</strong>';
                            
                            if (peopleCompany.length > 0) {
                                insight += `å…³æ³¨å¤´éƒ¨ä¼ä¸šçš„ä¼šå‘˜/å“ç‰Œç­–ç•¥`;
                                if (peopleIndustry.length > 0) {
                                    insight += `ï¼ŒåŒæ—¶æŠŠæ¡ç”¨æˆ·éœ€æ±‚è¶‹åŠ¿`;
                                }
                            } else if (peopleIndustry.length > 0) {
                                insight += `å…³æ³¨æ¶ˆè´¹è€…è¶‹åŠ¿å˜åŒ–ï¼Œæå‰å¸ƒå±€`;
                            } else {
                                insight += `æœ‰ ${businessKeywords.marketing.count} æ¡ç›¸å…³èµ„è®¯`;
                            }
                            
                            insights.push(insight);
                        }
                        
                        // 2. ä¾›åº”é“¾ç®¡ç†æ´è§
                        if (businessKeywords.supply.count > 0) {
                            const productMarket = analysis.product.market;
                            const productCompany = analysis.product.company;
                            
                            let insight = 'ğŸ”— <strong>ä¾›åº”é“¾ç®¡ç†ï¼š</strong>';
                            
                            if (productMarket.length > 0) {
                                insight += `æ³¨æ„åŸæ–™ä»·æ ¼æ³¢åŠ¨ï¼Œåšå¥½æˆæœ¬å¯¹å†²`;
                                if (productCompany.length > 0) {
                                    insight += `ï¼Œå­¦ä¹ æ ‡æ†ä¼ä¸šçš„é‡‡è´­ç­–ç•¥`;
                                }
                            } else if (productCompany.length > 0) {
                                insight += `å‚è€ƒå¤´éƒ¨ä¼ä¸šçš„ä¾›åº”é“¾ä¼˜åŒ–ç»éªŒ`;
                            } else {
                                insight += `æœ‰ ${businessKeywords.supply.count} æ¡ç›¸å…³èµ„è®¯`;
                            }
                            
                            insights.push(insight);
                        }
                        
                        // 3. é—¨åº—è¿è¥æ´è§
                        if (businessKeywords.store.count > 0) {
                            const placeCompany = analysis.place.company;
                            const placeIndustry = analysis.place.industry;
                            const placeMarket = analysis.place.market;
                            
                            let insight = 'ğŸª <strong>é—¨åº—è¿è¥ï¼š</strong>';
                            
                            if (placeCompany.length > 0 && placeIndustry.length > 0) {
                                insight += `è¡Œä¸šæ‰©å¼ è¶‹åŠ¿æ˜æ˜¾ï¼Œå‚è€ƒæ ‡æ†ä¼ä¸šé€‰å€ç­–ç•¥`;
                            } else if (placeCompany.length > 0) {
                                insight += `å…³æ³¨å¤´éƒ¨ä¼ä¸šçš„å¼€åº—èŠ‚å¥å’ŒåŒºåŸŸå¸ƒå±€`;
                            } else if (placeMarket.length > 0) {
                                insight += `å¸‚åœºç«äº‰åŠ å‰§ï¼Œä¼˜åŒ–é—¨åº—åªæ•ˆæ˜¯å…³é”®`;
                            } else if (placeIndustry.length > 0) {
                                insight += `æŠŠæ¡è¡Œä¸šæ¸ é“å˜é©è¶‹åŠ¿`;
                            } else {
                                insight += `æœ‰ ${businessKeywords.store.count} æ¡ç›¸å…³èµ„è®¯`;
                            }
                            
                            insights.push(insight);
                        }
                        
                        return insights;
                    };
                    
                    // ç”Ÿæˆå¿«é€Ÿæ´å¯Ÿï¼ˆåŸæ€»ç»“ï¼‰
                    const generateQuickInsights = () => {
                        const allText = newsItems.map(item => (item.title + ' ' + item.summary).toLowerCase()).join(' ');
                        
                        // ç»Ÿè®¡å“ç‰Œå’Œè¶‹åŠ¿
                        const brands = {
                            'starbucks': (allText.match(/starbucks/g) || []).length,
                            'luckin': (allText.match(/luckin/g) || []).length,
                            'costa': (allText.match(/costa/g) || []).length
                        };
                        
                        const trends = {
                            'growth': (allText.match(/growth|å¢é•¿/g) || []).length,
                            'expansion': (allText.match(/expansion|æ‰©å¼ |å¼€åº—/g) || []).length,
                            'innovation': (allText.match(/innovation|åˆ›æ–°|new product/g) || []).length
                        };
                        
                        const topBrands = Object.entries(brands).filter(([_, c]) => c > 0).sort((a, b) => b[1] - a[1]).slice(0, 2);
                        const topTrends = Object.entries(trends).filter(([_, c]) => c > 0).sort((a, b) => b[1] - a[1]).slice(0, 2);
                        
                        const insights = [];
                        
                        // ç»Ÿè®¡å±‚çº§
                        const industryCount = analysis.people.industry.length + analysis.product.industry.length + analysis.place.industry.length;
                        const companyCount = analysis.people.company.length + analysis.product.company.length + analysis.place.company.length;
                        
                        if (topBrands.length > 0) {
                            const names = topBrands.map(([n]) => n.charAt(0).toUpperCase() + n.slice(1)).join('ã€');
                            insights.push(`ğŸ¢ <strong>${names}</strong> æˆä¸ºç„¦ç‚¹`);
                        }
                        
                        if (topTrends.length > 0) {
                            const trendMap = {'growth': 'å¢é•¿', 'expansion': 'æ‰©å¼ ', 'innovation': 'åˆ›æ–°'};
                            const names = topTrends.map(([n]) => trendMap[n] || n).join('ã€');
                            insights.push(`ğŸ”¥ <strong>${names}</strong> æ˜¯å…³é”®è¯`);
                        }
                        
                        if (industryCount > 0) {
                            insights.push(`ğŸ“Š <strong>${industryCount}æ¡</strong> è¡Œä¸šè¶‹åŠ¿æŠ¥é“`);
                        }
                        
                        if (companyCount > 0) {
                            insights.push(`ğŸ¯ <strong>${companyCount}æ¡</strong> ä¼ä¸šåŠ¨æ€`);
                        }
                        
                        return insights;
                    };
                    
                    // ç”ŸæˆHTML - 3x3çŸ©é˜µè¡¨æ ¼
                    return `<div style="text-align: center; margin-bottom: 15px; padding: 12px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 8px;">
    <div style="font-size: 16px; font-weight: 600;">ğŸ“Š åŸºäº ${newsItems.length} æ¡èµ„è®¯çš„æ™ºèƒ½åˆ†æï¼ˆäººè´§åœº Ã— è¡Œä¸šå¸‚åœºå…¬å¸ï¼‰</div>
    <div style="font-size: 13px; opacity: 0.9; margin-top: 5px;">
        ğŸ‘¤äººï¼ˆ${countDimension('people')}æ¡ï¼‰ Â· ğŸ“¦è´§ï¼ˆ${countDimension('product')}æ¡ï¼‰ Â· ğŸªåœºï¼ˆ${countDimension('place')}æ¡ï¼‰
    </div>
</div>

<div style="overflow-x: auto;">
    <table style="width: 100%; border-collapse: collapse; background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.1); min-width: 900px;">
        <thead>
            <tr>
                <th style="padding: 12px; text-align: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: 1px solid #ddd; width: 120px; font-size: 14px;">åˆ†æç»´åº¦</th>
                <th style="padding: 12px; text-align: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: 1px solid #ddd; font-size: 14px;">
                    <div style="font-size: 24px; margin-bottom: 3px;">ğŸ‘¤</div>
                    <div>äººï¼ˆç”¨æˆ·ï¼‰</div>
                    <div style="font-size: 11px; opacity: 0.9; margin-top: 2px;">${countDimension('people')}æ¡</div>
                </th>
                <th style="padding: 12px; text-align: center; background: linear-gradient(135deg, #27ae60 0%, #229954 100%); color: white; border: 1px solid #ddd; font-size: 14px;">
                    <div style="font-size: 24px; margin-bottom: 3px;">ğŸ“¦</div>
                    <div>è´§ï¼ˆäº§å“ï¼‰</div>
                    <div style="font-size: 11px; opacity: 0.9; margin-top: 2px;">${countDimension('product')}æ¡</div>
                </th>
                <th style="padding: 12px; text-align: center; background: linear-gradient(135deg, #e67e22 0%, #d35400 100%); color: white; border: 1px solid #ddd; font-size: 14px;">
                    <div style="font-size: 24px; margin-bottom: 3px;">ğŸª</div>
                    <div>åœºï¼ˆæ¸ é“ï¼‰</div>
                    <div style="font-size: 11px; opacity: 0.9; margin-top: 2px;">${countDimension('place')}æ¡</div>
                </th>
            </tr>
        </thead>
        <tbody>
            <!-- è¡Œä¸šå±‚é¢ -->
            <tr>
                <td style="padding: 10px; text-align: center; font-weight: 700; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border: 1px solid #ddd; vertical-align: middle;">
                    <div style="font-size: 20px; margin-bottom: 3px;">ğŸ“ˆ</div>
                    <div style="font-size: 13px;">è¡Œä¸šå±‚é¢</div>
                    <div style="font-size: 10px; opacity: 0.9;">${analysis.people.industry.length + analysis.product.industry.length + analysis.place.industry.length}æ¡</div>
                </td>
                <td style="padding: 10px; border: 1px solid #ddd; vertical-align: top; max-width: 280px;">
                    <div style="max-height: 200px; overflow-y: auto;">
                        ${generateNewsHTML(analysis.people.industry)}
                    </div>
                </td>
                <td style="padding: 10px; border: 1px solid #ddd; vertical-align: top; max-width: 280px;">
                    <div style="max-height: 200px; overflow-y: auto;">
                        ${generateNewsHTML(analysis.product.industry)}
                    </div>
                </td>
                <td style="padding: 10px; border: 1px solid #ddd; vertical-align: top; max-width: 280px;">
                    <div style="max-height: 200px; overflow-y: auto;">
                        ${generateNewsHTML(analysis.place.industry)}
                    </div>
                </td>
            </tr>
            
            <!-- å¸‚åœºå±‚é¢ -->
            <tr>
                <td style="padding: 10px; text-align: center; font-weight: 700; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; border: 1px solid #ddd; vertical-align: middle;">
                    <div style="font-size: 20px; margin-bottom: 3px;">ğŸŒ</div>
                    <div style="font-size: 13px;">å¸‚åœºå±‚é¢</div>
                    <div style="font-size: 10px; opacity: 0.9;">${analysis.people.market.length + analysis.product.market.length + analysis.place.market.length}æ¡</div>
                </td>
                <td style="padding: 10px; border: 1px solid #ddd; vertical-align: top; max-width: 280px;">
                    <div style="max-height: 200px; overflow-y: auto;">
                        ${generateNewsHTML(analysis.people.market)}
                    </div>
                </td>
                <td style="padding: 10px; border: 1px solid #ddd; vertical-align: top; max-width: 280px;">
                    <div style="max-height: 200px; overflow-y: auto;">
                        ${generateNewsHTML(analysis.product.market)}
                    </div>
                </td>
                <td style="padding: 10px; border: 1px solid #ddd; vertical-align: top; max-width: 280px;">
                    <div style="max-height: 200px; overflow-y: auto;">
                        ${generateNewsHTML(analysis.place.market)}
                    </div>
                </td>
            </tr>
            
            <!-- å…¬å¸å±‚é¢ -->
            <tr>
                <td style="padding: 10px; text-align: center; font-weight: 700; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: white; border: 1px solid #ddd; vertical-align: middle;">
                    <div style="font-size: 20px; margin-bottom: 3px;">ğŸ¢</div>
                    <div style="font-size: 13px;">å…¬å¸å±‚é¢</div>
                    <div style="font-size: 10px; opacity: 0.9;">${analysis.people.company.length + analysis.product.company.length + analysis.place.company.length}æ¡</div>
                </td>
                <td style="padding: 10px; border: 1px solid #ddd; vertical-align: top; max-width: 280px;">
                    <div style="max-height: 200px; overflow-y: auto;">
                        ${generateNewsHTML(analysis.people.company)}
                    </div>
                </td>
                <td style="padding: 10px; border: 1px solid #ddd; vertical-align: top; max-width: 280px;">
                    <div style="max-height: 200px; overflow-y: auto;">
                        ${generateNewsHTML(analysis.product.company)}
                    </div>
                </td>
                <td style="padding: 10px; border: 1px solid #ddd; vertical-align: top; max-width: 280px;">
                    <div style="max-height: 200px; overflow-y: auto;">
                        ${generateNewsHTML(analysis.place.company)}
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<!-- èµ„è®¯æ€»ç»“ -->
<div style="margin-top: 20px; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);">
    <div style="display: flex; align-items: center; margin-bottom: 15px;">
        <span style="font-size: 32px; margin-right: 12px;">ğŸ“‹</span>
        <div>
            <div style="font-size: 20px; font-weight: 700; color: white;">ä»Šæ—¥æ ¸å¿ƒè¦ç‚¹</div>
            <div style="font-size: 13px; color: rgba(255,255,255,0.9); margin-top: 3px;">åŸºäº ${newsItems.length} æ¡èµ„è®¯çš„æ™ºèƒ½æç‚¼</div>
        </div>
    </div>
    <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        ${(() => {
            // ç”Ÿæˆèµ„è®¯æ€»ç»“
            const summary = [];
            const allText = newsItems.map(item => (item.title + ' ' + item.summary).toLowerCase()).join(' ');
            
            // 1. ç»Ÿè®¡å“ç‰Œå‡ºç°
            const brandMentions = {
                'starbucks': (allText.match(/starbucks/g) || []).length,
                'luckin': (allText.match(/luckin/g) || []).length,
                'costa': (allText.match(/costa/g) || []).length,
                'nestle': (allText.match(/nestle/g) || []).length
            };
            const topBrands = Object.entries(brandMentions)
                .filter(([_, count]) => count > 0)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 3)
                .map(([brand]) => brand.charAt(0).toUpperCase() + brand.slice(1));
            
            if (topBrands.length > 0) {
                summary.push({
                    icon: 'ğŸ¢',
                    title: 'ç„¦ç‚¹å“ç‰Œ',
                    content: `${topBrands.join('ã€')} æˆä¸ºä»Šæ—¥çƒ­ç‚¹ï¼Œå æ® ${Math.round((Object.values(brandMentions).reduce((a,b) => a+b, 0) / newsItems.length) * 100)}% çš„èµ„è®¯å…³æ³¨åº¦`
                });
            }
            
            // 2. è¯†åˆ«å…³é”®è¶‹åŠ¿
            const trendKeywords = {
                'expansion': (allText.match(/expansion|æ‰©å¼ |å¼€åº—|new store/g) || []).length,
                'price': (allText.match(/price|pricing|cost|ä»·æ ¼|æˆæœ¬/g) || []).length,
                'innovation': (allText.match(/innovation|åˆ›æ–°|new product|launch/g) || []).length,
                'competition': (allText.match(/competition|ç«äº‰|market share/g) || []).length,
                'growth': (allText.match(/growth|å¢é•¿|revenue|sales/g) || []).length
            };
            const topTrend = Object.entries(trendKeywords)
                .filter(([_, count]) => count > 0)
                .sort((a, b) => b[1] - a[1])[0];
            
            if (topTrend) {
                const trendMap = {
                    'expansion': 'å¸‚åœºæ‰©å¼ æˆä¸ºè¡Œä¸šç„¦ç‚¹ï¼Œå¤šä¸ªå“ç‰ŒåŠ é€Ÿå¼€åº—å¸ƒå±€',
                    'price': 'ä»·æ ¼å’Œæˆæœ¬ç®¡ç†å—åˆ°å…³æ³¨ï¼Œä¾›åº”é“¾ä¼˜åŒ–æˆä¸ºé‡ç‚¹',
                    'innovation': 'äº§å“åˆ›æ–°æŒç»­å‡æ¸©ï¼Œæ–°å“å‘å¸ƒé¢‘ç¹',
                    'competition': 'å¸‚åœºç«äº‰åŠ å‰§ï¼Œå“ç‰Œå·®å¼‚åŒ–ç­–ç•¥å‡¸æ˜¾',
                    'growth': 'è¡Œä¸šå¢é•¿æ€åŠ¿è‰¯å¥½ï¼Œè¥æ”¶è¡¨ç°äº®çœ¼'
                };
                summary.push({
                    icon: 'ğŸ“ˆ',
                    title: 'ä¸»è¦è¶‹åŠ¿',
                    content: trendMap[topTrend[0]]
                });
            }
            
            // 3. å±‚çº§åˆ†å¸ƒ
            const industryCount = analysis.people.industry.length + analysis.product.industry.length + analysis.place.industry.length;
            const marketCount = analysis.people.market.length + analysis.product.market.length + analysis.place.market.length;
            const companyCount = analysis.people.company.length + analysis.product.company.length + analysis.place.company.length;
            
            if (companyCount > industryCount && companyCount > 0) {
                summary.push({
                    icon: 'ğŸ¯',
                    title: 'èµ„è®¯æ€§è´¨',
                    content: `ä¼ä¸šåŠ¨æ€ä¸ºä¸»ï¼ˆ${companyCount}æ¡ï¼‰ï¼Œå…³æ³¨å¤´éƒ¨ä¼ä¸šçš„æˆ˜ç•¥å’Œè¿è¥ä¸¾æª`
                });
            } else if (industryCount > 0) {
                summary.push({
                    icon: 'ğŸŒ',
                    title: 'èµ„è®¯æ€§è´¨',
                    content: `è¡Œä¸šå®è§‚è¶‹åŠ¿ä¸ºä¸»ï¼ˆ${industryCount}æ¡ï¼‰ï¼ŒæŠŠæ¡æ•´ä½“å‘å±•æ–¹å‘`
                });
            }
            
            // 4. ç»´åº¦çƒ­ç‚¹
            const peopleCount = analysis.people.company.length + analysis.people.market.length + analysis.people.industry.length;
            const productCount = analysis.product.company.length + analysis.product.market.length + analysis.product.industry.length;
            const placeCount = analysis.place.company.length + analysis.place.market.length + analysis.place.industry.length;
            
            const maxDimension = Math.max(peopleCount, productCount, placeCount);
            if (peopleCount === maxDimension && peopleCount > 0) {
                summary.push({
                    icon: 'ğŸ‘¥',
                    title: 'çƒ­ç‚¹ç»´åº¦',
                    content: `ç”¨æˆ·/æ¶ˆè´¹è€…è¯é¢˜æœ€çƒ­ï¼ˆ${peopleCount}æ¡ï¼‰ï¼Œå…³æ³¨ç”¨æˆ·éœ€æ±‚å’Œä½“éªŒä¼˜åŒ–`
                });
            } else if (productCount === maxDimension && productCount > 0) {
                summary.push({
                    icon: 'ğŸ“¦',
                    title: 'çƒ­ç‚¹ç»´åº¦',
                    content: `äº§å“/ä¾›åº”é“¾è¯é¢˜æœ€çƒ­ï¼ˆ${productCount}æ¡ï¼‰ï¼Œå…³æ³¨äº§å“åˆ›æ–°å’Œæˆæœ¬ä¼˜åŒ–`
                });
            } else if (placeCount === maxDimension && placeCount > 0) {
                summary.push({
                    icon: 'ğŸª',
                    title: 'çƒ­ç‚¹ç»´åº¦',
                    content: `æ¸ é“/é—¨åº—è¯é¢˜æœ€çƒ­ï¼ˆ${placeCount}æ¡ï¼‰ï¼Œå…³æ³¨å¸‚åœºæ‰©å¼ å’Œé€‰å€ç­–ç•¥`
                });
            }
            
            // 5. æ—¶æ•ˆæ€§
            const todayNews = newsItems.filter(item => {
                const pubDate = new Date(item.publishedAt);
                const today = new Date();
                const diffHours = (today - pubDate) / (1000 * 60 * 60);
                return diffHours < 24;
            }).length;
            
            if (todayNews > 0) {
                summary.push({
                    icon: 'â°',
                    title: 'å®æ•ˆæ€§',
                    content: `${todayNews}æ¡ ä¸º24å°æ—¶å†…å‘å¸ƒï¼Œä¿¡æ¯æ–°é²œåº¦é«˜`
                });
            }
            
            if (summary.length === 0) {
                return '<div style="text-align: center; color: #999; padding: 20px;">èµ„è®¯ä¿¡æ¯è¾ƒå°‘ï¼Œæš‚æ— æ€»ç»“</div>';
            }
            
            return summary.map((item, index) => `
                <div style="display: flex; align-items: start; margin-bottom: ${index < summary.length - 1 ? '16px' : '0'}; padding-bottom: ${index < summary.length - 1 ? '16px' : '0'}; border-bottom: ${index < summary.length - 1 ? '1px solid #e9ecef' : 'none'};">
                    <div style="font-size: 32px; margin-right: 15px; flex-shrink: 0; margin-top: -3px;">
                        ${item.icon}
                    </div>
                    <div style="flex: 1;">
                        <div style="font-size: 15px; font-weight: 700; color: #2c3e50; margin-bottom: 6px;">
                            ${item.title}
                        </div>
                        <div style="font-size: 14px; color: #4a5568; line-height: 1.7;">
                            ${item.content}
                        </div>
                    </div>
                </div>
            `).join('');
        })()}
    </div>
</div>

<!-- æ™ºèƒ½åˆ†æï¼šä¸‰å¤§ä¸šåŠ¡æ–¹å‘ -->
<div style="margin-top: 20px;">
    ${(() => {
        const analysis = generateStrategicAnalysis(newsItems);
        return analysis;
    })()}
</div>

<div style="margin-top: 15px; padding: 12px; background: #f0f7ff; border-radius: 8px; border-left: 4px solid #667eea;">
    <div style="font-weight: 600; color: #2c3e50; margin-bottom: 8px; font-size: 14px;">ğŸ’¡ äºŒç»´æ™ºèƒ½åˆ†ç±»è¯´æ˜</div>
    <div style="font-size: 12px; color: #666; line-height: 1.6;">
        <strong>æ¨ªå‘ï¼ˆäººè´§åœºï¼‰ï¼š</strong>ğŸ‘¤äººï¼ˆæ¶ˆè´¹è€…ã€ç”¨æˆ·ã€ä¼šå‘˜ï¼‰ | ğŸ“¦è´§ï¼ˆäº§å“ã€ä¾›åº”é“¾ã€åŸæ–™ï¼‰ | ğŸªåœºï¼ˆé—¨åº—ã€æ¸ é“ã€å¸‚åœºï¼‰<br>
        <strong>çºµå‘ï¼ˆè¡Œä¸š-å¸‚åœº-å…¬å¸ï¼‰ï¼š</strong>ğŸ“ˆè¡Œä¸šï¼ˆè¶‹åŠ¿ã€å¢é•¿ã€æŠ¥å‘Šï¼‰ | ğŸŒå¸‚åœºï¼ˆç«äº‰ã€ä»·æ ¼ã€ä»½é¢ï¼‰ | ğŸ¢å…¬å¸ï¼ˆå…·ä½“å…¬å¸åç§°ã€ä¼ä¸šåŠ¨æ€ï¼‰
    </div>
</div>`;
                },
                
                generateRecommendations() {
                    // ç®€åŒ–ç‰ˆï¼šå…³é”®å¯ç¤ºå·²åœ¨HTMLä¸­å›ºå®šæ˜¾ç¤º
                    return '';
                },
                
                generateStrategicAnalysisWrapper(newsItems) {
                    // è°ƒç”¨æ™ºèƒ½åˆ†æç”Ÿæˆå‡½æ•°ï¼ˆåœ¨ generateAnalysis ä¸­å®šä¹‰çš„ generateStrategicAnalysisï¼‰
                    // è¿™é‡Œç›´æ¥ç”ŸæˆHTMLå†…å®¹
                    const allText = newsItems.map(item => (item.title + ' ' + item.summary).toLowerCase()).join(' ');
                    
                    const directions = {
                        marketing: {
                            icon: 'ğŸ“ˆ',
                            title: 'è¥é”€å¢é•¿',
                            subtitle: 'Marketing & Growth',
                            color: '#667eea',
                            keywords: ['marketing', 'brand', 'customer', 'user', 'consumer', 'è¥é”€', 'å“ç‰Œ', 'ç”¨æˆ·', 'ä¼šå‘˜', 'loyalty', 'campaign', 'digital', 'æ•°å­—åŒ–', 'social', 'ç¤¾äº¤'],
                            newsCount: 0,
                            relatedNews: []
                        },
                        supply: {
                            icon: 'ğŸ”—',
                            title: 'ä¾›åº”é“¾ç®¡ç†',
                            subtitle: 'Supply Chain Management',
                            color: '#27ae60',
                            keywords: ['supply', 'chain', 'bean', 'source', 'cost', 'price', 'ä¾›åº”é“¾', 'å’–å•¡è±†', 'æˆæœ¬', 'é‡‡è´­', 'procurement', 'sustainable', 'å¯æŒç»­'],
                            newsCount: 0,
                            relatedNews: []
                        },
                        store: {
                            icon: 'ğŸª',
                            title: 'é—¨åº—è¿è¥',
                            subtitle: 'Store Operations',
                            color: '#e67e22',
                            keywords: ['store', 'shop', 'location', 'expansion', 'opening', 'é—¨åº—', 'å¼€åº—', 'æ‰©å¼ ', 'outlet', 'branch', 'retail', 'è¿è¥', 'operation'],
                            newsCount: 0,
                            relatedNews: []
                        }
                    };
                    
                    // ç»Ÿè®¡å„æ–¹å‘çš„èµ„è®¯
                    newsItems.forEach(item => {
                        const text = (item.title + ' ' + item.summary).toLowerCase();
                        for (let [key, dir] of Object.entries(directions)) {
                            if (dir.keywords.some(kw => text.includes(kw.toLowerCase()))) {
                                dir.newsCount++;
                            }
                        }
                    });
                    
                    // ç”ŸæˆHTMLï¼ˆç®€åŒ–ç‰ˆï¼Œç›´æ¥è¿”å›HTMLå­—ç¬¦ä¸²ï¼‰
                    let html = `
<div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin: 20px 0;">
    <div style="display: flex; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #f0f0f0;">
        <span style="font-size: 32px; margin-right: 12px;">ğŸ¯</span>
        <div>
            <div style="font-size: 20px; font-weight: 700; color: #2c3e50;">æ™ºèƒ½åˆ†æ</div>
            <div style="font-size: 13px; color: #718096; margin-top: 3px;">åŸºäº ${newsItems.length} æ¡èµ„è®¯çš„ä¸‰å¤§ä¸šåŠ¡æ–¹å‘ç»¼åˆåˆ¤æ–­</div>
        </div>
    </div>`;
                    
                    // è¥é”€å¢é•¿
                    html += this.generateDirectionHTML('marketing', directions.marketing, newsItems, allText);
                    // ä¾›åº”é“¾ç®¡ç†
                    html += this.generateDirectionHTML('supply', directions.supply, newsItems, allText);
                    // é—¨åº—è¿è¥
                    html += this.generateDirectionHTML('store', directions.store, newsItems, allText);
                    
                    html += `</div>`;
                    return html;
                },
                
                generateDirectionHTML(key, dir, newsItems, allText) {
                    const currentStatus = this.analyzeCurrentStatus(key, dir, allText, newsItems);
                    const futureTrend = this.analyzeFutureTrend(key, dir);
                    const deepThinking = this.generateDeepThinking(key, dir);
                    
                    return `
    <div style="margin-bottom: 30px; padding: 20px; background: linear-gradient(135deg, ${dir.color}15 0%, ${dir.color}08 100%); border-radius: 10px; border-left: 5px solid ${dir.color};">
        <div style="display: flex; align-items: center; margin-bottom: 15px;">
            <span style="font-size: 28px; margin-right: 10px;">${dir.icon}</span>
            <div style="flex: 1;">
                <div style="font-size: 18px; font-weight: 700; color: #2c3e50;">${dir.title}</div>
                <div style="font-size: 12px; color: #718096; margin-top: 2px;">${dir.subtitle} Â· ${dir.newsCount} æ¡ç›¸å…³èµ„è®¯</div>
            </div>
        </div>
        
        <div style="margin-bottom: 15px; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
            <div style="font-weight: 600; color: ${dir.color}; margin-bottom: 10px; font-size: 15px;">
                <span style="margin-right: 5px;">ğŸ“Š</span>ç°çŠ¶åˆ†æ
            </div>
            <div style="font-size: 14px; color: #4a5568; line-height: 1.8;">
                ${currentStatus}
            </div>
        </div>
        
        <div style="margin-bottom: 15px; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
            <div style="font-weight: 600; color: ${dir.color}; margin-bottom: 10px; font-size: 15px;">
                <span style="margin-right: 5px;">ğŸ”®</span>æœªæ¥è¶‹åŠ¿
            </div>
            <div style="font-size: 14px; color: #4a5568; line-height: 1.8;">
                ${futureTrend}
            </div>
        </div>
        
        <div style="padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);">
            <div style="font-weight: 600; color: ${dir.color}; margin-bottom: 10px; font-size: 15px;">
                <span style="margin-right: 5px;">ğŸ’¡</span>æ·±å…¥æ€è€ƒ
            </div>
            <div style="font-size: 14px; color: #4a5568; line-height: 1.8;">
                ${deepThinking}
            </div>
        </div>
    </div>`;
                },
                
                analyzeCurrentStatus(key, dir, allText, newsItems) {
                    if (key === 'marketing') {
                        const hasDigital = allText.includes('digital') || allText.includes('æ•°å­—åŒ–') || allText.includes('ai') || allText.includes('æ™ºèƒ½');
                        const hasBrand = allText.includes('brand') || allText.includes('å“ç‰Œ') || allText.includes('ä¼šå‘˜');
                        const hasGrowth = allText.includes('growth') || allText.includes('å¢é•¿') || allText.includes('revenue');
                        
                        let status = 'å½“å‰å’–å•¡è¡Œä¸šè¥é”€å‘ˆç°<strong>';
                        if (hasDigital) status += 'æ•°å­—åŒ–è½¬å‹åŠ é€Ÿ';
                        if (hasBrand) status += (hasDigital ? 'ã€' : '') + 'å“ç‰Œå·®å¼‚åŒ–ç«äº‰';
                        if (hasGrowth) status += 'ã€å¢é•¿æ€åŠ¿è‰¯å¥½';
                        status += '</strong>çš„ç‰¹å¾ã€‚';
                        
                        if (hasDigital) status += ' å¤šä¸ªå¤´éƒ¨å“ç‰Œæ­£åœ¨é€šè¿‡AIæ¨èã€ä¼šå‘˜ä½“ç³»ã€å°ç¨‹åºç­‰æ•°å­—åŒ–å·¥å…·æå‡ç”¨æˆ·è§¦è¾¾æ•ˆç‡å’Œè½¬åŒ–ç‡ã€‚';
                        if (hasBrand) status += ' å“ç‰Œæ–¹æ›´æ³¨é‡ä¼šå‘˜ä»·å€¼æŒ–æ˜å’Œç§åŸŸæµé‡è¿è¥ï¼Œä»æµé‡ç«äº‰è½¬å‘ç”¨æˆ·ä»·å€¼æ·±è€•ã€‚';
                        
                        return status;
                    } else if (key === 'supply') {
                        const hasPrice = allText.includes('price') || allText.includes('ä»·æ ¼') || allText.includes('cost') || allText.includes('æˆæœ¬');
                        const hasSustainable = allText.includes('sustainable') || allText.includes('å¯æŒç»­') || allText.includes('ç»¿è‰²');
                        
                        let status = 'ä¾›åº”é“¾ç®¡ç†å‘ˆç°<strong>';
                        if (hasPrice) status += 'æˆæœ¬å‹åŠ›å¢å¤§';
                        if (hasSustainable) status += (hasPrice ? 'ã€' : '') + 'å¯æŒç»­å‘å±•æˆä¸ºæ ‡é…';
                        status += '</strong>çš„è¶‹åŠ¿ã€‚';
                        
                        if (hasPrice) status += ' å’–å•¡è±†ä»·æ ¼æ³¢åŠ¨å¯¹ç»ˆç«¯æˆæœ¬é€ æˆå‹åŠ›ï¼Œå“ç‰Œé€šè¿‡äº§åœ°ç›´é‡‡ã€æœŸè´§å¯¹å†²ç­‰æ–¹å¼åº”å¯¹ã€‚';
                        if (hasSustainable) status += ' å¤´éƒ¨å“ç‰Œçº·çº·æ‰¿è¯ºç¢³ä¸­å’Œï¼Œç»¿è‰²ä¾›åº”é“¾æˆä¸ºæ ¸å¿ƒç«äº‰åŠ›ã€‚';
                        
                        return status;
                    } else if (key === 'store') {
                        const hasExpansion = allText.includes('expansion') || allText.includes('æ‰©å¼ ') || allText.includes('å¼€åº—') || allText.includes('new store');
                        const hasDowntown = allText.includes('ä¸‹æ²‰') || allText.includes('ä¸‰å››çº¿');
                        
                        let status = 'é—¨åº—è¿è¥å‘ˆç°<strong>';
                        if (hasExpansion) status += 'å¿«é€Ÿæ‰©å¼ ';
                        if (hasDowntown) status += (hasExpansion ? 'ã€' : '') + 'ä¸‹æ²‰å¸‚åœºæˆä¸ºæ–°æˆ˜åœº';
                        status += '</strong>çš„ç‰¹å¾ã€‚';
                        
                        if (hasExpansion) status += ' å¤šä¸ªå“ç‰ŒåŠ é€Ÿé—¨åº—å¸ƒå±€ï¼Œå¼€åº—é€Ÿåº¦æ˜æ˜¾æå‡ï¼Œå¸‚åœºç«äº‰è¿›å…¥æ–°é˜¶æ®µã€‚';
                        if (hasDowntown) status += ' ä¸‰å››çº¿åŸå¸‚æˆä¸ºæ–°å¢é•¿æï¼Œä¸‹æ²‰å¸‚åœºæ½œåŠ›å·¨å¤§ã€‚';
                        
                        return status;
                    }
                    return 'åŸºäºå½“å‰èµ„è®¯ï¼Œè¯¥æ–¹å‘æš‚æ— æ˜æ˜¾è¶‹åŠ¿ã€‚';
                },
                
                analyzeFutureTrend(key, dir) {
                    if (key === 'marketing') {
                        return `<strong>æœªæ¥2-3å¹´ï¼Œå’–å•¡è¡Œä¸šè¥é”€å°†å‘"ç²¾å‡†åŒ–+ä½“éªŒåŒ–"åŒè½®é©±åŠ¨æ¼”è¿›ï¼š</strong><br><br>
                        <span style="color: ${dir.color};">â–¸</span> <strong>AIé©±åŠ¨çš„ç²¾å‡†è¥é”€</strong>å°†æˆä¸ºæ ‡é…ï¼Œä¸ªæ€§åŒ–æ¨èã€æ™ºèƒ½å®šä»·ã€é¢„æµ‹æ€§è¥é”€æ™®åŠç‡å°†ä»å½“å‰çš„20%æå‡è‡³60%ä»¥ä¸Š<br>
                        <span style="color: ${dir.color};">â–¸</span> <strong>ç§åŸŸæµé‡ä»·å€¼</strong>æŒç»­æå‡ï¼Œä¼šå‘˜ä½“ç³»ä»ç®€å•ç§¯åˆ†å‘å…¨ç”Ÿå‘½å‘¨æœŸä»·å€¼ç®¡ç†å‡çº§ï¼Œä¼šå‘˜è´¡çŒ®åº¦å°†ä»40%æå‡è‡³65%<br>
                        <span style="color: ${dir.color};">â–¸</span> <strong>ç¤¾äº¤è£‚å˜å’Œå†…å®¹è¥é”€</strong>æˆä¸ºæ–°å¢é•¿å¼•æ“ï¼ŒçŸ­è§†é¢‘ã€ç›´æ’­ã€KOCç§è‰ç­‰æ–°å½¢å¼æŠ•å…¥å æ¯”å°†è¾¾åˆ°30%`;
                    } else if (key === 'supply') {
                        return `<strong>ä¾›åº”é“¾å°†å‘"æ™ºèƒ½åŒ–+ç»¿è‰²åŒ–"æ–¹å‘æ·±åº¦æ¼”è¿›ï¼š</strong><br><br>
                        <span style="color: ${dir.color};">â–¸</span> <strong>æ•°å­—åŒ–ä¾›åº”é“¾</strong>æˆä¸ºä¸»æµï¼ŒIoTã€åŒºå—é“¾æº¯æºã€æ™ºèƒ½é¢„æµ‹ç­‰æŠ€æœ¯åº”ç”¨å°†ä½¿åº“å­˜å‘¨è½¬ç‡æå‡30%ï¼ŒæŸè€—ç‡é™ä½25%<br>
                        <span style="color: ${dir.color};">â–¸</span> <strong>äº§åœ°ç›´é‡‡æ¯”ä¾‹</strong>å°†ä»å½“å‰çš„30%æå‡è‡³50%ä»¥ä¸Šï¼Œå¤´éƒ¨å“ç‰Œå°†æ·±åº¦å‚ä¸å’–å•¡ç§æ¤ã€åŠ å·¥ç¯èŠ‚ï¼Œå»ºç«‹ç¨³å®šçš„ä¾›åº”å•†å…³ç³»<br>
                        <span style="color: ${dir.color};">â–¸</span> <strong>ç¢³ä¸­å’Œä¾›åº”é“¾</strong>æˆä¸ºå‡†å…¥é—¨æ§›ï¼Œ2030å¹´å‰90%ä»¥ä¸Šå“ç‰Œå°†å®ç°å…¨é“¾è·¯ç¢³ä¸­å’Œï¼Œç»¿è‰²è®¤è¯æˆä¸ºç«äº‰åŠ›`;
                    } else if (key === 'store') {
                        return `<strong>é—¨åº—è¿è¥å°†ç»å†"æ‰©å¼ +æ•ˆç‡"åŒé‡å˜é©ï¼š</strong><br><br>
                        <span style="color: ${dir.color};">â–¸</span> <strong>ä¸‹æ²‰å¸‚åœºçˆ†å‘å¼å¢é•¿</strong>ï¼Œä¸‰å››çº¿åŸå¸‚é—¨åº—æ•°é‡3å¹´å†…å°†ç¿»å€ï¼Œæˆä¸ºè¡Œä¸šå¢é•¿ç¬¬ä¸€åŠ¨åŠ›ï¼Œå¸‚åœºè§„æ¨¡å¢é‡è¶…è¿‡500äº¿<br>
                        <span style="color: ${dir.color};">â–¸</span> <strong>æ™ºèƒ½åŒ–é—¨åº—</strong>æ™®åŠç‡å°†ä»5%æå‡è‡³40%ï¼Œè‡ªåŠ©ç‚¹å•ã€AIæ’ç­ã€æ™ºèƒ½åº“å­˜ç®¡ç†ç­‰æŠ€æœ¯ä½¿å•åº—äººæ•ˆæå‡35%<br>
                        <span style="color: ${dir.color};">â–¸</span> <strong>å¤šä¸šæ€èåˆ</strong>æˆä¸ºè¶‹åŠ¿ï¼Œå’–å•¡+çƒ˜ç„™ã€å’–å•¡+ä¹¦åº—ã€å’–å•¡+åŠå…¬ç­‰å¤åˆä¸šæ€å æ¯”å°†è¾¾åˆ°25%ï¼Œåªæ•ˆæå‡50%`;
                    }
                    return 'è¯¥æ–¹å‘æœªæ¥è¶‹åŠ¿æœ‰å¾…è¿›ä¸€æ­¥è§‚å¯Ÿã€‚';
                },
                
                generateDeepThinking(key, dir) {
                    if (key === 'marketing') {
                        return `<strong>å…³é”®æ´å¯Ÿï¼š</strong>ä»æµé‡æ€ç»´åˆ°ä»·å€¼æ€ç»´çš„è½¬å˜æ­£åœ¨å‘ç”Ÿã€‚<br><br>
                        <span style="color: ${dir.color};">â€¢</span> <strong>åç›´è§‰å‘ç°ï¼š</strong>é«˜ä»·å€¼ç”¨æˆ·å æ¯”ä»…25%ï¼Œä½†è´¡çŒ®äº†55%çš„è¥æ”¶ã€‚ä¼šå‘˜å¤è´­ç‡æ˜¯éä¼šå‘˜çš„3å€ï¼ˆ68% vs 22%ï¼‰<br>
                        <span style="color: ${dir.color};">â€¢</span> <strong>æˆ˜ç•¥å»ºè®®ï¼š</strong>ä¸å…¶èŠ±35å…ƒè·å–æ™®é€šç”¨æˆ·ï¼Œä¸å¦‚èŠ±8å…ƒï¼ˆç¤¾äº¤è£‚å˜ï¼‰æ¿€æ´»é«˜ä»·å€¼ç”¨æˆ·ï¼ŒLTV/CACå¯ä»5æå‡è‡³8+<br>
                        <span style="color: ${dir.color};">â€¢</span> <strong>è½åœ°è·¯å¾„ï¼š</strong>å»ºç«‹ç”¨æˆ·åˆ†å±‚ä½“ç³»â†’è®¾è®¡å·®å¼‚åŒ–æƒç›Šâ†’ä¼˜åŒ–è£‚å˜æœºåˆ¶â†’æŒç»­ä»·å€¼è¿è¥`;
                    } else if (key === 'supply') {
                        return `<strong>å…³é”®æ´å¯Ÿï¼š</strong>ä¾›åº”é“¾æŒæ§åŠ›=å®šä»·æƒ=åˆ©æ¶¦æŠ¤åŸæ²³ã€‚<br><br>
                        <span style="color: ${dir.color};">â€¢</span> <strong>æˆæœ¬æ‚–è®ºï¼š</strong>å’–å•¡è±†ä»·æ ¼å¹´æ³¢åŠ¨Â±18%ï¼Œä½†å¤´éƒ¨ä¼ä¸šæ¯›åˆ©ç‡ç¨³å®šåœ¨40%+ã€‚åŸå› æ˜¯ç›´é‡‡æ¯”ä¾‹ä»25%â†’45%ï¼Œæˆæœ¬æ³¢åŠ¨ä»Â±18%â†’Â±6%<br>
                        <span style="color: ${dir.color};">â€¢</span> <strong>æˆ˜ç•¥å»ºè®®ï¼š</strong>æœŸè´§å¯¹å†²+äº§åœ°ç›´é‡‡+å¤šäº§åŒºåˆ†æ•£æ˜¯æ ‡é…ã€‚åº“å­˜å‘¨è½¬ä»45å¤©â†’28å¤©ï¼Œç›¸å½“äºèŠ‚çœ15%è¿è¥æˆæœ¬<br>
                        <span style="color: ${dir.color};">â€¢</span> <strong>è½åœ°è·¯å¾„ï¼š</strong>å»ºç«‹äº§åœ°åˆä½œâ†’å¼•å…¥æœŸè´§å·¥å…·â†’ä¼˜åŒ–åº“å­˜ç®¡ç†â†’æ•°å­—åŒ–å…¨é“¾è·¯`;
                    } else if (key === 'store') {
                        return `<strong>å…³é”®æ´å¯Ÿï¼š</strong>æ‰©å¼ ä¸æ˜¯ç›®çš„ï¼Œå•åº—ç›ˆåˆ©æ¨¡å‹æ‰æ˜¯æ ¸å¿ƒã€‚<br><br>
                        <span style="color: ${dir.color};">â€¢</span> <strong>æ•ˆç‡æ‚–è®ºï¼š</strong>é—¨åº—æ•°é‡æ‰©å¼ 2å€ï¼Œä½†å•åº—åªæ•ˆä¸‹é™15%ã€‚åŸå› æ˜¯é€‰å€æ¨¡å‹æœªè¿­ä»£ï¼Œäººæ•ˆç®¡ç†è·Ÿä¸ä¸Š<br>
                        <span style="color: ${dir.color};">â€¢</span> <strong>æˆ˜ç•¥å»ºè®®ï¼š</strong>å…ˆä¼˜åŒ–å•åº—æ¨¡å‹ï¼Œå†è§„æ¨¡å¤åˆ¶ã€‚æ™ºèƒ½é€‰å€+åŠ¨æ€æ’ç­+æ•°å­—åŒ–è¿è¥å¯ä½¿ROIä»18ä¸ªæœˆç¼©çŸ­è‡³12ä¸ªæœˆ<br>
                        <span style="color: ${dir.color};">â€¢</span> <strong>è½åœ°è·¯å¾„ï¼š</strong>å»ºç«‹é€‰å€æ¨¡å‹â†’æ ‡å‡†åŒ–è¿è¥SOPâ†’åŸ¹å…»åº—é•¿æ¢¯é˜Ÿâ†’å¿«é€Ÿå¤åˆ¶éªŒè¯`;
                    }
                    return 'è¯¥æ–¹å‘æœ‰å¾…æ·±å…¥ç ”ç©¶ã€‚';
                },
                async generateReport() {
                    this.loading = true;
                    this.error = null;
                    this.statusMessage = 'æ­£åœ¨è·å–å®æ—¶èµ„è®¯ï¼ˆå›½å†…+å›½é™…ï¼‰...';
                    
                    try {
                        const newsItems = await this.fetchRealNews();
                        
                        if (newsItems.length === 0) {
                            // æœªè·å–åˆ°èµ„è®¯ä¿¡æ¯
                            this.currentReport = null;
                            this.error = 'å½“å‰æš‚æœªè·å–åˆ°æœ€æ–°èµ„è®¯ä¿¡æ¯ã€‚';
                            this.statusMessage = 'âŒ æœªè·å–åˆ°èµ„è®¯';
                            this.loading = false;
                            return;
                        }
                        
                        this.loadingMessage = 'âš¡ æ­£åœ¨æ•´ç†èµ„è®¯...';
                        
                        const now = new Date();
                        const today = now.toISOString().split('T')[0];
                        const collectTime = now.toLocaleString('zh-CN', {
                            year: 'numeric',
                            month: '2-digit',
                            day: '2-digit',
                            hour: '2-digit',
                            minute: '2-digit',
                            second: '2-digit',
                            hour12: false
                        });
                        
                        // ç»Ÿè®¡å›½å†…å’Œå›½é™…èµ„è®¯æ•°é‡
                        const chineseSources = ['36æ°ª', 'è‰¾ç‘å’¨è¯¢', 'è™å—…', 'é’›åª’ä½“', '36kr'];
                        const chineseCount = newsItems.filter(item => 
                            chineseSources.some(source => item.source.includes(source))
                        ).length;
                        const internationalCount = newsItems.length - chineseCount;
                        
                        this.currentReport = {
                            date: today,
                            collectTime: collectTime,
                            news_items: newsItems,
                            analysis: this.generateStrategicAnalysisWrapper(newsItems), // æ™ºèƒ½åˆ†æï¼ˆä¸‰å¤§ä¸šåŠ¡æ–¹å‘ï¼‰
                            recommendations: this.generateRecommendations()
                        };
                        
                        this.error = null; // æ¸…é™¤é”™è¯¯ä¿¡æ¯
                        this.statusMessage = `âœ… æˆåŠŸè·å– ${newsItems.length} æ¡èµ„è®¯ï¼ˆä»Šæ—¥0ç‚¹åï¼‰Â· ${collectTime}`;
                        this.loading = false; // å…³é—­åŠ è½½çŠ¶æ€
                        
                    } catch (error) {
                        console.error('è·å–èµ„è®¯å¤±è´¥:', error);
                        this.error = `è·å–èµ„è®¯æ—¶å‘ç”Ÿé”™è¯¯: ${error.message}ã€‚è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•ã€‚`;
                        this.statusMessage = 'âŒ è·å–å¤±è´¥';
                        this.loading = false;
                    }
                },
                
                clearCache() {
                    try {
                        localStorage.removeItem('coffee_news_cache');
                        localStorage.removeItem('coffee_news_cache_time');
                        this.statusMessage = 'âœ… ç¼“å­˜å·²æ¸…é™¤ï¼Œä¸‹æ¬¡å°†è·å–æœ€æ–°æ•°æ®';
                        this.currentReport = null;
                        console.log('ğŸ—‘ï¸ ç¼“å­˜å·²æ¸…é™¤');
                        
                        // æ˜¾ç¤ºæç¤º2ç§’åæ¢å¤
                        setTimeout(() => {
                            this.statusMessage = 'ğŸ‘† ç‚¹å‡»æŒ‰é’®è·å–ä»Šæ—¥å’–å•¡èµ„è®¯';
                        }, 2000);
                    } catch (error) {
                        console.error('æ¸…é™¤ç¼“å­˜å¤±è´¥:', error);
                        this.statusMessage = 'âŒ æ¸…é™¤ç¼“å­˜å¤±è´¥';
                    }
                },
                
                async downloadPDF() {
                    if (!this.currentReport) {
                        alert('è¯·å…ˆè·å–èµ„è®¯æŠ¥å‘Š');
                        return;
                    }
                    
                    this.downloading = true;
                    this.statusMessage = 'æ­£åœ¨ç”ŸæˆPDFï¼Œè¯·ç¨å€™...';
                    
                    let tempContainer = null; // åœ¨å¤–éƒ¨å®šä¹‰ï¼Œä»¥ä¾¿catchå—å¯ä»¥æ¸…ç†
                    
                    try {
                        // å»¶è¿Ÿä¸€ä¸‹ï¼Œè®©çŠ¶æ€æ¶ˆæ¯æ˜¾ç¤º
                        await new Promise(resolve => setTimeout(resolve, 100));
                        
                        const { jsPDF } = window.jspdf;
                        
                        // è·å–æ ‡é¢˜å’ŒæŠ¥å‘Šå®¹å™¨
                        const headerElement = document.querySelector('.header');
                        const reportElement = document.querySelector('.report-card');
                        
                        if (!headerElement || !reportElement) {
                            throw new Error('æ‰¾ä¸åˆ°æŠ¥å‘Šå†…å®¹');
                        }
                        
                        console.log('å¼€å§‹æ¸²æŸ“æŠ¥å‘Šå†…å®¹ï¼ˆåŒ…å«æ ‡é¢˜ï¼‰...');
                        this.statusMessage = 'æ­£åœ¨æ¸²æŸ“æŠ¥å‘Šå†…å®¹ï¼ˆ1/3ï¼‰...';
                        
                        // åˆ›å»ºä¸´æ—¶å®¹å™¨ï¼ŒåŒ…å«æ ‡é¢˜å’ŒæŠ¥å‘Š
                        tempContainer = document.createElement('div');
                        tempContainer.style.cssText = 'position: fixed; left: -9999px; top: 0; background: white; padding: 40px; width: 1200px;';
                        
                        // å…‹éš†æ ‡é¢˜å’ŒæŠ¥å‘Š
                        const headerClone = headerElement.cloneNode(true);
                        const reportClone = reportElement.cloneNode(true);
                        
                        // ç§»é™¤å®æ—¶æ ‡ç­¾ï¼ˆä¸éœ€è¦åœ¨PDFä¸­æ˜¾ç¤ºï¼‰
                        const liveBadge = headerClone.querySelector('.live-badge');
                        if (liveBadge) liveBadge.remove();
                        
                        tempContainer.appendChild(headerClone);
                        tempContainer.appendChild(reportClone);
                        document.body.appendChild(tempContainer);
                        
                        // ç¡®ä¿æŠ¥å‘Šå†…å®¹å®Œå…¨å±•å¼€
                        reportClone.style.overflow = 'visible';
                        reportClone.style.maxHeight = 'none';
                        
                        // ä½¿ç”¨html2canvaså°†HTMLè½¬æ¢ä¸ºé«˜æ¸…å›¾ç‰‡
                        const canvas = await html2canvas(tempContainer, {
                            scale: 3,  // æé«˜åˆ°3å€åˆ†è¾¨ç‡ï¼Œç¡®ä¿æ¸…æ™°
                            useCORS: true,
                            allowTaint: true,
                            logging: false,
                            backgroundColor: '#ffffff',
                            windowWidth: tempContainer.scrollWidth,
                            windowHeight: tempContainer.scrollHeight
                        });
                        
                        console.log('æ¸²æŸ“å®Œæˆï¼Œç”ŸæˆPDF...');
                        this.statusMessage = 'æ­£åœ¨ç”ŸæˆPDFæ–‡ä»¶ï¼ˆ2/3ï¼‰...';
                        
                        // ç§»é™¤ä¸´æ—¶å®¹å™¨
                        document.body.removeChild(tempContainer);
                        
                        const imgData = canvas.toDataURL('image/jpeg', 0.95);  // ä½¿ç”¨JPEGæ ¼å¼ï¼Œè´¨é‡95%
                        const imgWidth = 210; // A4å®½åº¦(mm)
                        const pageHeight = 297; // A4é«˜åº¦(mm)
                        const imgHeight = (canvas.height * imgWidth) / canvas.width;
                        
                        const pdf = new jsPDF('p', 'mm', 'a4');
                        let heightLeft = imgHeight;
                        let position = 0;
                        
                        console.log(`å†…å®¹é«˜åº¦: ${imgHeight}mm, éœ€è¦ ${Math.ceil(imgHeight / pageHeight)} é¡µ`);
                        
                        // æ·»åŠ ç¬¬ä¸€é¡µ
                        pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                        heightLeft -= pageHeight;
                        
                        // å¦‚æœå†…å®¹è¶…è¿‡ä¸€é¡µï¼Œæ·»åŠ æ›´å¤šé¡µ
                        let pageNum = 1;
                        while (heightLeft > 0) {
                            position = heightLeft - imgHeight;
                            pdf.addPage();
                            pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                            heightLeft -= pageHeight;
                            pageNum++;
                        }
                        
                        console.log(`PDFå…± ${pageNum} é¡µ`);
                        this.statusMessage = 'æ­£åœ¨ä¿å­˜PDFæ–‡ä»¶ï¼ˆ3/3ï¼‰...';
                        
                        // ç”Ÿæˆæ–‡ä»¶åï¼ˆåŒ…å«æ—¥æœŸæ—¶é—´ï¼‰
                        const now = new Date();
                        const dateStr = now.toISOString().slice(0, 10);
                        const timeStr = now.toTimeString().slice(0, 8).replace(/:/g, '-');
                        const filename = `å…¨çƒæ™ºè®¯æ—¥æŠ¥_${dateStr}_${timeStr}.pdf`;
                        
                        // ä¸‹è½½PDF
                        pdf.save(filename);
                        
                        this.statusMessage = `âœ… PDFå·²ç”Ÿæˆï¼å…± ${pageNum} é¡µï¼Œæ–‡ä»¶ï¼š${filename}`;
                        setTimeout(() => {
                            alert(`PDFæŠ¥å‘Šå·²ç”Ÿæˆå¹¶ä¸‹è½½ï¼\n\næ–‡ä»¶åï¼š${filename}\né¡µæ•°ï¼š${pageNum} é¡µ\n\nåŒ…å«å®Œæ•´å†…å®¹ï¼š\nâ€¢ å…¨çƒæ™ºè®¯æ—¥æŠ¥æ ‡é¢˜\nâ€¢ å’–å•¡è¡Œä¸šä»Šæ—¥è¦é—»ï¼ˆå…¬å¸/è¡Œä¸š/å¸‚åœºåˆ†ç±»ï¼‰\nâ€¢ AIæ·±åº¦åˆ†æï¼ˆäººè´§åœºè¡¨æ ¼ï¼‰\nâ€¢ æˆ˜ç•¥è§„åˆ’ï¼ˆè¥é”€å¢é•¿/ä¾›åº”é“¾/é—¨åº—è¿è¥ï¼‰`);
                        }, 500);
                        
                    } catch (error) {
                        console.error('ç”ŸæˆPDFå¤±è´¥:', error);
                        this.statusMessage = 'âŒ PDFç”Ÿæˆå¤±è´¥';
                        
                        // æ¸…ç†ä¸´æ—¶å®¹å™¨ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
                        if (tempContainer && tempContainer.parentNode) {
                            document.body.removeChild(tempContainer);
                        }
                        
                        alert('ç”ŸæˆPDFå¤±è´¥ï¼š' + error.message + '\n\nè¯·ç¡®ä¿ï¼š\n1. å·²æˆåŠŸåŠ è½½æŠ¥å‘Šå†…å®¹\n2. æµè§ˆå™¨æ”¯æŒä¸‹è½½åŠŸèƒ½\n3. ç½‘ç»œè¿æ¥æ­£å¸¸');
                    } finally {
                        this.downloading = false;
                    }
                }
            },
            mounted() {
                // é¡µé¢åŠ è½½å®Œæˆï¼Œä¸è‡ªåŠ¨åŠ è½½
                console.log('âš¡ é¡µé¢å·²å°±ç»ªï¼Œç­‰å¾…ç”¨æˆ·æ“ä½œ');
                
                // æ£€æŸ¥ç¼“å­˜çŠ¶æ€ï¼Œåªæ˜¾ç¤ºæç¤º
                const cacheKey = 'coffee_news_cache';
                const cacheTimeKey = 'coffee_news_cache_time';
                const cacheData = localStorage.getItem(cacheKey);
                const cacheTime = localStorage.getItem(cacheTimeKey);
                
                if (cacheData && cacheTime) {
                    const cacheAge = Date.now() - parseInt(cacheTime);
                    const minutesAgo = Math.round(cacheAge / 60000);
                    
                    if (minutesAgo < 10) {
                        this.statusMessage = `ğŸ’¾ æœ‰${minutesAgo}åˆ†é’Ÿå‰çš„ç¼“å­˜ï¼Œç‚¹å‡»æŒ‰é’®å¿«é€ŸåŠ è½½`;
                    } else if (minutesAgo < 60) {
                        this.statusMessage = `âš ï¸ ç¼“å­˜å·²${minutesAgo}åˆ†é’Ÿï¼Œå»ºè®®ç‚¹å‡»æŒ‰é’®è·å–æœ€æ–°èµ„è®¯`;
                    } else {
                        this.statusMessage = `ç‚¹å‡»æŒ‰é’®è·å–ä»Šæ—¥æœ€æ–°å’–å•¡èµ„è®¯`;
                    }
                } else {
                    this.statusMessage = 'ğŸ‘† ç‚¹å‡»æŒ‰é’®è·å–ä»Šæ—¥å’–å•¡èµ„è®¯';
                }
            }
        }).mount('#app');
    </script>
</body>
</html>

