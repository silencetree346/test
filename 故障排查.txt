========================================
  网页按钮点击无效 - 故障排查指南
========================================

【问题症状】
点击"立即生成报告"按钮没有反应

【排查步骤】

1️⃣ 检查后端服务是否启动
   
   在终端运行：
   ./start.sh
   
   应该看到：
   INFO:     Uvicorn running on http://0.0.0.0:8000
   
   如果没有启动，会显示连接错误

2️⃣ 检查浏览器控制台
   
   打开浏览器开发者工具（F12 或右键 → 检查）
   查看 Console 标签页
   
   正常情况应该看到：
   ✅ 后端服务连接成功: {message: "咖啡行业调研推送系统"}
   
   如果看到错误：
   ❌ 后端服务连接失败: Error: Network Error
   → 说明后端服务未启动

3️⃣ 检查端口占用
   
   运行：
   lsof -i :8000
   
   应该看到 python 进程
   如果没有，说明服务未启动

4️⃣ 检查 API 密钥配置
   
   确认 backend/.env 文件存在且包含：
   OPENAI_API_KEY=sk-xxxxx
   
   如果没有配置，创建：
   cd backend
   cp env_template.txt .env
   # 编辑 .env 填入密钥

5️⃣ 测试 API 接口
   
   在终端运行：
   curl http://localhost:8000/
   
   应该返回：
   {"message":"咖啡行业调研推送系统"}
   
   如果报错，说明后端有问题

========================================
【常见错误及解决方案】
========================================

错误1: ERR_NETWORK / Network Error
原因：后端服务未启动
解决：运行 ./start.sh 启动服务

错误2: CORS policy blocked
原因：CORS 配置问题（理论上不应该出现）
解决：检查 backend/main.py 中的 CORS 配置

错误3: 404 Not Found
原因：API 路径错误
解决：确认访问 http://localhost:8000/api/reports/generate

错误4: 500 Internal Server Error
原因：后端代码错误（通常是 API 密钥未配置）
解决：
  1. 查看终端中的错误日志
  2. 确认 OPENAI_API_KEY 已配置
  3. 如果没有 NEWS_API_KEY，系统会使用模拟数据

错误5: 点击按钮无任何反应
原因：JavaScript 加载失败
解决：
  1. 检查浏览器控制台是否有红色错误
  2. 确认 Vue.js 和 Axios CDN 已加载
  3. 清除浏览器缓存后刷新

========================================
【快速验证方案】
========================================

方案A: 完整重启

cd /Users/luckincoffee/test
./stop.sh
./start.sh

然后刷新浏览器页面

方案B: 使用测试脚本

cd backend
python test_api.py

会自动测试所有 API 端点

========================================
【查看详细日志】
========================================

后端日志：
启动服务后，终端会实时显示所有请求和错误

浏览器日志：
F12 → Console 标签
查看所有 console.log 和错误信息

现在页面会显示更详细的错误信息：
- 打开页面时自动检测后端连接
- 点击按钮时显示详细错误原因
- 控制台输出所有请求细节

========================================
【验证清单】
========================================

□ Python 3.8+ 已安装
□ 依赖已安装（运行过 ./install.sh）
□ backend/.env 文件存在
□ OPENAI_API_KEY 已配置
□ 后端服务已启动（./start.sh）
□ http://localhost:8000 可访问
□ 浏览器控制台无红色错误
□ 网络连接正常

========================================
【仍然无法解决？】
========================================

1. 完整日志收集：
   - 终端输出的所有内容
   - 浏览器控制台的所有错误
   - backend/.env 的配置（隐藏密钥）

2. 系统信息：
   - 操作系统版本
   - Python 版本: python3 --version
   - 浏览器版本

3. 重新安装：
   cd backend
   rm -rf venv
   cd ..
   ./install.sh
   # 重新配置 .env
   ./start.sh

========================================




