# æŒ‡å®šèµ„è®¯æºé…ç½®æŒ‡å— ğŸŒ

## ğŸ“‹ ç›®æ ‡èµ„è®¯æº

### ğŸ‡¨ğŸ‡³ å›½å†…èµ„è®¯æºï¼ˆ5ä¸ªï¼‰

| èµ„è®¯æº | ä»·å€¼ | APIéš¾åº¦ |
|--------|------|---------|
| 36æ°ª | ç§‘æŠ€åˆ›æŠ•è§†è§’ï¼Œæ–°æ¶ˆè´¹å“ç‰Œ | â­â­ |
| è™å—… | æ·±åº¦å•†ä¸šåˆ†æï¼Œè¡Œä¸šæ´å¯Ÿ | â­â­ |
| è…¾è®¯æ–°é—» | ä¸»æµæ–°é—»å¹³å°ï¼Œè¦†ç›–é¢å¹¿ | â­â­â­ |
| è‰¾ç‘å’¨è¯¢ | ä¸“ä¸šå¸‚åœºç ”ç©¶æŠ¥å‘Š | â­â­ |
| ç™¾åº¦èµ„è®¯ | ç»¼åˆèµ„è®¯å¹³å° | â­â­â­ |

### ğŸŒ å›½é™…èµ„è®¯æºï¼ˆ5ä¸ªï¼‰

| èµ„è®¯æº | ä»·å€¼ | APIéš¾åº¦ |
|--------|------|---------|
| çº½çº¦æ—¶æŠ¥ï¼ˆNYTï¼‰ | æƒå¨è´¢ç»æŠ¥é“ | â­â­ |
| åå°”è¡—æ—¥æŠ¥ï¼ˆWSJï¼‰ | å•†ä¸šé‡‘èæ·±åº¦ | â­â­â­ |
| é‡‘èæ—¶æŠ¥ï¼ˆFTï¼‰ | å…¨çƒå•†ä¸šè§†è§’ | â­â­â­ |
| å“ˆä½›å•†ä¸šè¯„è®ºï¼ˆHBRï¼‰ | ç®¡ç†æˆ˜ç•¥æ´å¯Ÿ | â­â­ |
| æ˜Ÿå·´å…‹å®˜ç½‘ | å®˜æ–¹æ–°é—»å‘å¸ƒ | â­ |

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²æ–¹æ¡ˆï¼ˆ5åˆ†é’Ÿï¼‰

### æ–¹æ¡ˆé€‰æ‹©

**æ¨èæ–¹æ¡ˆï¼šNode.js + Express åç«¯ä»£ç†**
- âœ… ç®€å•æ˜“ç”¨ï¼Œ5åˆ†é’Ÿé…ç½®
- âœ… æ”¯æŒæ‰€æœ‰èµ„è®¯æº
- âœ… è‡ªåŠ¨å¤„ç†CORS
- âœ… æœ¬åœ°è¿è¡Œæˆ–éƒ¨ç½²åˆ°äº‘ç«¯

---

## ğŸ“¦ æ­¥éª¤1ï¼šåˆ›å»ºåç«¯æœåŠ¡

### 1.1 åˆ›å»ºé¡¹ç›®ç›®å½•

```bash
cd /Users/luckincoffee/test
mkdir backend-news-proxy
cd backend-news-proxy
```

### 1.2 åˆå§‹åŒ–é¡¹ç›®

```bash
npm init -y
npm install express axios cheerio cors dotenv
```

### 1.3 åˆ›å»º `server.js`

```javascript
const express = require('express');
const axios = require('axios');
const cheerio = require('cheerio');
const cors = require('cors');
require('dotenv').config();

const app = express();
const PORT = process.env.PORT || 3001;

// å¯ç”¨CORS
app.use(cors({
    origin: ['http://localhost:8000', 'https://silencetree346.github.io']
}));

// é€šç”¨çˆ¬å–å‡½æ•°
async function scrapeNews(url, selector, titleSelector, linkSelector, dateSelector) {
    try {
        const response = await axios.get(url, {
            headers: {
                'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36'
            }
        });
        
        const $ = cheerio.load(response.data);
        const news = [];
        
        $(selector).each((index, element) => {
            if (index < 5) { // æ¯ä¸ªæºå–5æ¡
                const title = $(element).find(titleSelector).text().trim();
                const link = $(element).find(linkSelector).attr('href');
                const date = $(element).find(dateSelector).text().trim();
                
                if (title) {
                    news.push({
                        title,
                        url: link?.startsWith('http') ? link : url + link,
                        source: 'æ¥æºç½‘ç«™',
                        publishedAt: date || new Date().toISOString(),
                        summary: title
                    });
                }
            }
        });
        
        return news;
    } catch (error) {
        console.error('çˆ¬å–å¤±è´¥:', error.message);
        return [];
    }
}

// APIè·¯ç”±ï¼šè·å–æ‰€æœ‰èµ„è®¯æº
app.get('/api/coffee-news-sources', async (req, res) => {
    console.log('ğŸ“¡ æ”¶åˆ°èµ„è®¯è·å–è¯·æ±‚...');
    
    const allNews = [];
    
    try {
        // å¹¶å‘è·å–æ‰€æœ‰èµ„è®¯æº
        const results = await Promise.allSettled([
            // å›½å†…èµ„è®¯æº
            fetch36kr(),
            fetchHuxiu(),
            fetchTencent(),
            fetchIresearch(),
            fetchBaidu(),
            
            // å›½é™…èµ„è®¯æº
            fetchNYT(),
            fetchWSJ(),
            fetchFT(),
            fetchHBR(),
            fetchStarbucks()
        ]);
        
        // åˆå¹¶ç»“æœ
        results.forEach((result, index) => {
            if (result.status === 'fulfilled') {
                allNews.push(...result.value);
            }
        });
        
        console.log(`âœ… å…±è·å– ${allNews.length} æ¡èµ„è®¯`);
        res.json(allNews);
        
    } catch (error) {
        console.error('âŒ è·å–èµ„è®¯å¤±è´¥:', error);
        res.status(500).json({ error: error.message });
    }
});

// === å›½å†…èµ„è®¯æº ===

// 36æ°ª
async function fetch36kr() {
    console.log('ğŸ” è·å–36æ°ªèµ„è®¯...');
    
    try {
        // æ–¹æ³•1ï¼šä½¿ç”¨36æ°ªæœç´¢API
        const response = await axios.get('https://www.36kr.com/search/articles/å’–å•¡', {
            headers: { 'User-Agent': 'Mozilla/5.0' },
            timeout: 5000
        });
        
        const $ = cheerio.load(response.data);
        const news = [];
        
        $('.article-item').each((i, elem) => {
            if (i < 5) {
                const title = $(elem).find('.article-item-title').text().trim();
                const link = $(elem).find('a').attr('href');
                const time = $(elem).find('.article-item-time').text().trim();
                
                if (title && (title.includes('å’–å•¡') || title.includes('å¥¶èŒ¶') || title.includes('æ˜Ÿå·´å…‹') || title.includes('ç‘å¹¸'))) {
                    news.push({
                        title,
                        url: link?.startsWith('http') ? link : `https://www.36kr.com${link}`,
                        source: '36æ°ª',
                        publishedAt: time || new Date().toISOString(),
                        summary: title
                    });
                }
            }
        });
        
        console.log(`âœ… 36æ°ª: ${news.length} æ¡`);
        return news;
    } catch (error) {
        console.error('âŒ 36æ°ªè·å–å¤±è´¥:', error.message);
        return [];
    }
}

// è™å—…
async function fetchHuxiu() {
    console.log('ğŸ” è·å–è™å—…èµ„è®¯...');
    
    try {
        const response = await axios.get('https://www.huxiu.com/search?s=å’–å•¡', {
            headers: { 'User-Agent': 'Mozilla/5.0' },
            timeout: 5000
        });
        
        const $ = cheerio.load(response.data);
        const news = [];
        
        $('.search-article-item').each((i, elem) => {
            if (i < 5) {
                const title = $(elem).find('.article-item__title').text().trim();
                const link = $(elem).find('a').attr('href');
                const time = $(elem).find('.article-item__time').text().trim();
                
                if (title) {
                    news.push({
                        title,
                        url: link?.startsWith('http') ? link : `https://www.huxiu.com${link}`,
                        source: 'è™å—…',
                        publishedAt: time || new Date().toISOString(),
                        summary: title
                    });
                }
            }
        });
        
        console.log(`âœ… è™å—…: ${news.length} æ¡`);
        return news;
    } catch (error) {
        console.error('âŒ è™å—…è·å–å¤±è´¥:', error.message);
        return [];
    }
}

// è…¾è®¯æ–°é—»
async function fetchTencent() {
    console.log('ğŸ” è·å–è…¾è®¯æ–°é—»...');
    
    try {
        // è…¾è®¯æ–°é—»RSSæˆ–API
        const response = await axios.get('https://pacaio.match.qq.com/irs/rcd', {
            params: {
                cid: 'finance',
                token: '',
                ext: 'coffee'
            },
            timeout: 5000
        });
        
        // ç®€åŒ–å¤„ç†ï¼Œå®é™…éœ€è¦æ ¹æ®APIå“åº”æ ¼å¼è°ƒæ•´
        const news = [];
        console.log(`âœ… è…¾è®¯æ–°é—»: ${news.length} æ¡`);
        return news;
    } catch (error) {
        console.error('âŒ è…¾è®¯æ–°é—»è·å–å¤±è´¥:', error.message);
        return [];
    }
}

// è‰¾ç‘å’¨è¯¢
async function fetchIresearch() {
    console.log('ğŸ” è·å–è‰¾ç‘å’¨è¯¢...');
    
    try {
        const response = await axios.get('https://www.iresearch.com.cn/search.shtml', {
            params: { q: 'å’–å•¡' },
            headers: { 'User-Agent': 'Mozilla/5.0' },
            timeout: 5000
        });
        
        const $ = cheerio.load(response.data);
        const news = [];
        
        $('.report-list li').each((i, elem) => {
            if (i < 5) {
                const title = $(elem).find('.title').text().trim();
                const link = $(elem).find('a').attr('href');
                const time = $(elem).find('.time').text().trim();
                
                if (title) {
                    news.push({
                        title,
                        url: link?.startsWith('http') ? link : `https://www.iresearch.com.cn${link}`,
                        source: 'è‰¾ç‘å’¨è¯¢',
                        publishedAt: time || new Date().toISOString(),
                        summary: title
                    });
                }
            }
        });
        
        console.log(`âœ… è‰¾ç‘å’¨è¯¢: ${news.length} æ¡`);
        return news;
    } catch (error) {
        console.error('âŒ è‰¾ç‘å’¨è¯¢è·å–å¤±è´¥:', error.message);
        return [];
    }
}

// ç™¾åº¦èµ„è®¯
async function fetchBaidu() {
    console.log('ğŸ” è·å–ç™¾åº¦èµ„è®¯...');
    
    try {
        const response = await axios.get('https://www.baidu.com/s', {
            params: {
                wd: 'å’–å•¡è¡Œä¸š OR å¥¶èŒ¶è¡Œä¸š',
                tn: 'news',
                rtt: 1 // æœ€è¿‘ä¸€å¤©
            },
            headers: { 'User-Agent': 'Mozilla/5.0' },
            timeout: 5000
        });
        
        const $ = cheerio.load(response.data);
        const news = [];
        
        $('.result').each((i, elem) => {
            if (i < 5) {
                const title = $(elem).find('h3').text().trim();
                const link = $(elem).find('h3 a').attr('href');
                const source = $(elem).find('.c-color-gray').text().trim();
                
                if (title) {
                    news.push({
                        title,
                        url: link || '',
                        source: source || 'ç™¾åº¦èµ„è®¯',
                        publishedAt: new Date().toISOString(),
                        summary: title
                    });
                }
            }
        });
        
        console.log(`âœ… ç™¾åº¦èµ„è®¯: ${news.length} æ¡`);
        return news;
    } catch (error) {
        console.error('âŒ ç™¾åº¦èµ„è®¯è·å–å¤±è´¥:', error.message);
        return [];
    }
}

// === å›½é™…èµ„è®¯æº ===

// çº½çº¦æ—¶æŠ¥
async function fetchNYT() {
    console.log('ğŸ” è·å–çº½çº¦æ—¶æŠ¥...');
    
    try {
        // ä½¿ç”¨NYT APIï¼ˆéœ€è¦API Keyï¼‰
        const apiKey = process.env.NYT_API_KEY || 'DEMO_KEY';
        
        const response = await axios.get('https://api.nytimes.com/svc/search/v2/articlesearch.json', {
            params: {
                q: 'coffee OR starbucks OR cafe',
                fq: 'section_name:("Business" OR "Food")',
                sort: 'newest',
                'api-key': apiKey
            },
            timeout: 8000
        });
        
        const news = response.data.response.docs.slice(0, 5).map(article => ({
            title: article.headline.main,
            url: article.web_url,
            source: 'New York Times',
            publishedAt: article.pub_date,
            summary: article.abstract || article.snippet
        }));
        
        console.log(`âœ… çº½çº¦æ—¶æŠ¥: ${news.length} æ¡`);
        return news;
    } catch (error) {
        console.error('âŒ çº½çº¦æ—¶æŠ¥è·å–å¤±è´¥:', error.message);
        return [];
    }
}

// åå°”è¡—æ—¥æŠ¥
async function fetchWSJ() {
    console.log('ğŸ” è·å–åå°”è¡—æ—¥æŠ¥...');
    
    try {
        // WSJ RSS Feed
        const response = await axios.get('https://feeds.a.dj.com/rss/WSJcomUSBusiness.xml', {
            timeout: 8000
        });
        
        const $ = cheerio.load(response.data, { xmlMode: true });
        const news = [];
        
        $('item').each((i, elem) => {
            if (i < 5) {
                const title = $(elem).find('title').text();
                const link = $(elem).find('link').text();
                const pubDate = $(elem).find('pubDate').text();
                const description = $(elem).find('description').text();
                
                // ç­›é€‰å’–å•¡ç›¸å…³
                if (title.toLowerCase().includes('coffee') || 
                    title.toLowerCase().includes('starbucks') ||
                    description.toLowerCase().includes('coffee')) {
                    news.push({
                        title,
                        url: link,
                        source: 'Wall Street Journal',
                        publishedAt: pubDate,
                        summary: description
                    });
                }
            }
        });
        
        console.log(`âœ… åå°”è¡—æ—¥æŠ¥: ${news.length} æ¡`);
        return news;
    } catch (error) {
        console.error('âŒ åå°”è¡—æ—¥æŠ¥è·å–å¤±è´¥:', error.message);
        return [];
    }
}

// é‡‘èæ—¶æŠ¥
async function fetchFT() {
    console.log('ğŸ” è·å–é‡‘èæ—¶æŠ¥...');
    
    try {
        // FT RSS Feed
        const response = await axios.get('https://www.ft.com/companies?format=rss', {
            timeout: 8000
        });
        
        const $ = cheerio.load(response.data, { xmlMode: true });
        const news = [];
        
        $('item').each((i, elem) => {
            if (i < 5) {
                const title = $(elem).find('title').text();
                const link = $(elem).find('link').text();
                const pubDate = $(elem).find('pubDate').text();
                const description = $(elem).find('description').text();
                
                if (title.toLowerCase().includes('coffee') || 
                    title.toLowerCase().includes('starbucks')) {
                    news.push({
                        title,
                        url: link,
                        source: 'Financial Times',
                        publishedAt: pubDate,
                        summary: description
                    });
                }
            }
        });
        
        console.log(`âœ… é‡‘èæ—¶æŠ¥: ${news.length} æ¡`);
        return news;
    } catch (error) {
        console.error('âŒ é‡‘èæ—¶æŠ¥è·å–å¤±è´¥:', error.message);
        return [];
    }
}

// å“ˆä½›å•†ä¸šè¯„è®º
async function fetchHBR() {
    console.log('ğŸ” è·å–å“ˆä½›å•†ä¸šè¯„è®º...');
    
    try {
        const response = await axios.get('https://hbr.org/search', {
            params: { term: 'coffee retail' },
            headers: { 'User-Agent': 'Mozilla/5.0' },
            timeout: 8000
        });
        
        const $ = cheerio.load(response.data);
        const news = [];
        
        $('.search-result').each((i, elem) => {
            if (i < 5) {
                const title = $(elem).find('.search-result-title').text().trim();
                const link = $(elem).find('a').attr('href');
                const summary = $(elem).find('.search-result-description').text().trim();
                
                if (title) {
                    news.push({
                        title,
                        url: link?.startsWith('http') ? link : `https://hbr.org${link}`,
                        source: 'Harvard Business Review',
                        publishedAt: new Date().toISOString(),
                        summary
                    });
                }
            }
        });
        
        console.log(`âœ… å“ˆä½›å•†ä¸šè¯„è®º: ${news.length} æ¡`);
        return news;
    } catch (error) {
        console.error('âŒ å“ˆä½›å•†ä¸šè¯„è®ºè·å–å¤±è´¥:', error.message);
        return [];
    }
}

// æ˜Ÿå·´å…‹å®˜ç½‘
async function fetchStarbucks() {
    console.log('ğŸ” è·å–æ˜Ÿå·´å…‹å®˜ç½‘...');
    
    try {
        const response = await axios.get('https://stories.starbucks.com/', {
            headers: { 'User-Agent': 'Mozilla/5.0' },
            timeout: 8000
        });
        
        const $ = cheerio.load(response.data);
        const news = [];
        
        $('.story-card').each((i, elem) => {
            if (i < 5) {
                const title = $(elem).find('.story-title').text().trim();
                const link = $(elem).find('a').attr('href');
                const date = $(elem).find('.story-date').text().trim();
                
                if (title) {
                    news.push({
                        title,
                        url: link?.startsWith('http') ? link : `https://stories.starbucks.com${link}`,
                        source: 'Starbucks Newsroom',
                        publishedAt: date || new Date().toISOString(),
                        summary: title
                    });
                }
            }
        });
        
        console.log(`âœ… æ˜Ÿå·´å…‹å®˜ç½‘: ${news.length} æ¡`);
        return news;
    } catch (error) {
        console.error('âŒ æ˜Ÿå·´å…‹å®˜ç½‘è·å–å¤±è´¥:', error.message);
        return [];
    }
}

// å¯åŠ¨æœåŠ¡
app.listen(PORT, () => {
    console.log(`ğŸš€ æ–°é—»ä»£ç†æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:${PORT}`);
    console.log(`ğŸ“‹ æ”¯æŒçš„èµ„è®¯æºï¼š`);
    console.log(`   ğŸ‡¨ğŸ‡³ å›½å†…ï¼š36æ°ªã€è™å—…ã€è…¾è®¯ã€è‰¾ç‘å’¨è¯¢ã€ç™¾åº¦`);
    console.log(`   ğŸŒ å›½é™…ï¼šNYTã€WSJã€FTã€HBRã€æ˜Ÿå·´å…‹`);
});
```

### 1.4 åˆ›å»º `.env` æ–‡ä»¶

```env
PORT=3001

# çº½çº¦æ—¶æŠ¥API Keyï¼ˆå…è´¹æ³¨å†Œï¼šhttps://developer.nytimes.com/ï¼‰
NYT_API_KEY=your_nyt_api_key_here

# å¦‚éœ€å…¶ä»–API Keyï¼Œåœ¨æ­¤æ·»åŠ 
```

### 1.5 åˆ›å»º `package.json`

```json
{
  "name": "coffee-news-proxy",
  "version": "1.0.0",
  "description": "å’–å•¡è¡Œä¸šèµ„è®¯ä»£ç†æœåŠ¡å™¨",
  "main": "server.js",
  "scripts": {
    "start": "node server.js",
    "dev": "nodemon server.js"
  },
  "dependencies": {
    "express": "^4.18.2",
    "axios": "^1.6.0",
    "cheerio": "^1.0.0-rc.12",
    "cors": "^2.8.5",
    "dotenv": "^16.3.1"
  },
  "devDependencies": {
    "nodemon": "^3.0.1"
  }
}
```

---

## ğŸ“¦ æ­¥éª¤2ï¼šæ›´æ–°å‰ç«¯ä»£ç 

### 2.1 ä¿®æ”¹ `docs/index.html`

æ‰¾åˆ° `fetchChineseNews` æ–¹æ³•ï¼Œæ›´æ–°ä¸ºï¼š

```javascript
async fetchChineseNews() {
    console.log('ğŸŒ å°è¯•è·å–æŒ‡å®šèµ„è®¯æº...');
    
    try {
        const backendUrl = 'http://localhost:3001/api/coffee-news-sources';
        
        const response = await axios.get(backendUrl, {
            timeout: 15000 // 15ç§’è¶…æ—¶
        });
        
        console.log(`âœ… ä»åç«¯è·å– ${response.data.length} æ¡èµ„è®¯`);
        return response.data;
        
    } catch (error) {
        console.error('âŒ åç«¯èµ„è®¯æºè·å–å¤±è´¥:', error.message);
        console.log('ğŸ’¡ è¯·ç¡®ä¿åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œï¼šnpm start');
        return [];
    }
},
```

---

## ğŸš€ æ­¥éª¤3ï¼šå¯åŠ¨æœåŠ¡

### 3.1 å¯åŠ¨åç«¯

```bash
cd /Users/luckincoffee/test/backend-news-proxy
npm start
```

**çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºè¡¨ç¤ºæˆåŠŸï¼š**
```
ğŸš€ æ–°é—»ä»£ç†æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:3001
ğŸ“‹ æ”¯æŒçš„èµ„è®¯æºï¼š
   ğŸ‡¨ğŸ‡³ å›½å†…ï¼š36æ°ªã€è™å—…ã€è…¾è®¯ã€è‰¾ç‘å’¨è¯¢ã€ç™¾åº¦
   ğŸŒ å›½é™…ï¼šNYTã€WSJã€FTã€HBRã€æ˜Ÿå·´å…‹
```

### 3.2 å¯åŠ¨å‰ç«¯

**æ–°å¼€ä¸€ä¸ªç»ˆç«¯ï¼š**

```bash
cd /Users/luckincoffee/test
python3 -m http.server 8000
```

### 3.3 æµ‹è¯•

1. æ‰“å¼€æµè§ˆå™¨ï¼š`http://localhost:8000/docs/`
2. ç‚¹å‡»"è·å–æœ€æ–°èµ„è®¯"
3. æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º
4. åº”è¯¥çœ‹åˆ°å¤šä¸ªèµ„è®¯æºçš„æ•°æ®

---

## ğŸ“Š æ­¥éª¤4ï¼šç›‘æ§å’Œè°ƒè¯•

### æŸ¥çœ‹åç«¯æ—¥å¿—

```bash
# åç«¯ç»ˆç«¯åº”è¯¥æ˜¾ç¤ºï¼š
ğŸ” è·å–36æ°ªèµ„è®¯...
âœ… 36æ°ª: 3 æ¡
ğŸ” è·å–è™å—…èµ„è®¯...
âœ… è™å—…: 2 æ¡
ğŸ” è·å–æ˜Ÿå·´å…‹å®˜ç½‘...
âœ… æ˜Ÿå·´å…‹å®˜ç½‘: 5 æ¡
...
âœ… å…±è·å– 25 æ¡èµ„è®¯
```

### æŸ¥çœ‹å‰ç«¯æ—¥å¿—

```bash
# æµè§ˆå™¨æ§åˆ¶å°åº”è¯¥æ˜¾ç¤ºï¼š
ğŸŒ å°è¯•è·å–æŒ‡å®šèµ„è®¯æº...
âœ… ä»åç«¯è·å– 25 æ¡èµ„è®¯
ğŸ“¡ API å“åº”çŠ¶æ€: 200
ğŸ“¦ è¿”å›ç»“æœæ•°: 7
âœ… æˆåŠŸè·å– 32 æ¡èµ„è®¯ï¼ˆ25 + 7ï¼‰
```

---

## ğŸ¯ æ­¥éª¤5ï¼šä¼˜åŒ–å’Œå¢å¼º

### 5.1 æ·»åŠ æ›´å¤šèµ„è®¯æº

åœ¨ `server.js` ä¸­æ·»åŠ æ–°å‡½æ•°ï¼š

```javascript
// å’–é—¨ï¼ˆå‚ç›´åª’ä½“ï¼‰
async function fetchKamen() {
    console.log('ğŸ” è·å–å’–é—¨èµ„è®¯...');
    // å®ç°é€»è¾‘...
}

// æ·»åŠ åˆ° Promise.allSettled ä¸­
const results = await Promise.allSettled([
    fetch36kr(),
    fetchHuxiu(),
    fetchKamen(), // æ–°å¢
    // ...
]);
```

### 5.2 æ·»åŠ ç¼“å­˜

```javascript
const NodeCache = require('node-cache');
const cache = new NodeCache({ stdTTL: 300 }); // 5åˆ†é’Ÿç¼“å­˜

app.get('/api/coffee-news-sources', async (req, res) => {
    const cacheKey = 'coffee_news';
    const cached = cache.get(cacheKey);
    
    if (cached) {
        console.log('âš¡ è¿”å›ç¼“å­˜æ•°æ®');
        return res.json(cached);
    }
    
    // è·å–æ–°æ•°æ®...
    cache.set(cacheKey, allNews);
    res.json(allNews);
});
```

### 5.3 æ·»åŠ é”™è¯¯é‡è¯•

```javascript
async function fetchWithRetry(fetchFunc, retries = 3) {
    for (let i = 0; i < retries; i++) {
        try {
            return await fetchFunc();
        } catch (error) {
            if (i === retries - 1) throw error;
            await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
        }
    }
}
```

---

## ğŸŒ æ­¥éª¤6ï¼šéƒ¨ç½²åˆ°äº‘ç«¯ï¼ˆå¯é€‰ï¼‰

### æ–¹æ¡ˆ1ï¼šHerokuï¼ˆå…è´¹ï¼‰

```bash
# å®‰è£…Heroku CLI
brew install heroku/brew/heroku

# ç™»å½•
heroku login

# åˆ›å»ºåº”ç”¨
cd backend-news-proxy
git init
heroku create coffee-news-proxy

# éƒ¨ç½²
git add .
git commit -m "Initial commit"
git push heroku master

# æŸ¥çœ‹æ—¥å¿—
heroku logs --tail
```

**æ›´æ–°å‰ç«¯URLï¼š**
```javascript
const backendUrl = 'https://coffee-news-proxy.herokuapp.com/api/coffee-news-sources';
```

### æ–¹æ¡ˆ2ï¼šVercelï¼ˆå…è´¹ï¼‰

```bash
# å®‰è£…Vercel CLI
npm install -g vercel

# éƒ¨ç½²
cd backend-news-proxy
vercel

# æŒ‰æç¤ºå®Œæˆéƒ¨ç½²
```

### æ–¹æ¡ˆ3ï¼šè‡ªå·±çš„æœåŠ¡å™¨

```bash
# ä½¿ç”¨PM2ä¿æŒè¿è¡Œ
npm install -g pm2
pm2 start server.js --name coffee-news
pm2 save
pm2 startup
```

---

## ğŸ”‘ API Key ç”³è¯·æŒ‡å—

### çº½çº¦æ—¶æŠ¥ï¼ˆNew York Timesï¼‰

1. è®¿é—®ï¼šhttps://developer.nytimes.com/
2. æ³¨å†Œè´¦å·
3. åˆ›å»ºAPP
4. è·å–API Key
5. å…è´¹é…é¢ï¼š1000æ¬¡/å¤©

### åå°”è¡—æ—¥æŠ¥ï¼ˆæ— éœ€API Keyï¼‰

- ä½¿ç”¨RSS Feed
- æ— éœ€æ³¨å†Œ
- å…è´¹è®¿é—®

### é‡‘èæ—¶æŠ¥ï¼ˆæ— éœ€API Keyï¼‰

- ä½¿ç”¨RSS Feed
- æ— éœ€æ³¨å†Œ
- å…è´¹è®¿é—®

### å…¶ä»–å›½å†…èµ„è®¯æº

- å¤§å¤šæ•°å›½å†…ç½‘ç«™æ— å…¬å¼€API
- ä½¿ç”¨ç½‘é¡µçˆ¬å–ï¼ˆcheerioï¼‰
- æ³¨æ„åçˆ¬è™«æœºåˆ¶

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. æ³•å¾‹åˆè§„

- âœ… ä»…ç”¨äºä¸ªäººå­¦ä¹ å’Œç ”ç©¶
- âœ… å°Šé‡ç½‘ç«™çš„robots.txt
- âœ… ä¸è¦é¢‘ç¹è¯·æ±‚ï¼ˆå»ºè®®5åˆ†é’Ÿç¼“å­˜ï¼‰
- âŒ ä¸è¦ç”¨äºå•†ä¸šç”¨é€”

### 2. æŠ€æœ¯é™åˆ¶

**ç½‘ç«™å¯èƒ½å˜åŒ–ï¼š**
- ç½‘ç«™ç»“æ„å¯èƒ½æ›´æ–°
- é€‰æ‹©å™¨å¯èƒ½å¤±æ•ˆ
- éœ€è¦å®šæœŸç»´æŠ¤

**åçˆ¬è™«æœºåˆ¶ï¼š**
- æœ‰äº›ç½‘ç«™æœ‰åçˆ¬è™«
- å¯èƒ½éœ€è¦æ·»åŠ ä»£ç†
- å¯èƒ½éœ€è¦å¤„ç†éªŒè¯ç 

**APIé™åˆ¶ï¼š**
- NYTï¼š1000æ¬¡/å¤©
- å…¶ä»–APIå¯èƒ½æœ‰é™åˆ¶
- åˆç†ä½¿ç”¨ç¼“å­˜

### 3. æ€§èƒ½ä¼˜åŒ–

```javascript
// è®¾ç½®åˆç†çš„è¶…æ—¶
axios.get(url, { timeout: 5000 })

// å¹¶å‘æ§åˆ¶
const pLimit = require('p-limit');
const limit = pLimit(3); // æœ€å¤š3ä¸ªå¹¶å‘

// ä½¿ç”¨ç¼“å­˜
const cache = new NodeCache({ stdTTL: 300 });
```

---

## ğŸ“Š é¢„æœŸæ•ˆæœ

### èµ„è®¯æ•°é‡

| èµ„è®¯æº | é¢„æœŸæ•°é‡/æ¬¡ | æ›´æ–°é¢‘ç‡ |
|--------|------------|---------|
| 36æ°ª | 3-5æ¡ | å®æ—¶ |
| è™å—… | 2-4æ¡ | å®æ—¶ |
| è…¾è®¯æ–°é—» | 5-10æ¡ | å®æ—¶ |
| è‰¾ç‘å’¨è¯¢ | 1-3æ¡ | æ¯å‘¨ |
| ç™¾åº¦èµ„è®¯ | 5-8æ¡ | å®æ—¶ |
| çº½çº¦æ—¶æŠ¥ | 2-5æ¡ | æ¯æ—¥ |
| åå°”è¡—æ—¥æŠ¥ | 1-3æ¡ | æ¯æ—¥ |
| é‡‘èæ—¶æŠ¥ | 1-3æ¡ | æ¯æ—¥ |
| å“ˆä½›å•†ä¸šè¯„è®º | 0-2æ¡ | æ¯å‘¨ |
| æ˜Ÿå·´å…‹å®˜ç½‘ | 1-3æ¡ | æ¯æœˆ |

**æ€»è®¡ï¼š** æ¯æ¬¡è·å– **20-50æ¡** èµ„è®¯

### å“åº”æ—¶é—´

- æœ¬åœ°è¿è¡Œï¼š3-8ç§’
- äº‘ç«¯éƒ¨ç½²ï¼š5-12ç§’
- ä½¿ç”¨ç¼“å­˜ï¼š<0.5ç§’

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šåç«¯æ— æ³•å¯åŠ¨

```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :3001

# æ›´æ¢ç«¯å£
PORT=3002 npm start
```

### é—®é¢˜2ï¼šCORSé”™è¯¯

```javascript
// ç¡®ä¿CORSé…ç½®æ­£ç¡®
app.use(cors({
    origin: ['http://localhost:8000', 'https://ä½ çš„åŸŸå']
}));
```

### é—®é¢˜3ï¼šæŸä¸ªèµ„è®¯æºå¤±æ•ˆ

```javascript
// æ£€æŸ¥ç½‘ç«™æ˜¯å¦æ›´æ–°
// æ›´æ–°é€‰æ‹©å™¨
// æˆ–æš‚æ—¶ç¦ç”¨è¯¥æº
```

### é—®é¢˜4ï¼šè·å–èµ„è®¯ä¸ºç©º

```bash
# æŸ¥çœ‹åç«¯æ—¥å¿—
# æ£€æŸ¥ç½‘ç»œè¿æ¥
# æ£€æŸ¥ç½‘ç«™æ˜¯å¦å¯è®¿é—®
curl https://www.36kr.com
```

---

## ğŸ¯ å¿«é€Ÿæµ‹è¯•æ¸…å•

éƒ¨ç½²åæµ‹è¯•ï¼š

- [ ] åç«¯æœåŠ¡å¯åŠ¨æˆåŠŸ
- [ ] è®¿é—® http://localhost:3001/api/coffee-news-sources æœ‰æ•°æ®
- [ ] å‰ç«¯èƒ½è°ƒç”¨åç«¯API
- [ ] è‡³å°‘3ä¸ªèµ„è®¯æºæœ‰æ•°æ®
- [ ] èµ„è®¯æ˜¾ç¤ºåœ¨3x3çŸ©é˜µä¸­
- [ ] ä¸šåŠ¡æ´è§æ­£å¸¸ç”Ÿæˆ
- [ ] æ§åˆ¶å°æ— æŠ¥é”™

---

## ğŸ“š æ‰©å±•é˜…è¯»

- [Node.js Web Scraping Guide](https://www.scrapingbee.com/blog/web-scraping-javascript/)
- [Cheerio Documentation](https://cheerio.js.org/)
- [Axios Documentation](https://axios-http.com/)
- [Express CORS Middleware](https://expressjs.com/en/resources/middleware/cors.html)

---

## ğŸ‰ æ€»ç»“

**é…ç½®å®Œæˆåï¼Œä½ å°†æ‹¥æœ‰ï¼š**

âœ… 10ä¸ªé«˜è´¨é‡èµ„è®¯æº
âœ… å›½å†…å¤–å…¨è¦†ç›–
âœ… è‡ªåŠ¨åŒ–è·å–å’Œåˆ†ç±»
âœ… æ™ºèƒ½ä¸šåŠ¡æ´è§
âœ… å¯éƒ¨ç½²åˆ°äº‘ç«¯
âœ… å¯æŒç»­ç»´æŠ¤å’Œæ‰©å±•

**ä»ä¿¡æ¯æ”¶é›†åˆ°æ™ºèƒ½åˆ†æï¼Œä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼** ğŸš€ğŸ“Šâœ¨


